
(function(){function a(a,b){b.src?e.ajax({url:b.src,async:!1,dataType:"script"}):e.globalEval(b.text||b.textContent||b.innerHTML||"");b.parentNode&&b.parentNode.removeChild(b)}function b(a,b){return a[0]&&parseInt(e.curCSS(a[0],b,!0),10)||0}function c(){if(!z){z=!0;document.addEventListener&&!e.browser.opera&&document.addEventListener("DOMContentLoaded",e.ready,!1);e.browser.msie&&window==top&&function(){if(!e.isReady){try{document.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,
0);return}e.ready()}}();e.browser.opera&&document.addEventListener("DOMContentLoaded",function(){if(!e.isReady){for(var a=0;a<document.styleSheets.length;a++)if(document.styleSheets[a].disabled){setTimeout(arguments.callee,0);return}e.ready()}},!1);if(e.browser.safari){var a;(function(){if(!e.isReady)if("loaded"!=document.readyState&&"complete"!=document.readyState)setTimeout(arguments.callee,0);else{if(a===i)a=e("style, link[rel=stylesheet]").length;document.styleSheets.length!=a?setTimeout(arguments.callee,
0):e.ready()}})()}e.event.add(window,"load",e.ready)}}var d=window.jQuery,f=window.$,e=window.jQuery=window.$=function(a,b){return new e.fn.init(a,b)},g=/^[^<]*(<(.|\s)+>)[^>]*$|^#(\w+)$/,h=/^.[^:#\[\.]*$/,i;e.fn=e.prototype={init:function(a,b){a=a||document;if(a.nodeType)return this[0]=a,this.length=1,this;if("string"==typeof a){var c=g.exec(a);if(c&&(c[1]||!b))if(c[1])a=e.clean([c[1]],b);else{var d=document.getElementById(c[3]);if(d)return d.id!=c[3]?e().find(a):e(d);a=[]}else return e(b).find(a)}else if(e.isFunction(a))return e(document)[e.fn.ready?
"ready":"load"](a);return this.setArray(e.makeArray(a))},jquery:"1.2.6",size:function(){return this.length},length:0,get:function(a){return a==i?e.makeArray(this):this[a]},pushStack:function(a){a=e(a);a.prevObject=this;return a},setArray:function(a){this.length=0;Array.prototype.push.apply(this,a);return this},each:function(a,b){return e.each(this,a,b)},index:function(a){return e.inArray(a&&a.jquery?a[0]:a,this)},attr:function(a,b,c){var d=a;if(a.constructor==String){if(b===i)return this[0]&&e[c||
"attr"](this[0],a);d={};d[a]=b}return this.each(function(b){for(a in d)e.attr(c?this.style:this,a,e.prop(this,d[a],c,b,a))})},css:function(a,b){if(("width"==a||"height"==a)&&0>parseFloat(b))b=i;return this.attr(a,b,"curCSS")},text:function(a){if("object"!=typeof a&&null!=a)return this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(a));var b="";e.each(a||this,function(){e.each(this.childNodes,function(){8!=this.nodeType&&(b+=1!=this.nodeType?this.nodeValue:e.fn.text([this]))})});
return b},wrapAll:function(a){this[0]&&e(a,this[0].ownerDocument).clone().insertBefore(this[0]).map(function(){for(var a=this;a.firstChild;)a=a.firstChild;return a}).append(this);return this},wrapInner:function(a){return this.each(function(){e(this).contents().wrapAll(a)})},wrap:function(a){return this.each(function(){e(this).wrapAll(a)})},append:function(){return this.domManip(arguments,!0,!1,function(a){1==this.nodeType&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,
!0,function(a){1==this.nodeType&&this.insertBefore(a,this.firstChild)})},before:function(){return this.domManip(arguments,!1,!1,function(a){this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,!1,!0,function(a){this.parentNode.insertBefore(a,this.nextSibling)})},end:function(){return this.prevObject||e([])},find:function(a){var b=e.map(this,function(b){return e.find(a,b)});return this.pushStack(/[^+>] [^+>]/.test(a)||-1<a.indexOf("..")?e.unique(b):b)},clone:function(a){var b=
this.map(function(){if(e.browser.msie&&!e.isXMLDoc(this)){var a=this.cloneNode(!0),b=document.createElement("div");b.appendChild(a);return e.clean([b.innerHTML])[0]}return this.cloneNode(!0)}),c=b.find("*").andSelf().each(function(){this[j]!=i&&(this[j]=null)});!0===a&&this.find("*").andSelf().each(function(a){if(3!=this.nodeType){var b=e.data(this,"events"),s;for(s in b)for(var d in b[s])e.event.add(c[a],s,b[s][d],b[s][d].data)}});return b},filter:function(a){return this.pushStack(e.isFunction(a)&&
e.grep(this,function(b,c){return a.call(b,c)})||e.multiFilter(a,this))},not:function(a){if(a.constructor==String){if(h.test(a))return this.pushStack(e.multiFilter(a,this,!0));a=e.multiFilter(a,this)}var b=a.length&&a[a.length-1]!==i&&!a.nodeType;return this.filter(function(){return b?0>e.inArray(this,a):this!=a})},add:function(a){return this.pushStack(e.unique(e.merge(this.get(),"string"==typeof a?e(a):e.makeArray(a))))},is:function(a){return!!a&&0<e.multiFilter(a,this).length},hasClass:function(a){return this.is("."+
a)},val:function(a){if(a==i){if(this.length){var b=this[0];if(e.nodeName(b,"select")){var c=b.selectedIndex,d=[],f=b.options,b="select-one"==b.type;if(0>c)return null;for(var g=b?c:0,c=b?c+1:f.length;g<c;g++){var h=f[g];if(h.selected){a=e.browser.msie&&!h.attributes.value.specified?h.text:h.value;if(b)return a;d.push(a)}}return d}return(this[0].value||"").replace(/\r/g,"")}return i}a.constructor==Number&&(a+="");return this.each(function(){if(1==this.nodeType)if(a.constructor==Array&&/radio|checkbox/.test(this.type))this.checked=
0<=e.inArray(this.value,a)||0<=e.inArray(this.name,a);else if(e.nodeName(this,"select")){var b=e.makeArray(a);e("option",this).each(function(){this.selected=0<=e.inArray(this.value,b)||0<=e.inArray(this.text,b)});if(!b.length)this.selectedIndex=-1}else this.value=a})},html:function(a){return a==i?this[0]?this[0].innerHTML:null:this.empty().append(a)},replaceWith:function(a){return this.after(a).remove()},eq:function(a){return this.slice(a,a+1)},slice:function(){return this.pushStack(Array.prototype.slice.apply(this,
arguments))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},andSelf:function(){return this.add(this.prevObject)},data:function(a,b){var c=a.split(".");c[1]=c[1]?"."+c[1]:"";if(b===i){var d=this.triggerHandler("getData"+c[1]+"!",[c[0]]);d===i&&this.length&&(d=e.data(this[0],a));return d===i&&c[1]?this.data(c[0]):d}return this.trigger("setData"+c[1]+"!",[c[0],b]).each(function(){e.data(this,a,b)})},removeData:function(a){return this.each(function(){e.removeData(this,
a)})},domManip:function(b,c,d,f){var g=1<this.length,h;return this.each(function(){h||(h=e.clean(b,this.ownerDocument),d&&h.reverse());var i=this;c&&e.nodeName(this,"table")&&e.nodeName(h[0],"tr")&&(i=this.getElementsByTagName("tbody")[0]||this.appendChild(this.ownerDocument.createElement("tbody")));var j=e([]);e.each(h,function(){var a=g?e(this).clone(!0)[0]:this;e.nodeName(a,"script")?j=j.add(a):(1==a.nodeType&&(j=j.add(e("script",a).remove())),f.call(i,a))});j.each(a)})}};e.fn.init.prototype=e.fn;
e.extend=e.fn.extend=function(){var a=arguments[0]||{},b=1,c=arguments.length,d=!1,f;a.constructor==Boolean&&(d=a,a=arguments[1]||{},b=2);"object"!=typeof a&&"function"!=typeof a&&(a={});c==b&&(a=this,--b);for(;b<c;b++)if(null!=(f=arguments[b]))for(var g in f){var h=a[g],j=f[g];a!==j&&(d&&j&&"object"==typeof j&&!j.nodeType?a[g]=e.extend(d,h||(null!=j.length?[]:{}),j):j!==i&&(a[g]=j))}return a};var j="jQuery"+ +new Date,l=0,k={},m=/z-?index|font-?weight|opacity|zoom|line-?height/i,p=document.defaultView||
{};e.extend({noConflict:function(a){window.$=f;if(a)window.jQuery=d;return e},isFunction:function(a){return!!a&&"string"!=typeof a&&!a.nodeName&&a.constructor!=Array&&/^[\s[]?function/.test(a+"")},isXMLDoc:function(a){return a.documentElement&&!a.body||a.tagName&&a.ownerDocument&&!a.ownerDocument.body},globalEval:function(a){if(a=e.trim(a)){var b=document.getElementsByTagName("head")[0]||document.documentElement,c=document.createElement("script");c.type="text/javascript";e.browser.msie?c.text=a:c.appendChild(document.createTextNode(a));
b.insertBefore(c,b.firstChild);b.removeChild(c)}},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()==b.toUpperCase()},cache:{},data:function(a,b,c){var a=a==window?k:a,d=a[j];d||(d=a[j]=++l);b&&!e.cache[d]&&(e.cache[d]={});c!==i&&(e.cache[d][b]=c);return b?e.cache[d][b]:d},removeData:function(a,b){var a=a==window?k:a,c=a[j];if(b){if(e.cache[c]){delete e.cache[c][b];b="";for(b in e.cache[c])break;b||e.removeData(a)}}else{try{delete a[j]}catch(d){a.removeAttribute&&a.removeAttribute(j)}delete e.cache[c]}},
each:function(a,b,c){var e,d=0,f=a.length;if(c)if(f==i)for(e in a){if(!1===b.apply(a[e],c))break}else for(;d<f&&!(!1===b.apply(a[d++],c)););else if(f==i)for(e in a){if(!1===b.call(a[e],e,a[e]))break}else for(c=a[0];d<f&&!1!==b.call(c,d,c);c=a[++d]);return a},prop:function(a,b,c,d,f){e.isFunction(b)&&(b=b.call(a,d));return b&&b.constructor==Number&&"curCSS"==c&&!m.test(f)?b+"px":b},className:{add:function(a,b){e.each((b||"").split(/\s+/),function(b,c){1==a.nodeType&&!e.className.has(a.className,c)&&
(a.className+=(a.className?" ":"")+c)})},remove:function(a,b){if(1==a.nodeType)a.className=b!=i?e.grep(a.className.split(/\s+/),function(a){return!e.className.has(b,a)}).join(" "):""},has:function(a,b){return-1<e.inArray(b,(a.className||a).toString().split(/\s+/))}},swap:function(a,b,c){var e={},d;for(d in b)e[d]=a.style[d],a.style[d]=b[d];c.call(a);for(d in b)a.style[d]=e[d]},css:function(a,b,c){if("width"==b||"height"==b){var d,c={position:"absolute",visibility:"hidden",display:"block"},f="width"==
b?["Left","Right"]:["Top","Bottom"],g=function(){d="width"==b?a.offsetWidth:a.offsetHeight;var c=0,g=0;e.each(f,function(){c+=parseFloat(e.curCSS(a,"padding"+this,!0))||0;g+=parseFloat(e.curCSS(a,"border"+this+"Width",!0))||0});d-=Math.round(c+g)};e(a).is(":visible")?g():e.swap(a,c,g);return Math.max(0,d)}return e.curCSS(a,b,c)},curCSS:function(a,b,c){function d(a){if(!e.browser.safari)return!1;a=p.getComputedStyle(a,null);return!a||""==a.getPropertyValue("color")}var f,g=a.style;if("opacity"==b&&
e.browser.msie)return f=e.attr(g,"opacity"),""==f?"1":f;if(e.browser.opera&&"display"==b){var h=g.outline;g.outline="0 solid black";g.outline=h}b.match(/float/i)&&(b=q);if(!c&&g&&g[b])f=g[b];else if(p.getComputedStyle){b.match(/float/i)&&(b="float");b=b.replace(/([A-Z])/g,"-$1").toLowerCase();if((f=p.getComputedStyle(a,null))&&!d(a))f=f.getPropertyValue(b);else{g=[];c=[];h=a;for(a=0;h&&d(h);h=h.parentNode)c.unshift(h);for(;a<c.length;a++)if(d(c[a]))g[a]=c[a].style.display,c[a].style.display="block";
f="display"==b&&null!=g[c.length-1]?"none":f&&f.getPropertyValue(b)||"";for(a=0;a<g.length;a++)if(null!=g[a])c[a].style.display=g[a]}"opacity"==b&&""==f&&(f="1")}else if(a.currentStyle&&(f=b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),f=a.currentStyle[b]||a.currentStyle[f],!/^\d+(px)?$/i.test(f)&&/^\d/.test(f)))b=g.left,c=a.runtimeStyle.left,a.runtimeStyle.left=a.currentStyle.left,g.left=f||0,f=g.pixelLeft+"px",g.left=b,a.runtimeStyle.left=c;return f},clean:function(a,b){var c=[],b=b||
document;"undefined"==typeof b.createElement&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||document);e.each(a,function(a,d){if(d){d.constructor==Number&&(d+="");if("string"==typeof d){var d=d.replace(/(<(\w+)[^>]*?)\/>/g,function(a,b,c){return c.match(/^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i)?a:b+"></"+c+">"}),s=e.trim(d).toLowerCase(),f=b.createElement("div"),g=!s.indexOf("<opt")&&[1,"<select multiple='multiple'>","</select>"]||!s.indexOf("<leg")&&[1,"<fieldset>","</fieldset>"]||
s.match(/^<(thead|tbody|tfoot|colg|cap)/)&&[1,"<table>","</table>"]||!s.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!s.indexOf("<td")||!s.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||!s.indexOf("<col")&&[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"]||e.browser.msie&&[1,"div<div>","</div>"]||[0,"",""];for(f.innerHTML=g[1]+d+g[2];g[0]--;)f=f.lastChild;if(e.browser.msie){s=!s.indexOf("<table")&&0>s.indexOf("<tbody")?f.firstChild&&f.firstChild.childNodes:
"<table>"==g[1]&&0>s.indexOf("<tbody")?f.childNodes:[];for(g=s.length-1;0<=g;--g)e.nodeName(s[g],"tbody")&&!s[g].childNodes.length&&s[g].parentNode.removeChild(s[g]);/^\s/.test(d)&&f.insertBefore(b.createTextNode(d.match(/^\s*/)[0]),f.firstChild)}d=e.makeArray(f.childNodes)}0===d.length&&!e.nodeName(d,"form")&&!e.nodeName(d,"select")||(d[0]==i||e.nodeName(d,"form")||d.options?c.push(d):c=e.merge(c,d))}});return c},attr:function(a,b,c){if(!a||3==a.nodeType||8==a.nodeType)return i;var d=!e.isXMLDoc(a),
f=c!==i,g=e.browser.msie,b=d&&e.props[b]||b;if(a.tagName){var h=/href|src|style/.test(b);if(b in a&&d&&!h){if(f){if("type"==b&&e.nodeName(a,"input")&&a.parentNode)throw"type property can't be changed";a[b]=c}return e.nodeName(a,"form")&&a.getAttributeNode(b)?a.getAttributeNode(b).nodeValue:a[b]}if(g&&d&&"style"==b)return e.attr(a.style,"cssText",c);f&&a.setAttribute(b,""+c);a=g&&d&&h?a.getAttribute(b,2):a.getAttribute(b);return null===a?i:a}if(g&&"opacity"==b){if(f)a.zoom=1,a.filter=(a.filter||"").replace(/alpha\([^)]*\)/,
"")+("NaN"==parseInt(c)+""?"":"alpha(opacity="+100*c+")");return a.filter&&0<=a.filter.indexOf("opacity=")?parseFloat(a.filter.match(/opacity=([^)]*)/)[1])/100+"":""}b=b.replace(/-([a-z])/ig,function(a,b){return b.toUpperCase()});f&&(a[b]=c);return a[b]},trim:function(a){return(a||"").replace(/^\s+|\s+$/g,"")},makeArray:function(a){var b=[];if(null!=a){var c=a.length;if(null==c||a.split||a.setInterval||a.call)b[0]=a;else for(;c;)b[--c]=a[c]}return b},inArray:function(a,b){for(var c=0,e=b.length;c<
e;c++)if(b[c]===a)return c;return-1},merge:function(a,b){var c=0,d,f=a.length;if(e.browser.msie)for(;d=b[c++];)8!=d.nodeType&&(a[f++]=d);else for(;d=b[c++];)a[f++]=d;return a},unique:function(a){var b=[],c={};try{for(var d=0,f=a.length;d<f;d++){var g=e.data(a[d]);c[g]||(c[g]=!0,b.push(a[d]))}}catch(h){b=a}return b},grep:function(a,b,c){for(var e=[],d=0,f=a.length;d<f;d++)!c!=!b(a[d],d)&&e.push(a[d]);return e},map:function(a,b){for(var c=[],e=0,d=a.length;e<d;e++){var f=b(a[e],e);null!=f&&(c[c.length]=
f)}return c.concat.apply([],c)}});var o=navigator.userAgent.toLowerCase();e.browser={version:(o.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(o),opera:/opera/.test(o),msie:/msie/.test(o)&&!/opera/.test(o),mozilla:/mozilla/.test(o)&&!/(compatible|webkit)/.test(o)};var q=e.browser.msie?"styleFloat":"cssFloat";e.extend({boxModel:!e.browser.msie||"CSS1Compat"==document.compatMode,props:{"for":"htmlFor","class":"className","float":q,cssFloat:q,styleFloat:q,readonly:"readOnly",maxlength:"maxLength",
cellspacing:"cellSpacing"}});e.each({parent:function(a){return a.parentNode},parents:function(a){return e.dir(a,"parentNode")},next:function(a){return e.nth(a,2,"nextSibling")},prev:function(a){return e.nth(a,2,"previousSibling")},nextAll:function(a){return e.dir(a,"nextSibling")},prevAll:function(a){return e.dir(a,"previousSibling")},siblings:function(a){return e.sibling(a.parentNode.firstChild,a)},children:function(a){return e.sibling(a.firstChild)},contents:function(a){return e.nodeName(a,"iframe")?
a.contentDocument||a.contentWindow.document:e.makeArray(a.childNodes)}},function(a,b){e.fn[a]=function(a){var c=e.map(this,b);a&&"string"==typeof a&&(c=e.multiFilter(a,c));return this.pushStack(e.unique(c))}});e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){e.fn[a]=function(){var a=arguments;return this.each(function(){for(var c=0,d=a.length;c<d;c++)e(a[c])[b](this)})}});e.each({removeAttr:function(a){e.attr(this,a,"");
1==this.nodeType&&this.removeAttribute(a)},addClass:function(a){e.className.add(this,a)},removeClass:function(a){e.className.remove(this,a)},toggleClass:function(a){e.className[e.className.has(this,a)?"remove":"add"](this,a)},remove:function(a){if(!a||e.filter(a,[this]).r.length)e("*",this).add(this).each(function(){e.event.remove(this);e.removeData(this)}),this.parentNode&&this.parentNode.removeChild(this)},empty:function(){for(e(">*",this).remove();this.firstChild;)this.removeChild(this.firstChild)}},
function(a,b){e.fn[a]=function(){return this.each(b,arguments)}});e.each(["Height","Width"],function(a,b){var c=b.toLowerCase();e.fn[c]=function(a){return this[0]==window?e.browser.opera&&document.body["client"+b]||e.browser.safari&&window["inner"+b]||"CSS1Compat"==document.compatMode&&document.documentElement["client"+b]||document.body["client"+b]:this[0]==document?Math.max(Math.max(document.body["scroll"+b],document.documentElement["scroll"+b]),Math.max(document.body["offset"+b],document.documentElement["offset"+
b])):a==i?this.length?e.css(this[0],c):null:this.css(c,a.constructor==String?a:a+"px")}});var r=e.browser.safari&&417>parseInt(e.browser.version)?"(?:[\\w*_-]|\\\\.)":"(?:[\\w\u0128-\uffff*_-]|\\\\.)",t=RegExp("^>\\s*("+r+"+)"),w=RegExp("^("+r+"+)(#)("+r+"+)"),u=RegExp("^([#.]?)("+r+"*)");e.extend({expr:{"":function(a,b,c){return"*"==c[2]||e.nodeName(a,c[2])},"#":function(a,b,c){return a.getAttribute("id")==c[2]},":":{lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,
b,c){return c[3]-0==b},eq:function(a,b,c){return c[3]-0==b},first:function(a,b){return 0==b},last:function(a,b,c,e){return b==e.length-1},even:function(a,b){return 0==b%2},odd:function(a,b){return b%2},"first-child":function(a){return a.parentNode.getElementsByTagName("*")[0]==a},"last-child":function(a){return e.nth(a.parentNode.lastChild,1,"previousSibling")==a},"only-child":function(a){return!e.nth(a.parentNode.lastChild,2,"previousSibling")},parent:function(a){return a.firstChild},empty:function(a){return!a.firstChild},
contains:function(a,b,c){return 0<=(a.textContent||a.innerText||e(a).text()||"").indexOf(c[3])},visible:function(a){return"hidden"!=a.type&&"none"!=e.css(a,"display")&&"hidden"!=e.css(a,"visibility")},hidden:function(a){return"hidden"==a.type||"none"==e.css(a,"display")||"hidden"==e.css(a,"visibility")},enabled:function(a){return!a.disabled},disabled:function(a){return a.disabled},checked:function(a){return a.checked},selected:function(a){return a.selected||e.attr(a,"selected")},text:function(a){return"text"==
a.type},radio:function(a){return"radio"==a.type},checkbox:function(a){return"checkbox"==a.type},file:function(a){return"file"==a.type},password:function(a){return"password"==a.type},submit:function(a){return"submit"==a.type},image:function(a){return"image"==a.type},reset:function(a){return"reset"==a.type},button:function(a){return"button"==a.type||e.nodeName(a,"button")},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},has:function(a,b,c){return e.find(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},
animated:function(a){return e.grep(e.timers,function(b){return a==b.elem}).length}}},parse:[/^(\[) *@?([\w-]+) *([!*$^~=]*) *('?"?)(.*?)\4 *\]/,/^(:)([\w-]+)\("?'?(.*?(\(.*?\))?[^(]*?)"?'?\)/,RegExp("^([:.#]*)("+r+"+)")],multiFilter:function(a,b,c){for(var d,f=[];a&&a!=d;){d=a;var g=e.filter(a,b,c),a=g.t.replace(/^\s*,\s*/,""),f=c?b=g.r:e.merge(f,g.r)}return f},find:function(a,b){if("string"!=typeof a)return[a];if(b&&1!=b.nodeType&&9!=b.nodeType)return[];for(var b=b||document,c=[b],d=[],f,g;a&&f!=
a;){var h=[];f=a;a=e.trim(a);g=!1;var i=t,j=i.exec(a);if(j){g=j[1].toUpperCase();for(var k=0;c[k];k++)for(j=c[k].firstChild;j;j=j.nextSibling)1==j.nodeType&&("*"==g||j.nodeName.toUpperCase()==g)&&h.push(j);c=h;a=a.replace(i,"");if(0==a.indexOf(" "))continue;g=!0}else if(i=/^([>+~])\s*(\w*)/i,null!=(j=i.exec(a))){h=[];k={};g=j[2].toUpperCase();for(var j=j[1],l=0,o=c.length;l<o;l++)for(var m="~"==j||"+"==j?c[l].nextSibling:c[l].firstChild;m;m=m.nextSibling)if(1==m.nodeType){var q=e.data(m);if("~"==
j&&k[q])break;if(!g||m.nodeName.toUpperCase()==g)"~"==j&&(k[q]=!0),h.push(m);if("+"==j)break}c=h;a=e.trim(a.replace(i,""));g=!0}if(a&&!g)if(a.indexOf(",")){i=w;(j=i.exec(a))?j=[0,j[2],j[3],j[1]]:(i=u,j=i.exec(a));j[2]=j[2].replace(/\\/g,"");g=c[c.length-1];if("#"==j[1]&&g&&g.getElementById&&!e.isXMLDoc(g)){c=g.getElementById(j[2]);if((e.browser.msie||e.browser.opera)&&c&&"string"==typeof c.id&&c.id!=j[2])c=e('[@id="'+j[2]+'"]',g)[0];c=h=c&&(!j[3]||e.nodeName(c,j[3]))?[c]:[]}else{for(k=0;c[k];k++)g=
"#"==j[1]&&j[3]?j[3]:""!=j[1]||""==j[0]?"*":j[2],"*"==g&&"object"==c[k].nodeName.toLowerCase()&&(g="param"),h=e.merge(h,c[k].getElementsByTagName(g));"."==j[1]&&(h=e.classFilter(h,j[2]));if("#"==j[1]){c=[];for(k=0;h[k];k++)if(h[k].getAttribute("id")==j[2]){c=[h[k]];break}h=c}c=h}a=a.replace(i,"")}else b==c[0]&&c.shift(),d=e.merge(d,c),h=c=[b],a=" "+a.substr(1,a.length);if(a)h=e.filter(a,h),c=h.r,a=e.trim(h.t)}a&&(c=[]);c&&b==c[0]&&c.shift();return d=e.merge(d,c)},classFilter:function(a,b,c){for(var b=
" "+b+" ",e=[],d=0;a[d];d++){var f=0<=(" "+a[d].className+" ").indexOf(b);(!c&&f||c&&!f)&&e.push(a[d])}return e},filter:function(a,b,c){for(var d;a&&a!=d;){d=a;for(var f=e.parse,g,i=0;f[i];i++)if(g=f[i].exec(a)){a=a.substring(g[0].length);g[2]=g[2].replace(/\\/g,"");break}if(!g)break;if(":"==g[1]&&"not"==g[2])b=h.test(g[3])?e.filter(g[3],b,!0).r:e(b).not(g[3]);else if("."==g[1])b=e.classFilter(b,g[2],c);else if("["==g[1]){for(var f=[],j=g[3],i=0,k=b.length;i<k;i++){var l=b[i],o=l[e.props[g[2]]||g[2]];
if(null==o||/href|src|selected/.test(g[2]))o=e.attr(l,g[2])||"";(""==j&&!!o||"="==j&&o==g[5]||"!="==j&&o!=g[5]||"^="==j&&o&&!o.indexOf(g[5])||"$="==j&&o.substr(o.length-g[5].length)==g[5]||("*="==j||"~="==j)&&0<=o.indexOf(g[5]))^c&&f.push(l)}b=f}else if(":"==g[1]&&"nth-child"==g[2]){j={};f=[];d=/(-?)(\d*)n((?:\+|-)?\d*)/.exec("even"==g[3]&&"2n"||"odd"==g[3]&&"2n+1"||!/\D/.test(g[3])&&"0n+"+g[3]||g[3]);l=d[1]+(d[2]||1)-0;d=d[3]-0;i=0;for(k=b.length;i<k;i++){var o=b[i],m=o.parentNode,q=e.data(m);if(!j[q]){for(var p=
1,m=m.firstChild;m;m=m.nextSibling)if(1==m.nodeType)m.nodeIndex=p++;j[q]=!0}q=!1;0==l?o.nodeIndex==d&&(q=!0):0==(o.nodeIndex-d)%l&&0<=(o.nodeIndex-d)/l&&(q=!0);q^c&&f.push(o)}b=f}else{var r=e.expr[g[1]];"object"==typeof r&&(r=r[g[2]]);"string"==typeof r&&(r=eval("false||function(a,i){return "+r+";}"));b=e.grep(b,function(a,c){return r(a,c,g,b)},c)}}return{r:b,t:a}},dir:function(a,b){for(var c=[],e=a[b];e&&e!=document;)1==e.nodeType&&c.push(e),e=e[b];return c},nth:function(a,b,c){for(var b=b||1,e=
0;a&&!(1==a.nodeType&&++e==b);a=a[c]);return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1==a.nodeType&&a!=b&&c.push(a);return c}});e.event={add:function(a,b,c,d){if(!(3==a.nodeType||8==a.nodeType)){e.browser.msie&&a.setInterval&&(a=window);if(!c.guid)c.guid=this.guid++;if(d!=i){var f=c,c=this.proxy(f,function(){return f.apply(this,arguments)});c.data=d}var g=e.data(a,"events")||e.data(a,"events",{}),h=e.data(a,"handle")||e.data(a,"handle",function(){if("undefined"!=typeof e&&!e.event.triggered)return e.event.handle.apply(arguments.callee.elem,
arguments)});h.elem=a;e.each(b.split(/\s+/),function(b,d){var f=d.split("."),d=f[0];c.type=f[1];f=g[d];if(!f&&(f=g[d]={},!e.event.special[d]||!1===e.event.special[d].setup.call(a)))a.addEventListener?a.addEventListener(d,h,!1):a.attachEvent&&a.attachEvent("on"+d,h);f[c.guid]=c;e.event.global[d]=!0});a=null}},guid:1,global:{},remove:function(a,b,c){if(!(3==a.nodeType||8==a.nodeType)){var d=e.data(a,"events"),f;if(d){if(b==i||"string"==typeof b&&"."==b.charAt(0))for(var g in d)this.remove(a,g+(b||""));
else{if(b.type)c=b.handler,b=b.type;e.each(b.split(/\s+/),function(b,g){var h=g.split("."),g=h[0];if(d[g]){if(c)delete d[g][c.guid];else for(c in d[g])(!h[1]||d[g][c].type==h[1])&&delete d[g][c];for(f in d[g])break;if(!f){if(!e.event.special[g]||!1===e.event.special[g].teardown.call(a))a.removeEventListener?a.removeEventListener(g,e.data(a,"handle"),!1):a.detachEvent&&a.detachEvent("on"+g,e.data(a,"handle"));f=null;delete d[g]}}})}for(f in d)break;if(!f){if(b=e.data(a,"handle"))b.elem=null;e.removeData(a,
"events");e.removeData(a,"handle")}}}},trigger:function(a,b,c,d,f){b=e.makeArray(b);if(0<=a.indexOf("!"))var a=a.slice(0,-1),g=!0;if(c){if(3==c.nodeType||8==c.nodeType)return i;var h,k=e.isFunction(c[a]||null),l=!b[0]||!b[0].preventDefault;l&&(b.unshift({type:a,target:c,preventDefault:function(){},stopPropagation:function(){},timeStamp:+new Date}),b[0][j]=!0);b[0].type=a;if(g)b[0].exclusive=!0;(g=e.data(c,"handle"))&&(h=g.apply(c,b));if((!k||e.nodeName(c,"a")&&"click"==a)&&c["on"+a]&&!1===c["on"+
a].apply(c,b))h=!1;l&&b.shift();f&&e.isFunction(f)&&(b=f.apply(c,null==h?b:b.concat(h)),b!==i&&(h=b));if(k&&!1!==d&&!1!==h&&!(e.nodeName(c,"a")&&"click"==a)){this.triggered=!0;try{c[a]()}catch(o){}}this.triggered=!1}else this.global[a]&&e("*").add([window,document]).trigger(a,b);return h},handle:function(a){var b,c,d,f,g,a=arguments[0]=e.event.fix(a||window.event);d=a.type.split(".");a.type=d[0];d=d[1];f=!d&&!a.exclusive;g=(e.data(this,"events")||{})[a.type];for(var h in g)if(c=g[h],f||c.type==d)a.handler=
c,a.data=c.data,c=c.apply(this,arguments),!1!==b&&(b=c),!1===c&&(a.preventDefault(),a.stopPropagation());return b},fix:function(a){if(!0==a[j])return a;for(var b=a,a={originalEvent:b},c="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target timeStamp toElement type view wheelDelta which".split(" "),
e=c.length;e;e--)a[c[e]]=b[c[e]];a[j]=!0;a.preventDefault=function(){b.preventDefault&&b.preventDefault();b.returnValue=!1};a.stopPropagation=function(){b.stopPropagation&&b.stopPropagation();b.cancelBubble=!0};a.timeStamp=a.timeStamp||+new Date;if(!a.target)a.target=a.srcElement||document;if(3==a.target.nodeType)a.target=a.target.parentNode;if(!a.relatedTarget&&a.fromElement)a.relatedTarget=a.fromElement==a.target?a.toElement:a.fromElement;if(null==a.pageX&&null!=a.clientX)c=document.documentElement,
e=document.body,a.pageX=a.clientX+(c&&c.scrollLeft||e&&e.scrollLeft||0)-(c.clientLeft||0),a.pageY=a.clientY+(c&&c.scrollTop||e&&e.scrollTop||0)-(c.clientTop||0);if(!a.which&&(a.charCode||0===a.charCode?a.charCode:a.keyCode))a.which=a.charCode||a.keyCode;if(!a.metaKey&&a.ctrlKey)a.metaKey=a.ctrlKey;if(!a.which&&a.button)a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;return a},proxy:function(a,b){b.guid=a.guid=a.guid||b.guid||this.guid++;return b},special:{ready:{setup:function(){c()},teardown:function(){}},
mouseenter:{setup:function(){if(e.browser.msie)return!1;e(this).bind("mouseover",e.event.special.mouseenter.handler);return!0},teardown:function(){if(e.browser.msie)return!1;e(this).unbind("mouseover",e.event.special.mouseenter.handler);return!0},handler:function(a){if(A(a,this))return!0;a.type="mouseenter";return e.event.handle.apply(this,arguments)}},mouseleave:{setup:function(){if(e.browser.msie)return!1;e(this).bind("mouseout",e.event.special.mouseleave.handler);return!0},teardown:function(){if(e.browser.msie)return!1;
e(this).unbind("mouseout",e.event.special.mouseleave.handler);return!0},handler:function(a){if(A(a,this))return!0;a.type="mouseleave";return e.event.handle.apply(this,arguments)}}}};e.fn.extend({bind:function(a,b,c){return"unload"==a?this.one(a,b,c):this.each(function(){e.event.add(this,a,c||b,c&&b)})},one:function(a,b,c){var d=e.event.proxy(c||b,function(a){e(this).unbind(a,d);return(c||b).apply(this,arguments)});return this.each(function(){e.event.add(this,a,d,c&&b)})},unbind:function(a,b){return this.each(function(){e.event.remove(this,
a,b)})},trigger:function(a,b,c){return this.each(function(){e.event.trigger(a,b,this,!0,c)})},triggerHandler:function(a,b,c){return this[0]&&e.event.trigger(a,b,this[0],!1,c)},toggle:function(a){for(var b=arguments,c=1;c<b.length;)e.event.proxy(a,b[c++]);return this.click(e.event.proxy(a,function(a){this.lastToggle=(this.lastToggle||0)%c;a.preventDefault();return b[this.lastToggle++].apply(this,arguments)||!1}))},hover:function(a,b){return this.bind("mouseenter",a).bind("mouseleave",b)},ready:function(a){c();
e.isReady?a.call(document,e):e.readyList.push(function(){return a.call(this,e)});return this}});e.extend({isReady:!1,readyList:[],ready:function(){if(!e.isReady){e.isReady=!0;if(e.readyList)e.each(e.readyList,function(){this.call(document)}),e.readyList=null;e(document).triggerHandler("ready")}}});var z=!1;e.each("blur,focus,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,change,select,submit,keydown,keypress,keyup,error".split(","),function(a,b){e.fn[b]=function(a){return a?
this.bind(b,a):this.trigger(b)}});var A=function(a,b){for(var c=a.relatedTarget;c&&c!=b;)try{c=c.parentNode}catch(e){c=b}return c==b};e(window).bind("unload",function(){e("*").add(document).unbind()});e.fn.extend({_load:e.fn.load,load:function(a,b,c){if("string"!=typeof a)return this._load(a);var d=a.indexOf(" ");if(0<=d)var f=a.slice(d,a.length),a=a.slice(0,d);c=c||function(){};d="GET";b&&(e.isFunction(b)?(c=b,b=null):(b=e.param(b),d="POST"));var g=this;e.ajax({url:a,type:d,dataType:"html",data:b,
complete:function(a,b){if("success"==b||"notmodified"==b)g.html(f?e("<div/>").append(a.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(f):a.responseText);g.each(c,[a.responseText,b,a])}});return this},serialize:function(){return e.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return e.nodeName(this,"form")?e.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/text|hidden|password/i.test(this.type))}).map(function(a,
b){var c=e(this).val();return null==c?null:c.constructor==Array?e.map(c,function(a){return{name:b.name,value:a}}):{name:b.name,value:c}}).get()}});e.each("ajaxStart,ajaxStop,ajaxComplete,ajaxError,ajaxSuccess,ajaxSend".split(","),function(a,b){e.fn[b]=function(a){return this.bind(b,a)}});var x=+new Date;e.extend({get:function(a,b,c,d){e.isFunction(b)&&(c=b,b=null);return e.ajax({type:"GET",url:a,data:b,success:c,dataType:d})},getScript:function(a,b){return e.get(a,null,b,"script")},getJSON:function(a,
b,c){return e.get(a,b,c,"json")},post:function(a,b,c,d){e.isFunction(b)&&(c=b,b={});return e.ajax({type:"POST",url:a,data:b,success:c,dataType:d})},ajaxSetup:function(a){e.extend(e.ajaxSettings,a)},ajaxSettings:{url:location.href,global:!0,type:"GET",timeout:0,contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,data:null,username:null,password:null,accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",
text:"text/plain",_default:"*/*"}},lastModified:{},ajax:function(a){function b(){a.success&&a.success(h,g);a.global&&e.event.trigger("ajaxSuccess",[p,a])}function c(){a.complete&&a.complete(p,g);a.global&&e.event.trigger("ajaxComplete",[p,a]);a.global&&!--e.active&&e.event.trigger("ajaxStop")}var a=e.extend(!0,a,e.extend(!0,{},e.ajaxSettings,a)),d,f=/=\?(&|$)/g,g,h,j=a.type.toUpperCase();if(a.data&&a.processData&&"string"!=typeof a.data)a.data=e.param(a.data);if("jsonp"==a.dataType){if("GET"==j)a.url.match(f)||
(a.url+=(a.url.match(/\?/)?"&":"?")+(a.jsonp||"callback")+"=?");else if(!a.data||!a.data.match(f))a.data=(a.data?a.data+"&":"")+(a.jsonp||"callback")+"=?";a.dataType="json"}if("json"==a.dataType&&(a.data&&a.data.match(f)||a.url.match(f))){d="jsonp"+x++;if(a.data)a.data=(a.data+"").replace(f,"="+d+"$1");a.url=a.url.replace(f,"="+d+"$1");a.dataType="script";window[d]=function(a){h=a;b();c();window[d]=i;try{delete window[d]}catch(e){}l&&l.removeChild(o)}}if("script"==a.dataType&&null==a.cache)a.cache=
!1;if(!1===a.cache&&"GET"==j){var f=+new Date,k=a.url.replace(/(\?|&)_=.*?(&|$)/,"$1_="+f+"$2");a.url=k+(k==a.url?(a.url.match(/\?/)?"&":"?")+"_="+f:"")}if(a.data&&"GET"==j)a.url+=(a.url.match(/\?/)?"&":"?")+a.data,a.data=null;a.global&&!e.active++&&e.event.trigger("ajaxStart");f=/^(?:\w+:)?\/\/([^\/?#]+)/;if("script"==a.dataType&&"GET"==j&&f.test(a.url)&&f.exec(a.url)[1]!=location.host){var l=document.getElementsByTagName("head")[0],o=document.createElement("script");o.src=a.url;if(a.scriptCharset)o.charset=
a.scriptCharset;if(!d){var m=!1;o.onload=o.onreadystatechange=function(){if(!m&&(!this.readyState||"loaded"==this.readyState||"complete"==this.readyState))m=!0,b(),c(),l.removeChild(o)}}l.appendChild(o);return i}var q=!1,p=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;a.username?p.open(j,a.url,a.async,a.username,a.password):p.open(j,a.url,a.async);try{a.data&&p.setRequestHeader("Content-Type",a.contentType),a.ifModified&&p.setRequestHeader("If-Modified-Since",e.lastModified[a.url]||
"Thu, 01 Jan 1970 00:00:00 GMT"),p.setRequestHeader("X-Requested-With","XMLHttpRequest"),p.setRequestHeader("Accept",a.dataType&&a.accepts[a.dataType]?a.accepts[a.dataType]+", */*":a.accepts._default)}catch(r){}if(a.beforeSend&&!1===a.beforeSend(p,a))return a.global&&e.active--,p.abort(),!1;a.global&&e.event.trigger("ajaxSend",[p,a]);var t=function(f){if(!q&&p&&(4==p.readyState||"timeout"==f)){q=!0;u&&(clearInterval(u),u=null);g="timeout"==f&&"timeout"||!e.httpSuccess(p)&&"error"||a.ifModified&&e.httpNotModified(p,
a.url)&&"notmodified"||"success";if("success"==g)try{h=e.httpData(p,a.dataType,a.dataFilter)}catch(i){g="parsererror"}if("success"==g){var j;try{j=p.getResponseHeader("Last-Modified")}catch(k){}a.ifModified&&j&&(e.lastModified[a.url]=j);d||b()}else e.handleError(a,p,g);c();a.async&&(p=null)}};if(a.async){var u=setInterval(t,13);0<a.timeout&&setTimeout(function(){p&&(p.abort(),q||t("timeout"))},a.timeout)}try{p.send(a.data)}catch(w){e.handleError(a,p,null,w)}a.async||t();return p},handleError:function(a,
b,c,d){a.error&&a.error(b,c,d);a.global&&e.event.trigger("ajaxError",[b,a,d])},active:0,httpSuccess:function(a){try{return!a.status&&"file:"==location.protocol||200<=a.status&&300>a.status||304==a.status||1223==a.status||e.browser.safari&&a.status==i}catch(b){}return!1},httpNotModified:function(a,b){try{var c=a.getResponseHeader("Last-Modified");return 304==a.status||c==e.lastModified[b]||e.browser.safari&&a.status==i}catch(d){}return!1},httpData:function(a,b,c){var d=a.getResponseHeader("content-type"),
a=(d="xml"==b||!b&&d&&0<=d.indexOf("xml"))?a.responseXML:a.responseText;if(d&&"parsererror"==a.documentElement.tagName)throw"parsererror";c&&(a=c(a,b));"script"==b&&e.globalEval(a);"json"==b&&(a=eval("("+a+")"));return a},param:function(a){var b=[];if(a.constructor==Array||a.jquery)e.each(a,function(){b.push(encodeURIComponent(this.name)+"="+encodeURIComponent(this.value))});else for(var c in a)a[c]&&a[c].constructor==Array?e.each(a[c],function(){b.push(encodeURIComponent(c)+"="+encodeURIComponent(this))}):
b.push(encodeURIComponent(c)+"="+encodeURIComponent(e.isFunction(a[c])?a[c]():a[c]));return b.join("&").replace(/%20/g,"+")}});e.fn.extend({show:function(a,b){return a?this.animate({height:"show",width:"show",opacity:"show"},a,b):this.filter(":hidden").each(function(){this.style.display=this.oldblock||"";if("none"==e.css(this,"display")){var a=e("<"+this.tagName+" />").appendTo("body");this.style.display=a.css("display");if("none"==this.style.display)this.style.display="block";a.remove()}}).end()},
hide:function(a,b){return a?this.animate({height:"hide",width:"hide",opacity:"hide"},a,b):this.filter(":visible").each(function(){this.oldblock=this.oldblock||e.css(this,"display");this.style.display="none"}).end()},_toggle:e.fn.toggle,toggle:function(a,b){return e.isFunction(a)&&e.isFunction(b)?this._toggle.apply(this,arguments):a?this.animate({height:"toggle",width:"toggle",opacity:"toggle"},a,b):this.each(function(){e(this)[e(this).is(":hidden")?"show":"hide"]()})},slideDown:function(a,b){return this.animate({height:"show"},
a,b)},slideUp:function(a,b){return this.animate({height:"hide"},a,b)},slideToggle:function(a,b){return this.animate({height:"toggle"},a,b)},fadeIn:function(a,b){return this.animate({opacity:"show"},a,b)},fadeOut:function(a,b){return this.animate({opacity:"hide"},a,b)},fadeTo:function(a,b,c){return this.animate({opacity:b},a,c)},animate:function(a,b,c,d){var f=e.speed(b,c,d);return this[!1===f.queue?"each":"queue"](function(){if(1!=this.nodeType)return!1;var b=e.extend({},f),c,d=e(this).is(":hidden"),
g=this;for(c in a){if("hide"==a[c]&&d||"show"==a[c]&&!d)return b.complete.call(this);if("height"==c||"width"==c)b.display=e.css(this,"display"),b.overflow=this.style.overflow}if(null!=b.overflow)this.style.overflow="hidden";b.curAnim=e.extend({},a);e.each(a,function(c,f){var h=new e.fx(g,b,c);if(/toggle|show|hide/.test(f))h["toggle"==f?d?"show":"hide":f](a);else{var i=f.toString().match(/^([+-]=)?([\d+-.]+)(.*)$/),j=h.cur(!0)||0;if(i){var k=parseFloat(i[2]),l=i[3]||"px";"px"!=l&&(g.style[c]=(k||1)+
l,j*=(k||1)/h.cur(!0),g.style[c]=j+l);i[1]&&(k=("-="==i[1]?-1:1)*k+j);h.custom(j,k,l)}else h.custom(j,f,"")}});return!0})},queue:function(a,b){if(e.isFunction(a)||a&&a.constructor==Array)b=a,a="fx";return!a||"string"==typeof a&&!b?v(this[0],a):this.each(function(){b.constructor==Array?v(this,a,b):(v(this,a).push(b),1==v(this,a).length&&b.call(this))})},stop:function(a,b){var c=e.timers;a&&this.queue([]);this.each(function(){for(var a=c.length-1;0<=a;a--)if(c[a].elem==this){if(b)c[a](!0);c.splice(a,
1)}});b||this.dequeue();return this}});var v=function(a,b,c){if(a){var b=b||"fx",d=e.data(a,b+"queue");if(!d||c)d=e.data(a,b+"queue",e.makeArray(c))}return d};e.fn.dequeue=function(a){a=a||"fx";return this.each(function(){var b=v(this,a);b.shift();b.length&&b[0].call(this)})};e.extend({speed:function(a,b,c){var d=a&&a.constructor==Object?a:{complete:c||!c&&b||e.isFunction(a)&&a,duration:a,easing:c&&b||b&&b.constructor!=Function&&b};d.duration=(d.duration&&d.duration.constructor==Number?d.duration:
e.fx.speeds[d.duration])||e.fx.speeds.def;d.old=d.complete;d.complete=function(){!1!==d.queue&&e(this).dequeue();e.isFunction(d.old)&&d.old.call(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+0.5)*d+c}},timers:[],timerId:null,fx:function(a,b,c){this.options=b;this.elem=a;this.prop=c;if(!b.orig)b.orig={}}});e.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(e.fx.step[this.prop]||
e.fx.step._default)(this);if("height"==this.prop||"width"==this.prop)this.elem.style.display="block"},cur:function(a){return null!=this.elem[this.prop]&&null==this.elem.style[this.prop]?this.elem[this.prop]:(a=parseFloat(e.css(this.elem,this.prop,a)))&&-1E4<a?a:parseFloat(e.curCSS(this.elem,this.prop))||0},custom:function(a,b,c){function d(a){return f.step(a)}this.startTime=+new Date;this.start=a;this.end=b;this.unit=c||this.unit||"px";this.now=this.start;this.pos=this.state=0;this.update();var f=
this;d.elem=this.elem;e.timers.push(d);if(null==e.timerId)e.timerId=setInterval(function(){for(var a=e.timers,b=0;b<a.length;b++)a[b]()||a.splice(b--,1);if(!a.length)clearInterval(e.timerId),e.timerId=null},13)},show:function(){this.options.orig[this.prop]=e.attr(this.elem.style,this.prop);this.options.show=!0;this.custom(0,this.cur());if("width"==this.prop||"height"==this.prop)this.elem.style[this.prop]="1px";e(this.elem).show()},hide:function(){this.options.orig[this.prop]=e.attr(this.elem.style,
this.prop);this.options.hide=!0;this.custom(this.cur(),0)},step:function(a){var b=+new Date;if(a||b>this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();var a=this.options.curAnim[this.prop]=!0,c;for(c in this.options.curAnim)!0!==this.options.curAnim[c]&&(a=!1);if(a){if(null!=this.options.display&&(this.elem.style.overflow=this.options.overflow,this.elem.style.display=this.options.display,"none"==e.css(this.elem,"display")))this.elem.style.display="block";if(this.options.hide)this.elem.style.display=
"none";if(this.options.hide||this.options.show)for(var d in this.options.curAnim)e.attr(this.elem.style,d,this.options.orig[d])}a&&this.options.complete.call(this.elem);return!1}c=b-this.startTime;this.state=c/this.options.duration;this.pos=e.easing[this.options.easing||(e.easing.swing?"swing":"linear")](this.state,c,0,1,this.options.duration);this.now=this.start+(this.end-this.start)*this.pos;this.update();return!0}};e.extend(e.fx,{speeds:{slow:600,fast:200,def:400},step:{scrollLeft:function(a){a.elem.scrollLeft=
a.now},scrollTop:function(a){a.elem.scrollTop=a.now},opacity:function(a){e.attr(a.elem.style,"opacity",a.now)},_default:function(a){a.elem.style[a.prop]=a.now+a.unit}}});e.fn.offset=function(){function a(c){b(e.curCSS(c,"borderLeftWidth",!0),e.curCSS(c,"borderTopWidth",!0))}function b(a,e){c+=parseInt(a,10)||0;d+=parseInt(e,10)||0}var c=0,d=0,f=this[0],g;if(f)with(e.browser){var h=f.parentNode,i=f,j=f.offsetParent;g=f.ownerDocument;var k=safari&&522>parseInt(version)&&!/adobeair/i.test(o),l=e.curCSS,
m="fixed"==l(f,"position");if(f.getBoundingClientRect)f=f.getBoundingClientRect(),b(f.left+Math.max(g.documentElement.scrollLeft,g.body.scrollLeft),f.top+Math.max(g.documentElement.scrollTop,g.body.scrollTop)),b(-g.documentElement.clientLeft,-g.documentElement.clientTop);else{for(b(f.offsetLeft,f.offsetTop);j;)b(j.offsetLeft,j.offsetTop),(mozilla&&!/^t(able|d|h)$/i.test(j.tagName)||safari&&!k)&&a(j),!m&&"fixed"==l(j,"position")&&(m=!0),i=/^body$/i.test(j.tagName)?i:j,j=j.offsetParent;for(;h&&h.tagName&&
!/^body|html$/i.test(h.tagName);)/^inline|table.*$/i.test(l(h,"display"))||b(-h.scrollLeft,-h.scrollTop),mozilla&&"visible"!=l(h,"overflow")&&a(h),h=h.parentNode;(k&&(m||"absolute"==l(i,"position"))||mozilla&&"absolute"!=l(i,"position"))&&b(-g.body.offsetLeft,-g.body.offsetTop);m&&b(Math.max(g.documentElement.scrollLeft,g.body.scrollLeft),Math.max(g.documentElement.scrollTop,g.body.scrollTop))}g={top:d,left:c}}return g};e.fn.extend({position:function(){var a;if(this[0]){a=this.offsetParent();var c=
this.offset(),d=/^body|html$/i.test(a[0].tagName)?{top:0,left:0}:a.offset();c.top-=b(this,"marginTop");c.left-=b(this,"marginLeft");d.top+=b(a,"borderTopWidth");d.left+=b(a,"borderLeftWidth");a={top:c.top-d.top,left:c.left-d.left}}return a},offsetParent:function(){for(var a=this[0].offsetParent;a&&!/^body|html$/i.test(a.tagName)&&"static"==e.css(a,"position");)a=a.offsetParent;return e(a)}});e.each(["Left","Top"],function(a,b){var c="scroll"+b;e.fn[c]=function(b){return!this[0]?void 0:b!=i?this.each(function(){this==
window||this==document?window.scrollTo(!a?b:e(window).scrollLeft(),a?b:e(window).scrollTop()):this[c]=b}):this[0]==window||this[0]==document?self[a?"pageYOffset":"pageXOffset"]||e.boxModel&&document.documentElement[c]||document.body[c]:this[0][c]}});e.each(["Height","Width"],function(a,c){var d=a?"Left":"Top",f=a?"Right":"Bottom";e.fn["inner"+c]=function(){return this[c.toLowerCase()]()+b(this,"padding"+d)+b(this,"padding"+f)};e.fn["outer"+c]=function(a){return this["inner"+c]()+b(this,"border"+d+
"Width")+b(this,"border"+f+"Width")+(a?b(this,"margin"+d)+b(this,"margin"+f):0)}})})();SimileAjax.version="pre 2.3.0";SimileAjax.jQuery=jQuery.noConflict(!0);if("undefined"==typeof window.$)window.$=SimileAjax.jQuery;SimileAjax.Platform.os={isMac:!1,isWin:!1,isWin32:!1,isUnix:!1};SimileAjax.Platform.browser={isIE:!1,isNetscape:!1,isMozilla:!1,isFirefox:!1,isOpera:!1,isSafari:!1,majorVersion:0,minorVersion:0};
(function(){var a=navigator.appName.toLowerCase(),b=navigator.userAgent.toLowerCase();SimileAjax.Platform.os.isMac=-1!=b.indexOf("mac");SimileAjax.Platform.os.isWin=-1!=b.indexOf("win");SimileAjax.Platform.os.isWin32=SimileAjax.Platform.isWin&&(-1!=b.indexOf("95")||-1!=b.indexOf("98")||-1!=b.indexOf("nt")||-1!=b.indexOf("win32")||-1!=b.indexOf("32bit"));SimileAjax.Platform.os.isUnix=-1!=b.indexOf("x11");SimileAjax.Platform.browser.isIE=-1!=a.indexOf("microsoft");SimileAjax.Platform.browser.isNetscape=
-1!=a.indexOf("netscape");SimileAjax.Platform.browser.isMozilla=-1!=b.indexOf("mozilla");SimileAjax.Platform.browser.isFirefox=-1!=b.indexOf("firefox");SimileAjax.Platform.browser.isOpera=-1!=a.indexOf("opera");SimileAjax.Platform.browser.isSafari=-1!=a.indexOf("safari");var a=function(a){a=a.split(".");SimileAjax.Platform.browser.majorVersion=parseInt(a[0]);SimileAjax.Platform.browser.minorVersion=parseInt(a[1])},c=function(a,b,c){b=a.indexOf(b,c);return 0<=b?b:a.length};if(SimileAjax.Platform.browser.isMozilla){var d=
b.indexOf("mozilla/");0<=d&&a(b.substring(d+8,c(b," ",d)))}SimileAjax.Platform.browser.isIE&&(d=b.indexOf("msie "),0<=d&&a(b.substring(d+5,c(b,";",d))));SimileAjax.Platform.browser.isNetscape&&(d=b.indexOf("rv:"),0<=d&&a(b.substring(d+3,c(b,")",d))));SimileAjax.Platform.browser.isFirefox&&(d=b.indexOf("firefox/"),0<=d&&a(b.substring(d+8,c(b," ",d))));if(!("localeCompare"in String.prototype))String.prototype.localeCompare=function(a){return this<a?-1:this>a?1:0}})();
SimileAjax.Platform.getDefaultLocale=function(){return SimileAjax.Platform.clientLocale};SimileAjax.Debug={silent:!1};SimileAjax.Debug.log=function(a){var b;b="console"in window&&"log"in window.console?function(a){console.log(a)}:function(a){SimileAjax.Debug.silent||alert(a)};SimileAjax.Debug.log=b;b(a)};SimileAjax.Debug.warn=function(a){var b;b="console"in window&&"warn"in window.console?function(a){console.warn(a)}:function(a){SimileAjax.Debug.silent||alert(a)};SimileAjax.Debug.warn=b;b(a)};
SimileAjax.Debug.exception=function(a,b){var c;c="throw"==SimileAjax.parseURLParameters().errors||"throw"==SimileAjax.params.errors?function(a){throw a;}:"console"in window&&"error"in window.console?function(a,b){null!=b?console.error(b+" %o",a):console.error(a);throw a;}:function(a,b){SimileAjax.Debug.silent||alert("Caught exception: "+b+"\n\nDetails: "+("description"in a?a.description:a));throw a;};SimileAjax.Debug.exception=c;c(a,b)};
SimileAjax.Debug.objectToString=function(a){return SimileAjax.Debug._objectToString(a,"")};SimileAjax.Debug._objectToString=function(a,b){var c=b+" ";if("object"==typeof a){var d="{";for(f in a)d+=c+f+": "+SimileAjax.Debug._objectToString(a[f],c)+"\n";return d+(b+"}")}if("array"==typeof a){for(var d="[",f=0;f<a.length;f++)d+=SimileAjax.Debug._objectToString(a[f],c)+"\n";return d+(b+"]")}return a};SimileAjax.XmlHttp={};
SimileAjax.XmlHttp._onReadyStateChange=function(a,b,c){switch(a.readyState){case 4:try{0==a.status||200==a.status?c&&c(a):b&&b(a.statusText,a.status,a)}catch(d){SimileAjax.Debug.exception("XmlHttp: Error handling onReadyStateChange",d)}}};
SimileAjax.XmlHttp._createRequest=function(){if(SimileAjax.Platform.browser.isIE)for(var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b=0;b<a.length;b++)try{var c=a[b],d=function(){return new ActiveXObject(c)},f=d();SimileAjax.XmlHttp._createRequest=d;return f}catch(e){}try{return d=function(){return new XMLHttpRequest},f=d(),SimileAjax.XmlHttp._createRequest=d,f}catch(g){throw Error("Failed to create an XMLHttpRequest object");}};
SimileAjax.XmlHttp.get=function(a,b,c){var d=SimileAjax.XmlHttp._createRequest();d.open("GET",a,!0);d.onreadystatechange=function(){SimileAjax.XmlHttp._onReadyStateChange(d,b,c)};d.send(null)};SimileAjax.XmlHttp.post=function(a,b,c,d){var f=SimileAjax.XmlHttp._createRequest();f.open("POST",a,!0);f.onreadystatechange=function(){SimileAjax.XmlHttp._onReadyStateChange(f,c,d)};f.send(b)};
SimileAjax.XmlHttp._forceXML=function(a){try{a.overrideMimeType("text/xml")}catch(b){a.setrequestheader("Content-Type","text/xml")}};SimileAjax.JSON={};
(function(){var a={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b={array:function(a){var d=["["],f,e,g,h=a.length,i;for(g=0;g<h;g+=1)if(i=a[g],e=b[typeof i])i=e(i),"string"==typeof i&&(f&&(d[d.length]=","),d[d.length]=i,f=!0);d[d.length]="]";return d.join("")},"boolean":function(a){return""+a},"null":function(){return"null"},number:function(a){return isFinite(a)?""+a:"null"},object:function(a){if(a){if(a instanceof Array)return b.array(a);var d=["{"],f,e,g,
h;for(g in a)if(h=a[g],e=b[typeof h])h=e(h),"string"==typeof h&&(f&&(d[d.length]=","),d.push(b.string(g),":",h),f=!0);d[d.length]="}";return d.join("")}return"null"},string:function(b){/["\\\x00-\x1f]/.test(b)&&(b=b.replace(/([\x00-\x1f\\"])/g,function(b,c){var e=a[c];if(e)return e;e=c.charCodeAt();return"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16)}));return'"'+b+'"'}};SimileAjax.JSON.toJSONString=function(a){return a instanceof Object?b.object(a):a instanceof Array?b.array(a):a.toString()};
SimileAjax.JSON.parseJSON=function(){try{return!/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(this.replace(/"(\\.|[^"\\])*"/g,""))&&eval("("+this+")")}catch(a){return!1}}})();SimileAjax.DOM={};SimileAjax.DOM.registerEventWithObject=function(a,b,c,d){SimileAjax.DOM.registerEvent(a,b,function(a,b,g){return c[d].call(c,a,b,g)})};
SimileAjax.DOM.registerEvent=function(a,b,c){var d=function(b){if(b=b?b:event?event:null){var d=b.target?b.target:b.srcElement?b.srcElement:null;d&&(d=1==d.nodeType||9==d.nodeType?d:d.parentNode);return c(a,b,d)}return!0};SimileAjax.Platform.browser.isIE?a.attachEvent("on"+b,d):a.addEventListener(b,d,!1)};
SimileAjax.DOM.getPageCoordinates=function(a){var b=0,c=0;if(1!=a.nodeType)a=a.parentNode;for(var d=a;null!=d;)b+=d.offsetLeft,c+=d.offsetTop,d=d.offsetParent;for(d=document.body;null!=a&&a!=d;)"scrollLeft"in a&&(b-=a.scrollLeft,c-=a.scrollTop),a=a.parentNode;return{left:b,top:c}};SimileAjax.DOM.getSize=function(a){var b=this.getStyle(a,"width"),a=this.getStyle(a,"height");-1<b.indexOf("px")&&(b=b.replace("px",""));-1<a.indexOf("px")&&(a=a.replace("px",""));return{w:b,h:a}};
SimileAjax.DOM.getStyle=function(a,b){return a.currentStyle?a.currentStyle[b]:window.getComputedStyle?document.defaultView.getComputedStyle(a,null).getPropertyValue(b):""};
SimileAjax.DOM.getEventRelativeCoordinates=function(a,b){if(SimileAjax.Platform.browser.isIE){if("mousewheel"==a.type){var c=SimileAjax.DOM.getPageCoordinates(b);return{x:a.clientX-c.left,y:a.clientY-c.top}}return{x:a.offsetX,y:a.offsetY}}c=SimileAjax.DOM.getPageCoordinates(b);return"DOMMouseScroll"==a.type&&SimileAjax.Platform.browser.isFirefox&&2==SimileAjax.Platform.browser.majorVersion?{x:a.screenX-c.left,y:a.screenY-c.top}:{x:a.pageX-c.left,y:a.pageY-c.top}};
SimileAjax.DOM.getEventPageCoordinates=function(a){return SimileAjax.Platform.browser.isIE?{x:a.clientX+document.body.scrollLeft,y:a.clientY+document.body.scrollTop}:{x:a.pageX,y:a.pageY}};SimileAjax.DOM.hittest=function(a,b,c){return SimileAjax.DOM._hittest(document.body,a,b,c)};
SimileAjax.DOM._hittest=function(a,b,c,d){var f=a.childNodes,e=0;a:for(;e<f.length;e++){for(var g=f[e],h=0;h<d.length;h++)if(g==d[h])continue a;if(0==g.offsetWidth&&0==g.offsetHeight){if(h=SimileAjax.DOM._hittest(g,b,c,d),h!=g)return h}else{for(var i=h=0,j=g;j;)h+=j.offsetTop,i+=j.offsetLeft,j=j.offsetParent;if(i<=b&&h<=c&&b-i<g.offsetWidth&&c-h<g.offsetHeight)return SimileAjax.DOM._hittest(g,b,c,d);if(1==g.nodeType&&"TR"==g.tagName&&(h=SimileAjax.DOM._hittest(g,b,c,d),h!=g))return h}}return a};
SimileAjax.DOM.cancelEvent=function(a){a.returnValue=!1;a.cancelBubble=!0;"preventDefault"in a&&a.preventDefault()};SimileAjax.DOM.appendClassName=function(a,b){for(var c=a.className.split(" "),d=0;d<c.length;d++)if(c[d]==b)return;c.push(b);a.className=c.join(" ")};SimileAjax.DOM.createInputElement=function(a){var b=document.createElement("div");b.innerHTML="<input type='"+a+"' />";return b.firstChild};
SimileAjax.DOM.createDOMFromTemplate=function(a){var b={};b.elmt=SimileAjax.DOM._createDOMFromTemplate(a,b,null);return b};
SimileAjax.DOM._createDOMFromTemplate=function(a,b,c){if(null==a)return null;if("object"!=typeof a)return a=document.createTextNode(a),null!=c&&c.appendChild(a),a;var d=null;if("tag"in a){var f=a.tag;null!=c&&("tr"==f?d=c.insertRow(c.rows.length):"td"==f&&(d=c.insertCell(c.cells.length)));null==d&&(d="input"==f?SimileAjax.DOM.createInputElement(a.type):document.createElement(f),null!=c&&c.appendChild(d))}else d=a.elmt,null!=c&&c.appendChild(d);for(var e in a)if(c=a[e],"field"==e)b[c]=d;else if("className"==
e)d.className=c;else if("id"==e)d.id=c;else if("title"==e)d.title=c;else if(!("type"==e&&"input"==d.tagName))if("style"==e)for(n in c)f=c[n],"float"==n&&(n=SimileAjax.Platform.browser.isIE?"styleFloat":"cssFloat"),d.style[n]=f;else if("children"==e)for(f=0;f<c.length;f++)SimileAjax.DOM._createDOMFromTemplate(c[f],b,d);else"tag"!=e&&"elmt"!=e&&d.setAttribute(e,c);return d};SimileAjax.DOM._cachedParent=null;
SimileAjax.DOM.createElementFromString=function(a){if(null==SimileAjax.DOM._cachedParent)SimileAjax.DOM._cachedParent=document.createElement("div");SimileAjax.DOM._cachedParent.innerHTML=a;return SimileAjax.DOM._cachedParent.firstChild};SimileAjax.DOM.createDOMFromString=function(a,b,c){a="string"==typeof a?document.createElement(a):a;a.innerHTML=b;b={elmt:a};SimileAjax.DOM._processDOMChildrenConstructedFromString(b,a,null!=c?c:{});return b};
SimileAjax.DOM._processDOMConstructedFromString=function(a,b,c){var d=b.id;if(null!=d&&0<d.length){b.removeAttribute("id");if(d in c){var f=b.parentNode;f.insertBefore(c[d],b);f.removeChild(b);a[d]=c[d];return}a[d]=b}b.hasChildNodes()&&SimileAjax.DOM._processDOMChildrenConstructedFromString(a,b,c)};SimileAjax.DOM._processDOMChildrenConstructedFromString=function(a,b,c){for(b=b.firstChild;null!=b;){var d=b.nextSibling;1==b.nodeType&&SimileAjax.DOM._processDOMConstructedFromString(a,b,c);b=d}};
SimileAjax.Graphics={};SimileAjax.Graphics.pngIsTranslucent=!SimileAjax.Platform.browser.isIE||6<SimileAjax.Platform.browser.majorVersion;SimileAjax.Graphics.pngIsTranslucent||SimileAjax.includeCssFile(document,SimileAjax.urlPrefix+"styles/graphics-ie6.css");SimileAjax.Graphics._createTranslucentImage1=function(a,b){var c=document.createElement("img");c.setAttribute("src",a);if(null!=b)c.style.verticalAlign=b;return c};
SimileAjax.Graphics._createTranslucentImage2=function(a,b){var c=document.createElement("img");c.style.width="1px";c.style.height="1px";c.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a+"', sizingMethod='image')";c.style.verticalAlign=null!=b?b:"middle";return c};SimileAjax.Graphics.createTranslucentImage=SimileAjax.Graphics.pngIsTranslucent?SimileAjax.Graphics._createTranslucentImage1:SimileAjax.Graphics._createTranslucentImage2;
SimileAjax.Graphics._createTranslucentImageHTML1=function(a,b){return'<img src="'+a+'"'+(null!=b?' style="vertical-align: '+b+';"':"")+" />"};SimileAjax.Graphics._createTranslucentImageHTML2=function(a,b){return"<img src='"+a+"' style=\""+("width: 1px; height: 1px; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a+"', sizingMethod='image');"+(null!=b?" vertical-align: "+b+";":""))+'" />'};
SimileAjax.Graphics.createTranslucentImageHTML=SimileAjax.Graphics.pngIsTranslucent?SimileAjax.Graphics._createTranslucentImageHTML1:SimileAjax.Graphics._createTranslucentImageHTML2;SimileAjax.Graphics.setOpacity=function(a,b){if(SimileAjax.Platform.browser.isIE)a.style.filter="progid:DXImageTransform.Microsoft.Alpha(Style=0,Opacity="+b+")";else{var c=(b/100).toString();a.style.opacity=c;a.style.MozOpacity=c}};
SimileAjax.Graphics.bubbleConfig={containerCSSClass:"simileAjax-bubble-container",innerContainerCSSClass:"simileAjax-bubble-innerContainer",contentContainerCSSClass:"simileAjax-bubble-contentContainer",borderGraphicSize:50,borderGraphicCSSClassPrefix:"simileAjax-bubble-border-",arrowGraphicTargetOffset:33,arrowGraphicLength:100,arrowGraphicWidth:49,arrowGraphicCSSClassPrefix:"simileAjax-bubble-arrow-",closeGraphicCSSClass:"simileAjax-bubble-close",extraPadding:20};
SimileAjax.Graphics.createBubbleForContentAndPoint=function(a,b,c,d,f,e){"number"!=typeof d&&(d=300);"number"!=typeof e&&(e=0);a.style.position="absolute";a.style.left="-5000px";a.style.top="0px";a.style.width=d+"px";document.body.appendChild(a);window.setTimeout(function(){var d=a.scrollWidth+10,h=a.scrollHeight+10,i=0;0<e&&h>e&&(h=e,i=d-25);h=SimileAjax.Graphics.createBubbleForPoint(b,c,d,h,f);document.body.removeChild(a);a.style.position="static";a.style.left="";a.style.top="";0<i?(d=document.createElement("div"),
a.style.width="",d.style.width=i+"px",d.appendChild(a),h.content.appendChild(d)):(a.style.width=d+"px",h.content.appendChild(a))},200)};
SimileAjax.Graphics.createBubbleForPoint=function(a,b,c,d,f){var c=parseInt(c,10),d=parseInt(d,10),e=SimileAjax.Graphics.bubbleConfig,g=SimileAjax.Graphics.pngIsTranslucent?"pngTranslucent":"pngNotTranslucent",h=function(a){return a+" "+a+"-"+g},i=document.createElement("div");i.className=h(e.containerCSSClass);i.style.width=c+"px";i.style.height=d+"px";var j=document.createElement("div");j.className=h(e.innerContainerCSSClass);i.appendChild(j);var l={_closed:!1},k=SimileAjax.WindowManager.pushLayer(function(){if(!l._closed)document.body.removeChild(l._div),
l._doc=null,l._div=null,l._content=null,l._closed=!0},!0,i);l._div=i;l.close=function(){SimileAjax.WindowManager.popLayer(k)};var m=function(a){var b=document.createElement("div");b.className=h(e.borderGraphicCSSClassPrefix+a);j.appendChild(b)};m("top-left");m("top-right");m("bottom-left");m("bottom-right");m("left");m("right");m("top");m("bottom");m=document.createElement("div");m.className=h(e.contentContainerCSSClass);j.appendChild(m);l.content=m;m=document.createElement("div");m.className=h(e.closeGraphicCSSClass);
j.appendChild(m);SimileAjax.WindowManager.registerEventWithObject(m,"click",l,"close");(function(){var g=SimileAjax.Graphics.getWindowDimensions(),k=g.w,l=g.h,g=Math.ceil(e.arrowGraphicWidth/2),m=function(a){var b=document.createElement("div");b.className=h(e.arrowGraphicCSSClassPrefix+"point-"+a);j.appendChild(b);return b};if(0<a-g-e.borderGraphicSize-e.extraPadding&&a+g+e.borderGraphicSize+e.extraPadding<k){var t=a-Math.round(c/2),t=a<k/2?Math.max(t,e.extraPadding+e.borderGraphicSize):Math.min(t,
k-e.extraPadding-e.borderGraphicSize-c);if(f&&"top"==f||!f&&0<b-e.arrowGraphicTargetOffset-d-e.borderGraphicSize-e.extraPadding){l=m("down");l.style.left=a-g-t+"px";i.style.left=t+"px";i.style.top=b-e.arrowGraphicTargetOffset-d+"px";return}if(f&&"bottom"==f||!f&&b+e.arrowGraphicTargetOffset+d+e.borderGraphicSize+e.extraPadding<l){l=m("up");l.style.left=a-g-t+"px";i.style.left=t+"px";i.style.top=b+e.arrowGraphicTargetOffset+"px";return}}k=b-Math.round(d/2);k=b<l/2?Math.max(k,e.extraPadding+e.borderGraphicSize):
Math.min(k,l-e.extraPadding-e.borderGraphicSize-d);f&&"left"==f||!f&&0<a-e.arrowGraphicTargetOffset-c-e.borderGraphicSize-e.extraPadding?(l=m("right"),l.style.top=b-g-k+"px",i.style.top=k+"px",i.style.left=a-e.arrowGraphicTargetOffset-c+"px"):(l=m("left"),l.style.top=b-g-k+"px",i.style.top=k+"px",i.style.left=a+e.arrowGraphicTargetOffset+"px")})();document.body.appendChild(i);return l};
SimileAjax.Graphics.getWindowDimensions=function(){if("number"==typeof window.innerHeight)return{w:window.innerWidth,h:window.innerHeight};if(document.documentElement&&document.documentElement.clientHeight)return{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight};if(document.body&&document.body.clientHeight)return{w:document.body.clientWidth,h:document.body.clientHeight}};
SimileAjax.Graphics.createMessageBubble=function(a){var b=a.createElement("div");if(SimileAjax.Graphics.pngIsTranslucent){var c=a.createElement("div");c.style.height="33px";c.style.background="url("+SimileAjax.urlPrefix+"images/message-top-left.png) top left no-repeat";c.style.paddingLeft="44px";b.appendChild(c);var d=a.createElement("div");d.style.height="33px";d.style.background="url("+SimileAjax.urlPrefix+"images/message-top-right.png) top right no-repeat";c.appendChild(d);c=a.createElement("div");
c.style.background="url("+SimileAjax.urlPrefix+"images/message-left.png) top left repeat-y";c.style.paddingLeft="44px";b.appendChild(c);d=a.createElement("div");d.style.background="url("+SimileAjax.urlPrefix+"images/message-right.png) top right repeat-y";d.style.paddingRight="44px";c.appendChild(d);c=a.createElement("div");d.appendChild(c);d=a.createElement("div");d.style.height="55px";d.style.background="url("+SimileAjax.urlPrefix+"images/message-bottom-left.png) bottom left no-repeat";d.style.paddingLeft=
"44px";b.appendChild(d);a=a.createElement("div");a.style.height="55px";a.style.background="url("+SimileAjax.urlPrefix+"images/message-bottom-right.png) bottom right no-repeat";d.appendChild(a)}else b.style.border="2px solid #7777AA",b.style.padding="20px",b.style.background="white",SimileAjax.Graphics.setOpacity(b,90),c=a.createElement("div"),b.appendChild(c);return{containerDiv:b,contentDiv:c}};
SimileAjax.Graphics.createAnimation=function(a,b,c,d,f){return new SimileAjax.Graphics._Animation(a,b,c,d,f)};SimileAjax.Graphics._Animation=function(a,b,c,d,f){this.f=a;this.cont="function"==typeof f?f:function(){};this.from=b;this.to=c;this.current=b;this.duration=d;this.start=(new Date).getTime();this.timePassed=0};SimileAjax.Graphics._Animation.prototype.run=function(){var a=this;window.setTimeout(function(){a.step()},50)};
SimileAjax.Graphics._Animation.prototype.step=function(){this.timePassed+=50;var a=(-Math.cos(this.timePassed/this.duration*Math.PI)/2+0.5)*(this.to-this.from)+this.from;try{this.f(a,a-this.current)}catch(b){}this.current=a;this.timePassed<this.duration?this.run():(this.f(this.to,0),this.cont())};
SimileAjax.Graphics.createStructuredDataCopyButton=function(a,b,c,d){var f=document.createElement("div");f.style.position="relative";f.style.display="inline";f.style.width=b+"px";f.style.height=c+"px";f.style.overflow="hidden";f.style.margin="2px";SimileAjax.Graphics.pngIsTranslucent?f.style.background="url("+a+") no-repeat":f.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a+"', sizingMethod='image')";f.innerHTML="<textarea rows='1' autocomplete='off' value='none' style='"+
(SimileAjax.Platform.browser.isIE?"filter:alpha(opacity=0)":"opacity: 0")+"' />";var e=f.firstChild;e.style.width=b+"px";e.style.height=c+"px";e.onmousedown=function(a){if(2==(a?a:event?event:null).button)e.value=d(),e.select()};return f};SimileAjax.Graphics.getWidthHeight=function(a){var b;null==a.getBoundingClientRect?(b=a.offsetWidth,a=a.offsetHeight):(a=a.getBoundingClientRect(),b=Math.ceil(a.right-a.left),a=Math.ceil(a.bottom-a.top));return{width:b,height:a}};
SimileAjax.Graphics.getFontRenderingContext=function(a,b){return new SimileAjax.Graphics._FontRenderingContext(a,b)};SimileAjax.Graphics._FontRenderingContext=function(a,b){this._elmt=a;this._elmt.style.visibility="hidden";if("string"==typeof b)this._elmt.style.width=b;else if("number"==typeof b)this._elmt.style.width=b+"px"};SimileAjax.Graphics._FontRenderingContext.prototype.dispose=function(){this._elmt=null};
SimileAjax.Graphics._FontRenderingContext.prototype.update=function(){this._elmt.innerHTML="A";this._lineHeight=this._elmt.offsetHeight};SimileAjax.Graphics._FontRenderingContext.prototype.computeSize=function(a,b){var c=this._elmt;c.innerHTML=a;c.className=void 0===b?"":b;var d=SimileAjax.Graphics.getWidthHeight(c);c.className="";return d};SimileAjax.Graphics._FontRenderingContext.prototype.getLineHeight=function(){return this._lineHeight};SimileAjax.DateTime={};SimileAjax.DateTime.MILLISECOND=0;
SimileAjax.DateTime.SECOND=1;SimileAjax.DateTime.MINUTE=2;SimileAjax.DateTime.HOUR=3;SimileAjax.DateTime.DAY=4;SimileAjax.DateTime.WEEK=5;SimileAjax.DateTime.MONTH=6;SimileAjax.DateTime.YEAR=7;SimileAjax.DateTime.DECADE=8;SimileAjax.DateTime.CENTURY=9;SimileAjax.DateTime.MILLENNIUM=10;SimileAjax.DateTime.EPOCH=-1;SimileAjax.DateTime.ERA=-2;SimileAjax.DateTime.gregorianUnitLengths=[];
(function(){var a=SimileAjax.DateTime,b=a.gregorianUnitLengths;b[a.MILLISECOND]=1;b[a.SECOND]=1E3;b[a.MINUTE]=60*b[a.SECOND];b[a.HOUR]=60*b[a.MINUTE];b[a.DAY]=24*b[a.HOUR];b[a.WEEK]=7*b[a.DAY];b[a.MONTH]=31*b[a.DAY];b[a.YEAR]=365*b[a.DAY];b[a.DECADE]=10*b[a.YEAR];b[a.CENTURY]=100*b[a.YEAR];b[a.MILLENNIUM]=1E3*b[a.YEAR]})();SimileAjax.DateTime._dateRegexp=/^(-?)([0-9]{4})((-?([0-9]{2})(-?([0-9]{2}))?)|(-?([0-9]{3}))|(-?W([0-9]{2})(-?([1-7]))?))?$/;SimileAjax.DateTime._timezoneRegexp=/Z|(([-+])([0-9]{2})(:?([0-9]{2}))?)$/;
SimileAjax.DateTime._timeRegexp=/^([0-9]{2})(:?([0-9]{2})(:?([0-9]{2})(.([0-9]+))?)?)?$/;
SimileAjax.DateTime.setIso8601Date=function(a,b){var c=b.match(SimileAjax.DateTime._dateRegexp);if(!c)throw Error("Invalid date string: "+b);var d=c[5],f=c[7],e=c[9],g=c[11],h=c[13]?c[13]:1;a.setUTCFullYear(("-"==c[1]?-1:1)*c[2]);e?(a.setUTCMonth(0),a.setUTCDate(Number(e))):g?(a.setUTCMonth(0),a.setUTCDate(1),c=(c=a.getUTCDay())?c:7,g=Number(h)+7*Number(g),4>=c?a.setUTCDate(g+1-c):a.setUTCDate(g+8-c)):(d&&(a.setUTCDate(1),a.setUTCMonth(d-1)),f&&a.setUTCDate(f));return a};
SimileAjax.DateTime.setIso8601Time=function(a,b){var c=b.match(SimileAjax.DateTime._timeRegexp);if(!c)return SimileAjax.Debug.warn("Invalid time string: "+b),!1;var d=Number(c[3]?c[3]:0),f=c[5]?c[5]:0,e=c[7]?1E3*Number("0."+c[7]):0;a.setUTCHours(c[1]);a.setUTCMinutes(d);a.setUTCSeconds(f);a.setUTCMilliseconds(e);return a};SimileAjax.DateTime.timezoneOffset=(new Date).getTimezoneOffset();
SimileAjax.DateTime.setIso8601=function(a,b){var c=null,d=-1==b.indexOf("T")?b.split(" "):b.split("T");SimileAjax.DateTime.setIso8601Date(a,d[0]);if(2==d.length){var f=d[1].match(SimileAjax.DateTime._timezoneRegexp);f&&("Z"==f[0]?c=0:(c=60*Number(f[3])+Number(f[5]),c*="-"==f[2]?1:-1),d[1]=d[1].substr(0,d[1].length-f[0].length));SimileAjax.DateTime.setIso8601Time(a,d[1])}null==c&&(c=a.getTimezoneOffset());a.setTime(a.getTime()+6E4*c);return a};
SimileAjax.DateTime.parseIso8601DateTime=function(a){try{return SimileAjax.DateTime.setIso8601(new Date(0),a)}catch(b){return null}};SimileAjax.DateTime.parseGregorianDateTime=function(a){if(null==a)return null;if(a instanceof Date)return a;var b=a.toString();if(0<b.length&&8>b.length){var c=b.indexOf(" ");0<c?(a=parseInt(b.substr(0,c)),"bc"==b.substr(c+1).toLowerCase()&&(a=1-a)):a=parseInt(b);b=new Date(0);b.setUTCFullYear(a);return b}try{return new Date(Date.parse(b))}catch(d){return null}};
SimileAjax.DateTime.roundDownToInterval=function(a,b,c,d,f){var c=c*SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.HOUR],e=new Date(a.getTime()+c),g=function(a){a.setUTCMilliseconds(0);a.setUTCSeconds(0);a.setUTCMinutes(0);a.setUTCHours(0)},h=function(a){g(a);a.setUTCDate(1);a.setUTCMonth(0)};switch(b){case SimileAjax.DateTime.MILLISECOND:b=e.getUTCMilliseconds();e.setUTCMilliseconds(b-b%d);break;case SimileAjax.DateTime.SECOND:e.setUTCMilliseconds(0);b=e.getUTCSeconds();e.setUTCSeconds(b-
b%d);break;case SimileAjax.DateTime.MINUTE:e.setUTCMilliseconds(0);e.setUTCSeconds(0);b=e.getUTCMinutes();e.setTime(e.getTime()-b%d*SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.MINUTE]);break;case SimileAjax.DateTime.HOUR:e.setUTCMilliseconds(0);e.setUTCSeconds(0);e.setUTCMinutes(0);b=e.getUTCHours();e.setUTCHours(b-b%d);break;case SimileAjax.DateTime.DAY:g(e);break;case SimileAjax.DateTime.WEEK:g(e);d=(e.getUTCDay()+7-f)%7;e.setTime(e.getTime()-d*SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.DAY]);
break;case SimileAjax.DateTime.MONTH:g(e);e.setUTCDate(1);b=e.getUTCMonth();e.setUTCMonth(b-b%d);break;case SimileAjax.DateTime.YEAR:h(e);b=e.getUTCFullYear();e.setUTCFullYear(b-b%d);break;case SimileAjax.DateTime.DECADE:h(e);e.setUTCFullYear(10*Math.floor(e.getUTCFullYear()/10));break;case SimileAjax.DateTime.CENTURY:h(e);e.setUTCFullYear(100*Math.floor(e.getUTCFullYear()/100));break;case SimileAjax.DateTime.MILLENNIUM:h(e),e.setUTCFullYear(1E3*Math.floor(e.getUTCFullYear()/1E3))}a.setTime(e.getTime()-
c)};SimileAjax.DateTime.roundUpToInterval=function(a,b,c,d,f){var e=a.getTime();SimileAjax.DateTime.roundDownToInterval(a,b,c,d,f);a.getTime()<e&&a.setTime(a.getTime()+SimileAjax.DateTime.gregorianUnitLengths[b]*d)};
SimileAjax.DateTime.incrementByInterval=function(a,b,c){var c=("undefined"==typeof c?0:c)*SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.HOUR],d=new Date(a.getTime()+c);switch(b){case SimileAjax.DateTime.MILLISECOND:d.setTime(d.getTime()+1);break;case SimileAjax.DateTime.SECOND:d.setTime(d.getTime()+1E3);break;case SimileAjax.DateTime.MINUTE:d.setTime(d.getTime()+SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.MINUTE]);break;case SimileAjax.DateTime.HOUR:d.setTime(d.getTime()+
SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.HOUR]);break;case SimileAjax.DateTime.DAY:d.setUTCDate(d.getUTCDate()+1);break;case SimileAjax.DateTime.WEEK:d.setUTCDate(d.getUTCDate()+7);break;case SimileAjax.DateTime.MONTH:d.setUTCMonth(d.getUTCMonth()+1);break;case SimileAjax.DateTime.YEAR:d.setUTCFullYear(d.getUTCFullYear()+1);break;case SimileAjax.DateTime.DECADE:d.setUTCFullYear(d.getUTCFullYear()+10);break;case SimileAjax.DateTime.CENTURY:d.setUTCFullYear(d.getUTCFullYear()+100);
break;case SimileAjax.DateTime.MILLENNIUM:d.setUTCFullYear(d.getUTCFullYear()+1E3)}a.setTime(d.getTime()-c)};SimileAjax.DateTime.removeTimeZoneOffset=function(a,b){return new Date(a.getTime()+b*SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.HOUR])};SimileAjax.DateTime.getTimezone=function(){return(new Date).getTimezoneOffset()/-60};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};
String.prototype.startsWith=function(a){return this.length>=a.length&&this.substr(0,a.length)==a};String.prototype.endsWith=function(a){return this.length>=a.length&&this.substr(this.length-a.length)==a};
String.substitute=function(a,b){for(var c="",d=0;d<a.length-1;){var f=a.indexOf("%",d);if(0>f||f==a.length-1)break;else if(f>d&&"\\"==a.charAt(f-1))c+=a.substring(d,f-1)+"%",d=f+1;else var e=parseInt(a.charAt(f+1)),c=isNaN(e)||e>=b.length?c+a.substring(d,f+2):c+(a.substring(d,f)+b[e].toString()),d=f+2}d<a.length&&(c+=a.substring(d));return c};SimileAjax.HTML={};SimileAjax.HTML._e2uHash={};
(function(){var a=SimileAjax.HTML._e2uHash;a.nbsp="\u00a0[space]";a.iexcl="\u00a1";a.cent="\u00a2";a.pound="\u00a3";a.curren="\u00a4";a.yen="\u00a5";a.brvbar="\u00a6";a.sect="\u00a7";a.uml="\u00a8";a.copy="\u00a9";a.ordf="\u00aa";a.laquo="\u00ab";a.not="\u00ac";a.shy="\u00ad";a.reg="\u00ae";a.macr="\u00af";a.deg="\u00b0";a.plusmn="\u00b1";a.sup2="\u00b2";a.sup3="\u00b3";a.acute="\u00b4";a.micro="\u00b5";a.para="\u00b6";a.middot="\u00b7";a.cedil="\u00b8";a.sup1="\u00b9";a.ordm="\u00ba";a.raquo="\u00bb";
a.frac14="\u00bc";a.frac12="\u00bd";a.frac34="\u00be";a.iquest="\u00bf";a.Agrave="\u00c0";a.Aacute="\u00c1";a.Acirc="\u00c2";a.Atilde="\u00c3";a.Auml="\u00c4";a.Aring="\u00c5";a.AElig="\u00c6";a.Ccedil="\u00c7";a.Egrave="\u00c8";a.Eacute="\u00c9";a.Ecirc="\u00ca";a.Euml="\u00cb";a.Igrave="\u00cc";a.Iacute="\u00cd";a.Icirc="\u00ce";a.Iuml="\u00cf";a.ETH="\u00d0";a.Ntilde="\u00d1";a.Ograve="\u00d2";a.Oacute="\u00d3";a.Ocirc="\u00d4";a.Otilde="\u00d5";a.Ouml="\u00d6";a.times="\u00d7";a.Oslash="\u00d8";
a.Ugrave="\u00d9";a.Uacute="\u00da";a.Ucirc="\u00db";a.Uuml="\u00dc";a.Yacute="\u00dd";a.THORN="\u00de";a.szlig="\u00df";a.agrave="\u00e0";a.aacute="\u00e1";a.acirc="\u00e2";a.atilde="\u00e3";a.auml="\u00e4";a.aring="\u00e5";a.aelig="\u00e6";a.ccedil="\u00e7";a.egrave="\u00e8";a.eacute="\u00e9";a.ecirc="\u00ea";a.euml="\u00eb";a.igrave="\u00ec";a.iacute="\u00ed";a.icirc="\u00ee";a.iuml="\u00ef";a.eth="\u00f0";a.ntilde="\u00f1";a.ograve="\u00f2";a.oacute="\u00f3";a.ocirc="\u00f4";a.otilde="\u00f5";
a.ouml="\u00f6";a.divide="\u00f7";a.oslash="\u00f8";a.ugrave="\u00f9";a.uacute="\u00fa";a.ucirc="\u00fb";a.uuml="\u00fc";a.yacute="\u00fd";a.thorn="\u00fe";a.yuml="\u00ff";a.quot='"';a.amp="&";a.lt="<";a.gt=">";a.OElig="";a.oelig="\u0153";a.Scaron="\u0160";a.scaron="\u0161";a.Yuml="\u0178";a.circ="\u02c6";a.tilde="\u02dc";a.ensp="\u2002";a.emsp="\u2003";a.thinsp="\u2009";a.zwnj="\u200c";a.zwj="\u200d";a.lrm="\u200e";a.rlm="\u200f";a.ndash="\u2013";a.mdash="\u2014";a.lsquo="\u2018";a.rsquo="\u2019";
a.sbquo="\u201a";a.ldquo="\u201c";a.rdquo="\u201d";a.bdquo="\u201e";a.dagger="\u2020";a.Dagger="\u2021";a.permil="\u2030";a.lsaquo="\u2039";a.rsaquo="\u203a";a.euro="\u20ac";a.fnof="\u0192";a.Alpha="\u0391";a.Beta="\u0392";a.Gamma="\u0393";a.Delta="\u0394";a.Epsilon="\u0395";a.Zeta="\u0396";a.Eta="\u0397";a.Theta="\u0398";a.Iota="\u0399";a.Kappa="\u039a";a.Lambda="\u039b";a.Mu="\u039c";a.Nu="\u039d";a.Xi="\u039e";a.Omicron="\u039f";a.Pi="\u03a0";a.Rho="\u03a1";a.Sigma="\u03a3";a.Tau="\u03a4";a.Upsilon=
"\u03a5";a.Phi="\u03a6";a.Chi="\u03a7";a.Psi="\u03a8";a.Omega="\u03a9";a.alpha="\u03b1";a.beta="\u03b2";a.gamma="\u03b3";a.delta="\u03b4";a.epsilon="\u03b5";a.zeta="\u03b6";a.eta="\u03b7";a.theta="\u03b8";a.iota="\u03b9";a.kappa="\u03ba";a.lambda="\u03bb";a.mu="\u03bc";a.nu="\u03bd";a.xi="\u03be";a.omicron="\u03bf";a.pi="\u03c0";a.rho="\u03c1";a.sigmaf="\u03c2";a.sigma="\u03c3";a.tau="\u03c4";a.upsilon="\u03c5";a.phi="\u03c6";a.chi="\u03c7";a.psi="\u03c8";a.omega="\u03c9";a.thetasym="\u03d1";a.upsih=
"\u03d2";a.piv="\u03d6";a.bull="\u2022";a.hellip="\u2026";a.prime="\u2032";a.Prime="\u2033";a.oline="\u203e";a.frasl="\u2044";a.weierp="\u2118";a.image="\u2111";a.real="\u211c";a.trade="\u2122";a.alefsym="\u2135";a.larr="\u2190";a.uarr="\u2191";a.rarr="\u2192";a.darr="\u2193";a.harr="\u2194";a.crarr="\u21b5";a.lArr="\u21d0";a.uArr="\u21d1";a.rArr="\u21d2";a.dArr="\u21d3";a.hArr="\u21d4";a.forall="\u2200";a.part="\u2202";a.exist="\u2203";a.empty="\u2205";a.nabla="\u2207";a.isin="\u2208";a.notin="\u2209";
a.ni="\u220b";a.prod="\u220f";a.sum="\u2211";a.minus="\u2212";a.lowast="\u2217";a.radic="\u221a";a.prop="\u221d";a.infin="\u221e";a.ang="\u2220";a.and="\u2227";a.or="\u2228";a.cap="\u2229";a.cup="\u222a";a["int"]="\u222b";a.there4="\u2234";a.sim="\u223c";a.cong="\u2245";a.asymp="\u2248";a.ne="\u2260";a.equiv="\u2261";a.le="\u2264";a.ge="\u2265";a.sub="\u2282";a.sup="\u2283";a.nsub="\u2284";a.sube="\u2286";a.supe="\u2287";a.oplus="\u2295";a.otimes="\u2297";a.perp="\u22a5";a.sdot="\u22c5";a.lceil="\u2308";
a.rceil="\u2309";a.lfloor="\u230a";a.rfloor="\u230b";a.lang="\u2329";a.rang="\u232a";a.loz="\u25ca";a.spades="\u2660";a.clubs="\u2663";a.hearts="\u2665";a.diams="\u2666"})();SimileAjax.HTML.deEntify=function(a){for(var b=SimileAjax.HTML._e2uHash,c=/&(\w+?);/;c.test(a);)var d=a.match(c),a=a.replace(c,b[d[1]]);return a};SimileAjax.Set=function(a){this._hash={};this._count=0;if(a instanceof Array)for(var b=0;b<a.length;b++)this.add(a[b]);else a instanceof SimileAjax.Set&&this.addSet(a)};
SimileAjax.Set.prototype.add=function(a){return!(a in this._hash)?(this._hash[a]=!0,this._count++,!0):!1};SimileAjax.Set.prototype.addSet=function(a){for(var b in a._hash)this.add(b)};SimileAjax.Set.prototype.remove=function(a){return a in this._hash?(delete this._hash[a],this._count--,!0):!1};SimileAjax.Set.prototype.removeSet=function(a){for(var b in a._hash)this.remove(b)};SimileAjax.Set.prototype.retainSet=function(a){for(var b in this._hash)a.contains(b)||(delete this._hash[b],this._count--)};
SimileAjax.Set.prototype.contains=function(a){return a in this._hash};SimileAjax.Set.prototype.size=function(){return this._count};SimileAjax.Set.prototype.toArray=function(){var a=[],b;for(b in this._hash)a.push(b);return a};SimileAjax.Set.prototype.visit=function(a){for(var b in this._hash)if(!0==a(b))break};SimileAjax.SortedArray=function(a,b){this._a=b instanceof Array?b:[];this._compare=a};
SimileAjax.SortedArray.prototype.add=function(a){var b=this,c=this.find(function(c){return b._compare(c,a)});c<this._a.length?this._a.splice(c,0,a):this._a.push(a)};SimileAjax.SortedArray.prototype.remove=function(a){for(var b=this,c=this.find(function(c){return b._compare(c,a)});c<this._a.length&&0==this._compare(this._a[c],a);){if(this._a[c]==a)return this._a.splice(c,1),!0;c++}return!1};SimileAjax.SortedArray.prototype.removeAll=function(){this._a=[]};
SimileAjax.SortedArray.prototype.elementAt=function(a){return this._a[a]};SimileAjax.SortedArray.prototype.length=function(){return this._a.length};SimileAjax.SortedArray.prototype.find=function(a){for(var b=0,c=this._a.length;b<c;){var d=Math.floor((b+c)/2),f=a(this._a[d]);if(d==b)return 0>f?b+1:b;0>f?b=d:c=d}return b};SimileAjax.SortedArray.prototype.getFirst=function(){return 0<this._a.length?this._a[0]:null};
SimileAjax.SortedArray.prototype.getLast=function(){return 0<this._a.length?this._a[this._a.length-1]:null};SimileAjax.EventIndex=function(a){var b=this;this._unit=null!=a?a:SimileAjax.NativeDateUnit;this._events=new SimileAjax.SortedArray(function(a,d){return b._unit.compare(a.getStart(),d.getStart())});this._idToEvent={};this._indexed=!0};SimileAjax.EventIndex.prototype.getUnit=function(){return this._unit};SimileAjax.EventIndex.prototype.getEvent=function(a){return this._idToEvent[a]};
SimileAjax.EventIndex.prototype.add=function(a){this._events.add(a);this._idToEvent[a.getID()]=a;this._indexed=!1};SimileAjax.EventIndex.prototype.removeAll=function(){this._events.removeAll();this._idToEvent={};this._indexed=!1};SimileAjax.EventIndex.prototype.getCount=function(){return this._events.length()};SimileAjax.EventIndex.prototype.getIterator=function(a,b){this._indexed||this._index();return new SimileAjax.EventIndex._Iterator(this._events,a,b,this._unit)};
SimileAjax.EventIndex.prototype.getReverseIterator=function(a,b){this._indexed||this._index();return new SimileAjax.EventIndex._ReverseIterator(this._events,a,b,this._unit)};SimileAjax.EventIndex.prototype.getAllIterator=function(){return new SimileAjax.EventIndex._AllIterator(this._events)};SimileAjax.EventIndex.prototype.getEarliestDate=function(){var a=this._events.getFirst();return null==a?null:a.getStart()};
SimileAjax.EventIndex.prototype.getLatestDate=function(){var a=this._events.getLast();if(null==a)return null;this._indexed||this._index();for(var b=a._earliestOverlapIndex,a=this._events.elementAt(b).getEnd(),b=b+1;b<this._events.length();b++)a=this._unit.later(a,this._events.elementAt(b).getEnd());return a};
SimileAjax.EventIndex.prototype._index=function(){for(var a=this._events.length(),b=0;b<a;b++){var c=this._events.elementAt(b);c._earliestOverlapIndex=b}for(var d=1,b=0;b<a;b++){c=this._events.elementAt(b);c=c.getEnd();for(d=Math.max(d,b+1);d<a;){var f=this._events.elementAt(d);if(0>this._unit.compare(f.getStart(),c))f._earliestOverlapIndex=b,d++;else break}}this._indexed=!0};
SimileAjax.EventIndex._Iterator=function(a,b,c,d){this._events=a;this._startDate=b;this._endDate=c;this._unit=d;this._currentIndex=a.find(function(a){return d.compare(a.getStart(),b)});if(0<=this._currentIndex-1)this._currentIndex=this._events.elementAt(this._currentIndex-1)._earliestOverlapIndex;this._currentIndex--;this._maxIndex=a.find(function(a){return d.compare(a.getStart(),c)});this._hasNext=!1;this._next=null;this._findNext()};
SimileAjax.EventIndex._Iterator.prototype={hasNext:function(){return this._hasNext},next:function(){if(this._hasNext){var a=this._next;this._findNext();return a}return null},_findNext:function(){for(var a=this._unit;++this._currentIndex<this._maxIndex;){var b=this._events.elementAt(this._currentIndex);if(0>a.compare(b.getStart(),this._endDate)&&0<a.compare(b.getEnd(),this._startDate)){this._next=b;this._hasNext=!0;return}}this._next=null;this._hasNext=!1}};
SimileAjax.EventIndex._ReverseIterator=function(a,b,c,d){this._events=a;this._startDate=b;this._endDate=c;this._unit=d;this._minIndex=a.find(function(a){return d.compare(a.getStart(),b)});if(0<=this._minIndex-1)this._minIndex=this._events.elementAt(this._minIndex-1)._earliestOverlapIndex;this._currentIndex=this._maxIndex=a.find(function(a){return d.compare(a.getStart(),c)});this._hasNext=!1;this._next=null;this._findNext()};
SimileAjax.EventIndex._ReverseIterator.prototype={hasNext:function(){return this._hasNext},next:function(){if(this._hasNext){var a=this._next;this._findNext();return a}return null},_findNext:function(){for(var a=this._unit;--this._currentIndex>=this._minIndex;){var b=this._events.elementAt(this._currentIndex);if(0>a.compare(b.getStart(),this._endDate)&&0<a.compare(b.getEnd(),this._startDate)){this._next=b;this._hasNext=!0;return}}this._next=null;this._hasNext=!1}};
SimileAjax.EventIndex._AllIterator=function(a){this._events=a;this._index=0};SimileAjax.EventIndex._AllIterator.prototype={hasNext:function(){return this._index<this._events.length()},next:function(){return this._index<this._events.length()?this._events.elementAt(this._index++):null}};SimileAjax.NativeDateUnit={};SimileAjax.NativeDateUnit.makeDefaultValue=function(){return new Date};SimileAjax.NativeDateUnit.cloneValue=function(a){return new Date(a.getTime())};
SimileAjax.NativeDateUnit.getParser=function(a){"string"==typeof a&&(a=a.toLowerCase());return"iso8601"==a||"iso 8601"==a?SimileAjax.DateTime.parseIso8601DateTime:SimileAjax.DateTime.parseGregorianDateTime};SimileAjax.NativeDateUnit.parseFromObject=function(a){return SimileAjax.DateTime.parseGregorianDateTime(a)};SimileAjax.NativeDateUnit.toNumber=function(a){return a.getTime()};SimileAjax.NativeDateUnit.fromNumber=function(a){return new Date(a)};
SimileAjax.NativeDateUnit.compare=function(a,b){var c,d;c="object"==typeof a?a.getTime():Number(a);d="object"==typeof b?b.getTime():Number(b);return c-d};SimileAjax.NativeDateUnit.earlier=function(a,b){return 0>SimileAjax.NativeDateUnit.compare(a,b)?a:b};SimileAjax.NativeDateUnit.later=function(a,b){return 0<SimileAjax.NativeDateUnit.compare(a,b)?a:b};SimileAjax.NativeDateUnit.change=function(a,b){return new Date(a.getTime()+b)};
SimileAjax.ListenerQueue=function(a){this._listeners=[];this._wildcardHandlerName=a};SimileAjax.ListenerQueue.prototype.add=function(a){this._listeners.push(a)};SimileAjax.ListenerQueue.prototype.remove=function(a){for(var b=this._listeners,c=0;c<b.length;c++)if(b[c]==a){b.splice(c,1);break}};
SimileAjax.ListenerQueue.prototype.fire=function(a,b){for(var c=[].concat(this._listeners),d=0;d<c.length;d++){var f=c[d];if(a in f)try{f[a].apply(f,b)}catch(e){SimileAjax.Debug.exception("Error firing event of name "+a,e)}else if(null!=this._wildcardHandlerName&&this._wildcardHandlerName in f)try{f[this._wildcardHandlerName].apply(f,[a])}catch(g){SimileAjax.Debug.exception("Error firing event of name "+a+" to wildcard handler",g)}}};
SimileAjax.History={maxHistoryLength:10,historyFile:"__history__.html",enabled:!0,_initialized:!1,_listeners:new SimileAjax.ListenerQueue,_actions:[],_baseIndex:0,_currentIndex:0,_plainDocumentTitle:document.title};SimileAjax.History.formatHistoryEntryTitle=function(a){return SimileAjax.History._plainDocumentTitle+" {"+a+"}"};
SimileAjax.History.initialize=function(){if(!SimileAjax.History._initialized){if(SimileAjax.History.enabled){var a=document.createElement("iframe");a.id="simile-ajax-history";a.style.position="absolute";a.style.width="10px";a.style.height="10px";a.style.top="0px";a.style.left="0px";a.style.visibility="hidden";a.src=SimileAjax.History.historyFile+"?0";document.body.appendChild(a);SimileAjax.DOM.registerEvent(a,"load",SimileAjax.History._handleIFrameOnLoad);SimileAjax.History._iframe=a}SimileAjax.History._initialized=
!0}};SimileAjax.History.addListener=function(a){SimileAjax.History.initialize();SimileAjax.History._listeners.add(a)};SimileAjax.History.removeListener=function(a){SimileAjax.History.initialize();SimileAjax.History._listeners.remove(a)};
SimileAjax.History.addAction=function(a){SimileAjax.History.initialize();SimileAjax.History._listeners.fire("onBeforePerform",[a]);window.setTimeout(function(){try{if(a.perform(),SimileAjax.History._listeners.fire("onAfterPerform",[a]),SimileAjax.History.enabled){SimileAjax.History._actions=SimileAjax.History._actions.slice(0,SimileAjax.History._currentIndex-SimileAjax.History._baseIndex);SimileAjax.History._actions.push(a);SimileAjax.History._currentIndex++;var b=SimileAjax.History._actions.length-
SimileAjax.History.maxHistoryLength;if(0<b)SimileAjax.History._actions=SimileAjax.History._actions.slice(b),SimileAjax.History._baseIndex+=b;try{SimileAjax.History._iframe.contentWindow.location.search="?"+SimileAjax.History._currentIndex}catch(c){var d=SimileAjax.History.formatHistoryEntryTitle(a.label);document.title=d}}}catch(f){SimileAjax.Debug.exception(f,"Error adding action {"+a.label+"} to history")}},0)};
SimileAjax.History.addLengthyAction=function(a,b,c){SimileAjax.History.addAction({perform:a,undo:b,label:c,uiLayer:SimileAjax.WindowManager.getBaseLayer(),lengthy:!0})};
SimileAjax.History._handleIFrameOnLoad=function(){try{var a=SimileAjax.History._iframe.contentWindow.location.search,b=0==a.length?0:Math.max(0,parseInt(a.substr(1))),c=function(){var a=b-SimileAjax.History._currentIndex;SimileAjax.History._currentIndex+=a;SimileAjax.History._baseIndex+=a;SimileAjax.History._iframe.contentWindow.location.search="?"+b};if(b<SimileAjax.History._currentIndex)SimileAjax.History._listeners.fire("onBeforeUndoSeveral",[]),window.setTimeout(function(){for(;SimileAjax.History._currentIndex>
b&&SimileAjax.History._currentIndex>SimileAjax.History._baseIndex;){SimileAjax.History._currentIndex--;var a=SimileAjax.History._actions[SimileAjax.History._currentIndex-SimileAjax.History._baseIndex];try{a.undo()}catch(d){SimileAjax.Debug.exception(d,"History: Failed to undo action {"+a.label+"}")}}SimileAjax.History._listeners.fire("onAfterUndoSeveral",[]);c()},0);else if(b>SimileAjax.History._currentIndex)SimileAjax.History._listeners.fire("onBeforeRedoSeveral",[]),window.setTimeout(function(){for(;SimileAjax.History._currentIndex<
b&&SimileAjax.History._currentIndex-SimileAjax.History._baseIndex<SimileAjax.History._actions.length;){var a=SimileAjax.History._actions[SimileAjax.History._currentIndex-SimileAjax.History._baseIndex];try{a.perform()}catch(d){SimileAjax.Debug.exception(d,"History: Failed to redo action {"+a.label+"}")}SimileAjax.History._currentIndex++}SimileAjax.History._listeners.fire("onAfterRedoSeveral",[]);c()},0);else{var d=SimileAjax.History._currentIndex-SimileAjax.History._baseIndex-1,f=0<=d&&d<SimileAjax.History._actions.length?
SimileAjax.History.formatHistoryEntryTitle(SimileAjax.History._actions[d].label):SimileAjax.History._plainDocumentTitle;SimileAjax.History._iframe.contentWindow.document.title=f;document.title=f}}catch(e){}};SimileAjax.History.getNextUndoAction=function(){try{return SimileAjax.History._actions[SimileAjax.History._currentIndex-SimileAjax.History._baseIndex-1]}catch(a){return null}};
SimileAjax.History.getNextRedoAction=function(){try{return SimileAjax.History._actions[SimileAjax.History._currentIndex-SimileAjax.History._baseIndex]}catch(a){return null}};SimileAjax.WindowManager={_initialized:!1,_listeners:[],_draggedElement:null,_draggedElementCallback:null,_dropTargetHighlightElement:null,_lastCoords:null,_ghostCoords:null,_draggingMode:"",_dragging:!1,_layers:[]};
SimileAjax.WindowManager.initialize=function(){if(!SimileAjax.WindowManager._initialized)SimileAjax.DOM.registerEvent(document.body,"mousedown",SimileAjax.WindowManager._onBodyMouseDown),SimileAjax.DOM.registerEvent(document.body,"mousemove",SimileAjax.WindowManager._onBodyMouseMove),SimileAjax.DOM.registerEvent(document.body,"mouseup",SimileAjax.WindowManager._onBodyMouseUp),SimileAjax.DOM.registerEvent(document,"keydown",SimileAjax.WindowManager._onBodyKeyDown),SimileAjax.DOM.registerEvent(document,
"keyup",SimileAjax.WindowManager._onBodyKeyUp),SimileAjax.WindowManager._layers.push({index:0}),SimileAjax.WindowManager._historyListener={onBeforeUndoSeveral:function(){},onAfterUndoSeveral:function(){},onBeforeUndo:function(){},onAfterUndo:function(){},onBeforeRedoSeveral:function(){},onAfterRedoSeveral:function(){},onBeforeRedo:function(){},onAfterRedo:function(){}},SimileAjax.History.addListener(SimileAjax.WindowManager._historyListener),SimileAjax.WindowManager._initialized=!0};
SimileAjax.WindowManager.getBaseLayer=function(){SimileAjax.WindowManager.initialize();return SimileAjax.WindowManager._layers[0]};SimileAjax.WindowManager.getHighestLayer=function(){SimileAjax.WindowManager.initialize();return SimileAjax.WindowManager._layers[SimileAjax.WindowManager._layers.length-1]};SimileAjax.WindowManager.registerEventWithObject=function(a,b,c,d,f){SimileAjax.WindowManager.registerEvent(a,b,function(a,b,f){return c[d].call(c,a,b,f)},f)};
SimileAjax.WindowManager.registerEvent=function(a,b,c,d){null==d&&(d=SimileAjax.WindowManager.getHighestLayer());SimileAjax.DOM.registerEvent(a,b,function(a,b,g){if(SimileAjax.WindowManager._canProcessEventAtLayer(d)){SimileAjax.WindowManager._popToLayer(d.index);try{c(a,b,g)}catch(h){SimileAjax.Debug.exception(h)}}SimileAjax.DOM.cancelEvent(b);return!1})};
SimileAjax.WindowManager.pushLayer=function(a,b,c){a={onPop:a,index:SimileAjax.WindowManager._layers.length,ephemeral:b,elmt:c};SimileAjax.WindowManager._layers.push(a);return a};SimileAjax.WindowManager.popLayer=function(a){for(var b=1;b<SimileAjax.WindowManager._layers.length;b++)if(SimileAjax.WindowManager._layers[b]==a){SimileAjax.WindowManager._popToLayer(b-1);break}};SimileAjax.WindowManager.popAllLayers=function(){SimileAjax.WindowManager._popToLayer(0)};
SimileAjax.WindowManager.registerForDragging=function(a,b,c){SimileAjax.WindowManager.registerEvent(a,"mousedown",function(a,c){SimileAjax.WindowManager._handleMouseDown(a,c,b)},c)};SimileAjax.WindowManager._popToLayer=function(a){for(;a+1<SimileAjax.WindowManager._layers.length;)try{var b=SimileAjax.WindowManager._layers.pop();if(null!=b.onPop)b.onPop()}catch(c){}};
SimileAjax.WindowManager._canProcessEventAtLayer=function(a){if(a.index==SimileAjax.WindowManager._layers.length-1)return!0;for(a=a.index+1;a<SimileAjax.WindowManager._layers.length;a++)if(!SimileAjax.WindowManager._layers[a].ephemeral)return!1;return!0};
SimileAjax.WindowManager.cancelPopups=function(a){for(var a=a?SimileAjax.DOM.getEventPageCoordinates(a):{x:-1,y:-1},b=SimileAjax.WindowManager._layers.length-1;0<b&&SimileAjax.WindowManager._layers[b].ephemeral;){var c=SimileAjax.WindowManager._layers[b];if(null!=c.elmt){var c=c.elmt,d=SimileAjax.DOM.getPageCoordinates(c);if(a.x>=d.left&&a.x<d.left+c.offsetWidth&&a.y>=d.top&&a.y<d.top+c.offsetHeight)break}b--}SimileAjax.WindowManager._popToLayer(b)};
SimileAjax.WindowManager._onBodyMouseDown=function(a,b){(!("eventPhase"in b)||b.eventPhase==b.BUBBLING_PHASE)&&SimileAjax.WindowManager.cancelPopups(b)};SimileAjax.WindowManager._handleMouseDown=function(a,b,c){SimileAjax.WindowManager._draggedElement=a;SimileAjax.WindowManager._draggedElementCallback=c;SimileAjax.WindowManager._lastCoords={x:b.clientX,y:b.clientY};SimileAjax.DOM.cancelEvent(b);return!1};
SimileAjax.WindowManager._onBodyKeyDown=function(a,b){if(SimileAjax.WindowManager._dragging)if(27==b.keyCode)SimileAjax.WindowManager._cancelDragging();else if((17==b.keyCode||16==b.keyCode)&&"copy"!=SimileAjax.WindowManager._draggingMode){SimileAjax.WindowManager._draggingMode="copy";var c=SimileAjax.Graphics.createTranslucentImage(SimileAjax.urlPrefix+"images/copy.png");c.style.position="absolute";c.style.left=SimileAjax.WindowManager._ghostCoords.left-16+"px";c.style.top=SimileAjax.WindowManager._ghostCoords.top+
"px";document.body.appendChild(c);SimileAjax.WindowManager._draggingModeIndicatorElmt=c}};SimileAjax.WindowManager._onBodyKeyUp=function(a,b){if(SimileAjax.WindowManager._dragging&&(17==b.keyCode||16==b.keyCode))if(SimileAjax.WindowManager._draggingMode="",null!=SimileAjax.WindowManager._draggingModeIndicatorElmt)document.body.removeChild(SimileAjax.WindowManager._draggingModeIndicatorElmt),SimileAjax.WindowManager._draggingModeIndicatorElmt=null};
SimileAjax.WindowManager._onBodyMouseMove=function(a,b,c){if(null!=SimileAjax.WindowManager._draggedElement){var a=SimileAjax.WindowManager._draggedElementCallback,d=SimileAjax.WindowManager._lastCoords,f=b.clientX-d.x,d=b.clientY-d.y;if(SimileAjax.WindowManager._dragging)try{SimileAjax.WindowManager._lastCoords={x:b.clientX,y:b.clientY};if("onDragBy"in a)a.onDragBy(f,d);if("_ghostElmt"in a){k=a._ghostElmt;SimileAjax.WindowManager._ghostCoords.left+=f;SimileAjax.WindowManager._ghostCoords.top+=d;
k.style.left=SimileAjax.WindowManager._ghostCoords.left+"px";k.style.top=SimileAjax.WindowManager._ghostCoords.top+"px";if(null!=SimileAjax.WindowManager._draggingModeIndicatorElmt){var e=SimileAjax.WindowManager._draggingModeIndicatorElmt;e.style.left=SimileAjax.WindowManager._ghostCoords.left-16+"px";e.style.top=SimileAjax.WindowManager._ghostCoords.top+"px"}if("droppable"in a&&a.droppable){var g=SimileAjax.DOM.getEventPageCoordinates(b),c=SimileAjax.DOM.hittest(g.x,g.y,[SimileAjax.WindowManager._ghostElmt,
SimileAjax.WindowManager._dropTargetHighlightElement]),c=SimileAjax.WindowManager._findDropTarget(c);if(c!=SimileAjax.WindowManager._potentialDropTarget){if(null!=SimileAjax.WindowManager._dropTargetHighlightElement)document.body.removeChild(SimileAjax.WindowManager._dropTargetHighlightElement),SimileAjax.WindowManager._dropTargetHighlightElement=null,SimileAjax.WindowManager._potentialDropTarget=null;e=!1;if(null!=c&&(!("canDropOn"in a)||a.canDropOn(c))&&(!("canDrop"in c)||c.canDrop(SimileAjax.WindowManager._draggedElement)))e=
!0;if(e){var h=SimileAjax.DOM.getPageCoordinates(c),i=document.createElement("div");i.style.border="4px solid yellow";i.style.backgroundColor="yellow";i.style.position="absolute";i.style.left=h.left+"px";i.style.top=h.top+"px";i.style.width=c.offsetWidth-8+"px";i.style.height=c.offsetHeight-8+"px";SimileAjax.Graphics.setOpacity(i,30);document.body.appendChild(i);SimileAjax.WindowManager._potentialDropTarget=c;SimileAjax.WindowManager._dropTargetHighlightElement=i}}}}}catch(j){SimileAjax.Debug.exception("WindowManager: Error handling mouse move",
j),SimileAjax.WindowManager._cancelDragging()}else if(5<Math.abs(f)||5<Math.abs(d))try{if("onDragStart"in a)a.onDragStart();if("ghost"in a&&a.ghost){var l=SimileAjax.WindowManager._draggedElement;SimileAjax.WindowManager._ghostCoords=SimileAjax.DOM.getPageCoordinates(l);SimileAjax.WindowManager._ghostCoords.left+=f;SimileAjax.WindowManager._ghostCoords.top+=d;var k=l.cloneNode(!0);k.style.position="absolute";k.style.left=SimileAjax.WindowManager._ghostCoords.left+"px";k.style.top=SimileAjax.WindowManager._ghostCoords.top+
"px";k.style.zIndex=1E3;SimileAjax.Graphics.setOpacity(k,50);document.body.appendChild(k);a._ghostElmt=k}SimileAjax.WindowManager._dragging=!0;SimileAjax.WindowManager._lastCoords={x:b.clientX,y:b.clientY};document.body.focus()}catch(m){SimileAjax.Debug.exception("WindowManager: Error handling mouse down",m),SimileAjax.WindowManager._cancelDragging()}SimileAjax.DOM.cancelEvent(b);return!1}};
SimileAjax.WindowManager._onBodyMouseUp=function(a,b,c){if(null!=SimileAjax.WindowManager._draggedElement){try{if(SimileAjax.WindowManager._dragging){var d=SimileAjax.WindowManager._draggedElementCallback;if("onDragEnd"in d)d.onDragEnd();if("droppable"in d&&d.droppable&&(c=SimileAjax.WindowManager._potentialDropTarget,null!=c&&(!("canDropOn"in d)||d.canDropOn(c))&&(!("canDrop"in c)||c.canDrop(SimileAjax.WindowManager._draggedElement)))){if("onDropOn"in d)d.onDropOn(c);c.ondrop(SimileAjax.WindowManager._draggedElement,
SimileAjax.WindowManager._draggingMode)}}}finally{SimileAjax.WindowManager._cancelDragging()}SimileAjax.DOM.cancelEvent(b);return!1}};
SimileAjax.WindowManager._cancelDragging=function(){var a=SimileAjax.WindowManager._draggedElementCallback;"_ghostElmt"in a&&(document.body.removeChild(a._ghostElmt),delete a._ghostElmt);if(null!=SimileAjax.WindowManager._dropTargetHighlightElement)document.body.removeChild(SimileAjax.WindowManager._dropTargetHighlightElement),SimileAjax.WindowManager._dropTargetHighlightElement=null;if(null!=SimileAjax.WindowManager._draggingModeIndicatorElmt)document.body.removeChild(SimileAjax.WindowManager._draggingModeIndicatorElmt),
SimileAjax.WindowManager._draggingModeIndicatorElmt=null;SimileAjax.WindowManager._draggedElement=null;SimileAjax.WindowManager._draggedElementCallback=null;SimileAjax.WindowManager._potentialDropTarget=null;SimileAjax.WindowManager._dropTargetHighlightElement=null;SimileAjax.WindowManager._lastCoords=null;SimileAjax.WindowManager._ghostCoords=null;SimileAjax.WindowManager._draggingMode="";SimileAjax.WindowManager._dragging=!1};
SimileAjax.WindowManager._findDropTarget=function(a){for(;null!=a&&!("ondrop"in a&&"function"==typeof a.ondrop);)a=a.parentNode;return a};Timeline.version="2.3.0";Timeline.ajax_lib_version=SimileAjax.version;Timeline.display_version=Timeline.version+" (with Ajax lib "+Timeline.ajax_lib_version+")";Timeline.strings={};Timeline.HORIZONTAL=0;Timeline.VERTICAL=1;Timeline._defaultTheme=null;Timeline.getDefaultLocale=function(){return Timeline.clientLocale};
Timeline.create=function(a,b,c,d){if(null==Timeline.timelines)Timeline.timelines=[];var f=Timeline.timelines.length;Timeline.timelines[f]=null;a=new Timeline._Impl(a,b,c,d,f);return Timeline.timelines[f]=a};
Timeline.createBandInfo=function(a){var b="theme"in a?a.theme:Timeline.getDefaultTheme(),c="eventSource"in a?a.eventSource:null,d=new Timeline.LinearEther({centersOn:"date"in a?a.date:new Date,interval:SimileAjax.DateTime.gregorianUnitLengths[a.intervalUnit],pixelsPerInterval:a.intervalPixels,theme:b}),f=new Timeline.GregorianEtherPainter({unit:a.intervalUnit,multiple:"multiple"in a?a.multiple:1,theme:b,align:"align"in a?a.align:void 0}),e={showText:"showEventText"in a?a.showEventText:!0,theme:b};
if("eventPainterParams"in a)for(var g in a.eventPainterParams)e[g]=a.eventPainterParams[g];if("trackHeight"in a)e.trackHeight=a.trackHeight;if("trackGap"in a)e.trackGap=a.trackGap;g="overview"in a&&a.overview?"overview":"layout"in a?a.layout:"original";if("eventPainter"in a)e=new a.eventPainter(e);else switch(g){case "overview":e=new Timeline.OverviewEventPainter(e);break;case "detailed":e=new Timeline.DetailedEventPainter(e);break;default:e=new Timeline.OriginalEventPainter(e)}return{width:a.width,
eventSource:c,timeZone:"timeZone"in a?a.timeZone:0,ether:d,etherPainter:f,eventPainter:e,theme:b,zoomIndex:"zoomIndex"in a?a.zoomIndex:0,zoomSteps:"zoomSteps"in a?a.zoomSteps:null}};
Timeline.createHotZoneBandInfo=function(a){var b="theme"in a?a.theme:Timeline.getDefaultTheme(),c="eventSource"in a?a.eventSource:null,d=new Timeline.HotZoneEther({centersOn:"date"in a?a.date:new Date,interval:SimileAjax.DateTime.gregorianUnitLengths[a.intervalUnit],pixelsPerInterval:a.intervalPixels,zones:a.zones,theme:b}),f=new Timeline.HotZoneGregorianEtherPainter({unit:a.intervalUnit,zones:a.zones,theme:b,align:"align"in a?a.align:void 0}),e={showText:"showEventText"in a?a.showEventText:!0,theme:b};
if("eventPainterParams"in a)for(var g in a.eventPainterParams)e[g]=a.eventPainterParams[g];if("trackHeight"in a)e.trackHeight=a.trackHeight;if("trackGap"in a)e.trackGap=a.trackGap;g="overview"in a&&a.overview?"overview":"layout"in a?a.layout:"original";if("eventPainter"in a)e=new a.eventPainter(e);else switch(g){case "overview":e=new Timeline.OverviewEventPainter(e);break;case "detailed":e=new Timeline.DetailedEventPainter(e);break;default:e=new Timeline.OriginalEventPainter(e)}return{width:a.width,
eventSource:c,timeZone:"timeZone"in a?a.timeZone:0,ether:d,etherPainter:f,eventPainter:e,theme:b,zoomIndex:"zoomIndex"in a?a.zoomIndex:0,zoomSteps:"zoomSteps"in a?a.zoomSteps:null}};Timeline.getDefaultTheme=function(){if(null==Timeline._defaultTheme)Timeline._defaultTheme=Timeline.ClassicTheme.create(Timeline.getDefaultLocale());return Timeline._defaultTheme};Timeline.setDefaultTheme=function(a){Timeline._defaultTheme=a};
Timeline.loadXML=function(a,b){SimileAjax.XmlHttp.get(a,function(b){alert("Failed to load data xml from "+a+"\n"+b)},function(c){var d=c.responseXML;!d.documentElement&&c.responseStream&&d.load(c.responseStream);b(d,a)})};Timeline.loadJSON=function(a,b){SimileAjax.XmlHttp.get(a,function(b){alert("Failed to load json data from "+a+"\n"+b)},function(c){b(eval("("+c.responseText+")"),a)})};Timeline.getTimelineFromID=function(a){return Timeline.timelines[a]};
Timeline.writeVersion=function(a){document.getElementById(a).innerHTML=this.display_version};
Timeline._Impl=function(a,b,c,d,f){SimileAjax.WindowManager.initialize();this._containerDiv=a;this._bandInfos=b;this._orientation=null==c?Timeline.HORIZONTAL:c;this._unit=null!=d?d:SimileAjax.NativeDateUnit;this._starting=!0;this._autoResizing=!1;this.autoWidth=b&&b[0]&&b[0].theme&&b[0].theme.autoWidth;this.autoWidthAnimationTime=b&&b[0]&&b[0].theme&&b[0].theme.autoWidthAnimationTime;this.timelineID=f;this.timeline_start=b&&b[0]&&b[0].theme&&b[0].theme.timeline_start;this.timeline_stop=b&&b[0]&&b[0].theme&&
b[0].theme.timeline_stop;this.timeline_at_stop=this.timeline_at_start=!1;this._initialize()};Timeline._Impl.prototype.dispose=function(){for(var a=0;a<this._bands.length;a++)this._bands[a].dispose();this._bandInfos=this._bands=null;this._containerDiv.innerHTML="";Timeline.timelines[this.timelineID]=null};Timeline._Impl.prototype.getBandCount=function(){return this._bands.length};Timeline._Impl.prototype.getBand=function(a){return this._bands[a]};
Timeline._Impl.prototype.finishedEventLoading=function(){this._autoWidthCheck(!0);this._starting=!1};Timeline._Impl.prototype.layout=function(){this._autoWidthCheck(!0);this._distributeWidths()};Timeline._Impl.prototype.paint=function(){for(var a=0;a<this._bands.length;a++)this._bands[a].paint()};Timeline._Impl.prototype.getDocument=function(){return this._containerDiv.ownerDocument};Timeline._Impl.prototype.addDiv=function(a){this._containerDiv.appendChild(a)};
Timeline._Impl.prototype.removeDiv=function(a){this._containerDiv.removeChild(a)};Timeline._Impl.prototype.isHorizontal=function(){return this._orientation==Timeline.HORIZONTAL};Timeline._Impl.prototype.isVertical=function(){return this._orientation==Timeline.VERTICAL};Timeline._Impl.prototype.getPixelLength=function(){return this._orientation==Timeline.HORIZONTAL?this._containerDiv.offsetWidth:this._containerDiv.offsetHeight};
Timeline._Impl.prototype.getPixelWidth=function(){return this._orientation==Timeline.VERTICAL?this._containerDiv.offsetWidth:this._containerDiv.offsetHeight};Timeline._Impl.prototype.getUnit=function(){return this._unit};Timeline._Impl.prototype.getWidthStyle=function(){return this._orientation==Timeline.HORIZONTAL?"height":"width"};
Timeline._Impl.prototype.loadXML=function(a,b){var c=this,d=function(b){alert("Failed to load data xml from "+a+"\n"+b);c.hideLoadingMessage()},f=function(d){try{var f=d.responseXML;!f.documentElement&&d.responseStream&&f.load(d.responseStream);b(f,a)}finally{c.hideLoadingMessage()}};this.showLoadingMessage();window.setTimeout(function(){SimileAjax.XmlHttp.get(a,d,f)},0)};
Timeline._Impl.prototype.loadJSON=function(a,b){var c=this,d=function(b){alert("Failed to load json data from "+a+"\n"+b);c.hideLoadingMessage()},f=function(d){try{b(eval("("+d.responseText+")"),a)}finally{c.hideLoadingMessage()}};this.showLoadingMessage();window.setTimeout(function(){SimileAjax.XmlHttp.get(a,d,f)},0)};Timeline._Impl.prototype._autoWidthScrollListener=function(a){a.getTimeline()._autoWidthCheck(!1)};
Timeline._Impl.prototype._autoWidthCheck=function(a){function b(){var a=c.getWidthStyle();if(d)c._containerDiv.style[a]=f+"px";else{c._autoResizing=!0;var b={};b[a]=f+"px";SimileAjax.jQuery(c._containerDiv).animate(b,c.autoWidthAnimationTime,"linear",function(){c._autoResizing=!1})}}var c=this,d=c._starting,f=0;c.autoWidth&&function(){var d=0,g=c.getPixelWidth();if(!c._autoResizing){for(var h=0;h<c._bands.length;h++)c._bands[h].checkAutoWidth(),d+=c._bandInfos[h].width;if(d>g||a)f=d,b(),c._distributeWidths()}}()};
Timeline._Impl.prototype._initialize=function(){var a=this._containerDiv,b=a.ownerDocument;a.className=a.className.split(" ").concat("timeline-container").join(" ");var c=this.isHorizontal()?"horizontal":"vertical";for(a.className+=" timeline-"+c;a.firstChild;)a.removeChild(a.firstChild);c=SimileAjax.Graphics.createTranslucentImage(Timeline.urlPrefix+(this.isHorizontal()?"images/copyright-vertical.png":"images/copyright.png"));c.className="timeline-copyright";c.title="Timeline copyright SIMILE - www.code.google.com/p/simile-widgets/";
SimileAjax.DOM.registerEvent(c,"click",function(){window.location="http://code.google.com/p/simile-widgets/"});a.appendChild(c);this._bands=[];for(c=0;c<this._bandInfos.length;c++)this._bands.push(new Timeline._Band(this,this._bandInfos[c],c));this._distributeWidths();for(c=0;c<this._bandInfos.length;c++){var d=this._bandInfos[c];"syncWith"in d&&this._bands[c].setSyncWithBand(this._bands[d.syncWith],"highlight"in d?d.highlight:!1)}if(this.autoWidth)for(c=0;c<this._bands.length;c++)this._bands[c].addOnScrollListener(this._autoWidthScrollListener);
var f=SimileAjax.Graphics.createMessageBubble(b);f.containerDiv.className="timeline-message-container";a.appendChild(f.containerDiv);f.contentDiv.className="timeline-message";f.contentDiv.innerHTML="<img src='"+Timeline.urlPrefix+"images/progress-running.gif' /> Loading...";this.showLoadingMessage=function(){f.containerDiv.style.display="block"};this.hideLoadingMessage=function(){f.containerDiv.style.display="none"}};
Timeline._Impl.prototype._distributeWidths=function(){for(var a=this.getPixelLength(),b=this.getPixelWidth(),c=0,d=0;d<this._bands.length;d++){var f=this._bands[d],e=this._bandInfos[d].width;if("string"==typeof e){var g=e.indexOf("%");0<g?(e=parseInt(e.substr(0,g)),e=Math.round(e*b/100)):e=parseInt(e)}f.setBandShiftAndWidth(c,e);f.setViewLength(a);c+=e}};
Timeline._Impl.prototype.shiftOK=function(a,b){var c=0<b,d=0>b;if(c&&null==this.timeline_start||d&&null==this.timeline_stop||0==b)return!0;for(var f=!1,e=0;e<this._bands.length&&!f;e++)f=this._bands[e].busy();if(f)return!0;if(c&&this.timeline_at_start||d&&this.timeline_at_stop)return!1;d=!1;for(e=0;e<this._bands.length&&!d;e++)d=this._bands[e],d=c?(e==a?d.getMinVisibleDateAfterDelta(b):d.getMinVisibleDate())>=this.timeline_start:(e==a?d.getMaxVisibleDateAfterDelta(b):d.getMaxVisibleDate())<=this.timeline_stop;
c?(this.timeline_at_start=!d,this.timeline_at_stop=!1):(this.timeline_at_stop=!d,this.timeline_at_start=!1);return d};Timeline._Impl.prototype.zoom=function(a,b,c,d){var f=null,e=/^timeline-band-([0-9]+)$/.exec(d.id);e&&(f=parseInt(e[1]));null!=f&&this._bands[f].zoom(a,b,c,d);this.paint()};
Timeline._Band=function(a,b,c){if(a.autoWidth&&"string"==typeof b.width)b.width=-1<b.width.indexOf("%")?0:parseInt(b.width);this._timeline=a;this._bandInfo=b;this._index=c;this._locale="locale"in b?b.locale:Timeline.getDefaultLocale();this._timeZone="timeZone"in b?b.timeZone:0;this._labeller="labeller"in b?b.labeller:"createLabeller"in a.getUnit()?a.getUnit().createLabeller(this._locale,this._timeZone):new Timeline.GregorianDateLabeller(this._locale,this._timeZone);this._theme=b.theme;this._zoomIndex=
"zoomIndex"in b?b.zoomIndex:0;this._zoomSteps="zoomSteps"in b?b.zoomSteps:null;this._changing=this._dragging=!1;this._scrollSpeed=this._originalScrollSpeed=5;this._onScrollListeners=[];var d=this;this._syncWithBand=null;this._syncWithBandHandler=function(){d._onHighlightBandScroll()};this._selectorListener=function(){d._onHighlightBandScroll()};var f=this._timeline.getDocument().createElement("div");f.className="timeline-band-input";this._timeline.addDiv(f);this._keyboardInput=document.createElement("input");
this._keyboardInput.type="text";f.appendChild(this._keyboardInput);SimileAjax.DOM.registerEventWithObject(this._keyboardInput,"keydown",this,"_onKeyDown");SimileAjax.DOM.registerEventWithObject(this._keyboardInput,"keyup",this,"_onKeyUp");this._div=this._timeline.getDocument().createElement("div");this._div.id="timeline-band-"+c;this._div.className="timeline-band timeline-band-"+c;this._timeline.addDiv(this._div);SimileAjax.DOM.registerEventWithObject(this._div,"mousedown",this,"_onMouseDown");SimileAjax.DOM.registerEventWithObject(this._div,
"mousemove",this,"_onMouseMove");SimileAjax.DOM.registerEventWithObject(this._div,"mouseup",this,"_onMouseUp");SimileAjax.DOM.registerEventWithObject(this._div,"mouseout",this,"_onMouseOut");SimileAjax.DOM.registerEventWithObject(this._div,"dblclick",this,"_onDblClick");c=null!=this._theme?this._theme.mouseWheel:"scroll";if("zoom"===c||"scroll"===c||this._zoomSteps)SimileAjax.Platform.browser.isFirefox?SimileAjax.DOM.registerEventWithObject(this._div,"DOMMouseScroll",this,"_onMouseScroll"):SimileAjax.DOM.registerEventWithObject(this._div,
"mousewheel",this,"_onMouseScroll");this._innerDiv=this._timeline.getDocument().createElement("div");this._innerDiv.className="timeline-band-inner";this._div.appendChild(this._innerDiv);this._ether=b.ether;b.ether.initialize(this,a);this._etherPainter=b.etherPainter;b.etherPainter.initialize(this,a);if(this._eventSource=b.eventSource)this._eventListener={onAddMany:function(){d._onAddMany()},onClear:function(){d._onClear()}},this._eventSource.addListener(this._eventListener);this._eventPainter=b.eventPainter;
this._eventTrackIncrement=this._eventTracksNeeded=0;b.eventPainter.initialize(this,a);this._decorators="decorators"in b?b.decorators:[];for(b=0;b<this._decorators.length;b++)this._decorators[b].initialize(this,a)};Timeline._Band.SCROLL_MULTIPLES=5;
Timeline._Band.prototype.dispose=function(){this.closeBubble();if(this._eventSource)this._eventSource.removeListener(this._eventListener),this._eventSource=this._eventListener=null;this._keyboardInput=this._innerDiv=this._div=this._selectorListener=this._syncWithBandHandler=this._onScrollListeners=this._decorators=this._eventPainter=this._etherPainter=this._ether=this._labeller=this._bandInfo=this._timeline=null};Timeline._Band.prototype.addOnScrollListener=function(a){this._onScrollListeners.push(a)};
Timeline._Band.prototype.removeOnScrollListener=function(a){for(var b=0;b<this._onScrollListeners.length;b++)if(this._onScrollListeners[b]==a){this._onScrollListeners.splice(b,1);break}};Timeline._Band.prototype.setSyncWithBand=function(a,b){this._syncWithBand&&this._syncWithBand.removeOnScrollListener(this._syncWithBandHandler);this._syncWithBand=a;this._syncWithBand.addOnScrollListener(this._syncWithBandHandler);this._highlight=b;this._positionHighlight()};Timeline._Band.prototype.getLocale=function(){return this._locale};
Timeline._Band.prototype.getTimeZone=function(){return this._timeZone};Timeline._Band.prototype.getLabeller=function(){return this._labeller};Timeline._Band.prototype.getIndex=function(){return this._index};Timeline._Band.prototype.getEther=function(){return this._ether};Timeline._Band.prototype.getEtherPainter=function(){return this._etherPainter};Timeline._Band.prototype.getEventSource=function(){return this._eventSource};Timeline._Band.prototype.getEventPainter=function(){return this._eventPainter};
Timeline._Band.prototype.getTimeline=function(){return this._timeline};Timeline._Band.prototype.updateEventTrackInfo=function(a,b){this._eventTrackIncrement=b;if(a>this._eventTracksNeeded)this._eventTracksNeeded=a};
Timeline._Band.prototype.checkAutoWidth=function(){if(this._timeline.autoWidth){var a="overview"==this._eventPainter.getType(),b=Math.ceil((this._eventTracksNeeded+(a?this._theme.event.overviewTrack.autoWidthMargin:this._theme.event.track.autoWidthMargin))*this._eventTrackIncrement),b=b+(a?this._theme.event.overviewTrack.offset:this._theme.event.track.offset),a=this._bandInfo;if(b!=a.width)a.width=b}};Timeline._Band.prototype.layout=function(){this.paint()};
Timeline._Band.prototype.paint=function(){this._etherPainter.paint();this._paintDecorators();this._paintEvents()};Timeline._Band.prototype.softLayout=function(){this.softPaint()};Timeline._Band.prototype.softPaint=function(){this._etherPainter.softPaint();this._softPaintDecorators();this._softPaintEvents()};
Timeline._Band.prototype.setBandShiftAndWidth=function(a,b){var c=this._keyboardInput.parentNode,d=a+Math.floor(b/2);this._timeline.isHorizontal()?(this._div.style.top=a+"px",this._div.style.height=b+"px",c.style.top=d+"px",c.style.left="-1em"):(this._div.style.left=a+"px",this._div.style.width=b+"px",c.style.left=d+"px",c.style.top="-1em")};Timeline._Band.prototype.getViewWidth=function(){return this._timeline.isHorizontal()?this._div.offsetHeight:this._div.offsetWidth};
Timeline._Band.prototype.setViewLength=function(a){this._viewLength=a;this._recenterDiv();this._onChanging()};Timeline._Band.prototype.getViewLength=function(){return this._viewLength};Timeline._Band.prototype.getTotalViewLength=function(){return Timeline._Band.SCROLL_MULTIPLES*this._viewLength};Timeline._Band.prototype.getViewOffset=function(){return this._viewOffset};Timeline._Band.prototype.getMinDate=function(){return this._ether.pixelOffsetToDate(this._viewOffset)};
Timeline._Band.prototype.getMaxDate=function(){return this._ether.pixelOffsetToDate(this._viewOffset+Timeline._Band.SCROLL_MULTIPLES*this._viewLength)};Timeline._Band.prototype.getMinVisibleDate=function(){return this._ether.pixelOffsetToDate(0)};Timeline._Band.prototype.getMinVisibleDateAfterDelta=function(a){return this._ether.pixelOffsetToDate(a)};Timeline._Band.prototype.getMaxVisibleDate=function(){return this._ether.pixelOffsetToDate(this._viewLength)};
Timeline._Band.prototype.getMaxVisibleDateAfterDelta=function(a){return this._ether.pixelOffsetToDate(this._viewLength+a)};Timeline._Band.prototype.getCenterVisibleDate=function(){return this._ether.pixelOffsetToDate(this._viewLength/2)};Timeline._Band.prototype.setMinVisibleDate=function(a){this._changing||this._moveEther(Math.round(-this._ether.dateToPixelOffset(a)))};Timeline._Band.prototype.setMaxVisibleDate=function(a){this._changing||this._moveEther(Math.round(this._viewLength-this._ether.dateToPixelOffset(a)))};
Timeline._Band.prototype.setCenterVisibleDate=function(a){this._changing||this._moveEther(Math.round(this._viewLength/2-this._ether.dateToPixelOffset(a)))};Timeline._Band.prototype.dateToPixelOffset=function(a){return this._ether.dateToPixelOffset(a)-this._viewOffset};Timeline._Band.prototype.pixelOffsetToDate=function(a){return this._ether.pixelOffsetToDate(a+this._viewOffset)};
Timeline._Band.prototype.createLayerDiv=function(a,b){var c=this._timeline.getDocument().createElement("div");c.className="timeline-band-layer"+("string"==typeof b?" "+b:"");c.style.zIndex=a;this._innerDiv.appendChild(c);var d=this._timeline.getDocument().createElement("div");d.className="timeline-band-layer-inner";d.style.cursor=SimileAjax.Platform.browser.isIE?"move":"-moz-grab";c.appendChild(d);return d};Timeline._Band.prototype.removeLayerDiv=function(a){this._innerDiv.removeChild(a.parentNode)};
Timeline._Band.prototype.scrollToCenter=function(a,b){var c=this._ether.dateToPixelOffset(a);c<-this._viewLength/2?this.setCenterVisibleDate(this.pixelOffsetToDate(c+this._viewLength)):c>3*this._viewLength/2&&this.setCenterVisibleDate(this.pixelOffsetToDate(c-this._viewLength));this._autoScroll(Math.round(this._viewLength/2-this._ether.dateToPixelOffset(a)),b)};
Timeline._Band.prototype.showBubbleForEvent=function(a){var b=this.getEventSource().getEvent(a);if(b){var c=this;this.scrollToCenter(b.getStart(),function(){c._eventPainter.showBubble(b)})}};Timeline._Band.prototype.zoom=function(a,b){if(this._zoomSteps){var b=b+this._viewOffset,c=this._ether.pixelOffsetToDate(b);this._etherPainter.zoom(this._ether.zoom(a));this._moveEther(Math.round(-this._ether.dateToPixelOffset(c)));this._moveEther(b)}};
Timeline._Band.prototype._onMouseDown=function(a,b){this.closeBubble();this._dragging=!0;this._dragX=b.clientX;this._dragY=b.clientY};Timeline._Band.prototype._onMouseMove=function(a,b){if(this._dragging){var c=b.clientX-this._dragX,d=b.clientY-this._dragY;this._dragX=b.clientX;this._dragY=b.clientY;this._moveEther(this._timeline.isHorizontal()?c:d);this._positionHighlight()}};Timeline._Band.prototype._onMouseUp=function(){this._dragging=!1;this._keyboardInput.focus()};
Timeline._Band.prototype._onMouseOut=function(a,b){var c=SimileAjax.DOM.getEventRelativeCoordinates(b,a);c.x+=this._viewOffset;if(0>c.x||c.x>a.offsetWidth||0>c.y||c.y>a.offsetHeight)this._dragging=!1};
Timeline._Band.prototype._onMouseScroll=function(a,b){var c=new Date,c=c.getTime();if(!this._lastScrollTime||50<c-this._lastScrollTime){this._lastScrollTime=c;c=0;b.wheelDelta?c=b.wheelDelta/120:b.detail&&(c=-b.detail/3);var d=this._theme.mouseWheel;if(this._zoomSteps||"zoom"===d){if(d=SimileAjax.DOM.getEventRelativeCoordinates(b,a),0!=c){var f;0<c&&(f=!0);0>c&&(f=!1);this._timeline.zoom(f,d.x,d.y,a)}}else"scroll"===d&&this._moveEther(50*(0>c?-1:1))}b.stopPropagation&&b.stopPropagation();b.cancelBubble=
!0;b.preventDefault&&b.preventDefault();b.returnValue=!1};Timeline._Band.prototype._onDblClick=function(a,b){this._autoScroll(-(SimileAjax.DOM.getEventRelativeCoordinates(b,a).x-(this._viewLength/2-this._viewOffset)))};
Timeline._Band.prototype._onKeyDown=function(a,b){if(!this._dragging){switch(b.keyCode){case 27:break;case 37:case 38:this._scrollSpeed=Math.min(50,Math.abs(1.05*this._scrollSpeed));this._moveEther(this._scrollSpeed);break;case 39:case 40:this._scrollSpeed=-Math.min(50,Math.abs(1.05*this._scrollSpeed));this._moveEther(this._scrollSpeed);break;default:return!0}this.closeBubble();SimileAjax.DOM.cancelEvent(b);return!1}return!0};
Timeline._Band.prototype._onKeyUp=function(a,b){if(!this._dragging){this._scrollSpeed=this._originalScrollSpeed;switch(b.keyCode){case 35:this.setCenterVisibleDate(this._eventSource.getLatestDate());break;case 36:this.setCenterVisibleDate(this._eventSource.getEarliestDate());break;case 33:this._autoScroll(this._timeline.getPixelLength());break;case 34:this._autoScroll(-this._timeline.getPixelLength());break;default:return!0}this.closeBubble();SimileAjax.DOM.cancelEvent(b);return!1}return!0};
Timeline._Band.prototype._autoScroll=function(a,b){var c=this;SimileAjax.Graphics.createAnimation(function(a,b){c._moveEther(b)},0,a,1E3,b).run()};
Timeline._Band.prototype._moveEther=function(a){this.closeBubble();if(this._timeline.shiftOK(this._index,a))this._viewOffset+=a,this._ether.shiftPixels(-a),this._timeline.isHorizontal()?this._div.style.left=this._viewOffset+"px":this._div.style.top=this._viewOffset+"px",this._viewOffset>0.5*-this._viewLength||this._viewOffset<-this._viewLength*(Timeline._Band.SCROLL_MULTIPLES-1.5)?this._recenterDiv():this.softLayout(),this._onChanging()};
Timeline._Band.prototype._onChanging=function(){this._changing=!0;this._fireOnScroll();this._setSyncWithBandDate();this._changing=!1};Timeline._Band.prototype.busy=function(){return this._changing};Timeline._Band.prototype._fireOnScroll=function(){for(var a=0;a<this._onScrollListeners.length;a++)this._onScrollListeners[a](this)};Timeline._Band.prototype._setSyncWithBandDate=function(){this._syncWithBand&&this._syncWithBand.setCenterVisibleDate(this._ether.pixelOffsetToDate(this.getViewLength()/2))};
Timeline._Band.prototype._onHighlightBandScroll=function(){if(this._syncWithBand){var a=this._ether.dateToPixelOffset(this._syncWithBand.getCenterVisibleDate());this._moveEther(Math.round(this._viewLength/2-a));this._highlight&&this._etherPainter.setHighlight(this._syncWithBand.getMinVisibleDate(),this._syncWithBand.getMaxVisibleDate())}};Timeline._Band.prototype._onAddMany=function(){this._paintEvents()};Timeline._Band.prototype._onClear=function(){this._paintEvents()};
Timeline._Band.prototype._positionHighlight=function(){if(this._syncWithBand){var a=this._syncWithBand.getMinVisibleDate(),b=this._syncWithBand.getMaxVisibleDate();this._highlight&&this._etherPainter.setHighlight(a,b)}};
Timeline._Band.prototype._recenterDiv=function(){this._viewOffset=-this._viewLength*(Timeline._Band.SCROLL_MULTIPLES-1)/2;this._timeline.isHorizontal()?(this._div.style.left=this._viewOffset+"px",this._div.style.width=Timeline._Band.SCROLL_MULTIPLES*this._viewLength+"px"):(this._div.style.top=this._viewOffset+"px",this._div.style.height=Timeline._Band.SCROLL_MULTIPLES*this._viewLength+"px");this.layout()};Timeline._Band.prototype._paintEvents=function(){this._eventPainter.paint()};
Timeline._Band.prototype._softPaintEvents=function(){this._eventPainter.softPaint()};Timeline._Band.prototype._paintDecorators=function(){for(var a=0;a<this._decorators.length;a++)this._decorators[a].paint()};Timeline._Band.prototype._softPaintDecorators=function(){for(var a=0;a<this._decorators.length;a++)this._decorators[a].softPaint()};Timeline._Band.prototype.closeBubble=function(){SimileAjax.WindowManager.cancelPopups()};Timeline.ClassicTheme={};Timeline.ClassicTheme.implementations=[];
Timeline.ClassicTheme.create=function(a){null==a&&(a=Timeline.getDefaultLocale());a=Timeline.ClassicTheme.implementations[a];if(null==a)a=Timeline.ClassicTheme._Impl;return new a};
Timeline.ClassicTheme._Impl=function(){this.firstDayOfWeek=0;this.autoWidth=!1;this.autoWidthAnimationTime=500;this.timeline_stop=this.timeline_start=null;this.ether={backgroundColors:[],highlightOpacity:50,interval:{line:{show:!0,opacity:25},weekend:{opacity:30},marker:{hAlign:"Bottom",vAlign:"Right"}}};this.event={track:{height:10,gap:2,offset:2,autoWidthMargin:1.5},overviewTrack:{offset:20,tickHeight:6,height:2,gap:1,autoWidthMargin:5},tape:{height:4},instant:{icon:Timeline.urlPrefix+"images/dull-blue-circle.png",
iconWidth:10,iconHeight:10,impreciseOpacity:20,impreciseIconMargin:3},duration:{impreciseOpacity:20},label:{backgroundOpacity:50,offsetFromLine:3},highlightColors:["#FFFF00","#FFC000","#FF0000","#0000FF"],highlightLabelBackground:!1,bubble:{width:250,maxHeight:0,titleStyler:function(a){a.className="timeline-event-bubble-title"},bodyStyler:function(a){a.className="timeline-event-bubble-body"},imageStyler:function(a){a.className="timeline-event-bubble-image"},wikiStyler:function(a){a.className="timeline-event-bubble-wiki"},
timeStyler:function(a){a.className="timeline-event-bubble-time"}}};this.mouseWheel="scroll"};Timeline.LinearEther=function(a){this._params=a;this._interval=a.interval;this._pixelsPerInterval=a.pixelsPerInterval};
Timeline.LinearEther.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._unit=b.getUnit();"startsOn"in this._params?this._start=this._unit.parseFromObject(this._params.startsOn):"endsOn"in this._params?(this._start=this._unit.parseFromObject(this._params.endsOn),this.shiftPixels(-this._timeline.getPixelLength())):(this._start="centersOn"in this._params?this._unit.parseFromObject(this._params.centersOn):this._unit.makeDefaultValue(),this.shiftPixels(-this._timeline.getPixelLength()/
2))};Timeline.LinearEther.prototype.setDate=function(a){this._start=this._unit.cloneValue(a)};Timeline.LinearEther.prototype.shiftPixels=function(a){this._start=this._unit.change(this._start,this._interval*a/this._pixelsPerInterval)};Timeline.LinearEther.prototype.dateToPixelOffset=function(a){return this._pixelsPerInterval*this._unit.compare(a,this._start)/this._interval};Timeline.LinearEther.prototype.pixelOffsetToDate=function(a){return this._unit.change(this._start,a*this._interval/this._pixelsPerInterval)};
Timeline.LinearEther.prototype.zoom=function(a){var b=0,c=b=this._band._zoomIndex;a&&0<b&&(c=b-1);!a&&b<this._band._zoomSteps.length-1&&(c=b+1);this._band._zoomIndex=c;this._interval=SimileAjax.DateTime.gregorianUnitLengths[this._band._zoomSteps[c].unit];this._pixelsPerInterval=this._band._zoomSteps[c].pixelsPerInterval;return b=this._band._zoomSteps[c].unit-this._band._zoomSteps[b].unit};
Timeline.HotZoneEther=function(a){this._params=a;this._interval=a.interval;this._pixelsPerInterval=a.pixelsPerInterval;this._theme=a.theme};
Timeline.HotZoneEther.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._unit=b.getUnit();this._zones=[{startTime:Number.NEGATIVE_INFINITY,endTime:Number.POSITIVE_INFINITY,magnify:1}];for(var c=this._params,d=0;d<c.zones.length;d++)for(var f=c.zones[d],e=this._unit.parseFromObject(f.start),g=this._unit.parseFromObject(f.end),h=0;h<this._zones.length&&0<this._unit.compare(g,e);h++){var i=this._zones[h];if(0>this._unit.compare(e,i.endTime)){if(0<this._unit.compare(e,i.startTime))this._zones.splice(h,
0,{startTime:i.startTime,endTime:e,magnify:i.magnify}),h++,i.startTime=e;0>this._unit.compare(g,i.endTime)?(this._zones.splice(h,0,{startTime:e,endTime:g,magnify:f.magnify*i.magnify}),h++,e=i.startTime=g):(i.magnify*=f.magnify,e=i.endTime)}}"startsOn"in this._params?this._start=this._unit.parseFromObject(this._params.startsOn):"endsOn"in this._params?(this._start=this._unit.parseFromObject(this._params.endsOn),this.shiftPixels(-this._timeline.getPixelLength())):(this._start="centersOn"in this._params?
this._unit.parseFromObject(this._params.centersOn):this._unit.makeDefaultValue(),this.shiftPixels(-this._timeline.getPixelLength()/2))};Timeline.HotZoneEther.prototype.setDate=function(a){this._start=this._unit.cloneValue(a)};Timeline.HotZoneEther.prototype.shiftPixels=function(a){this._start=this.pixelOffsetToDate(a)};Timeline.HotZoneEther.prototype.dateToPixelOffset=function(a){return this._dateDiffToPixelOffset(this._start,a)};
Timeline.HotZoneEther.prototype.pixelOffsetToDate=function(a){return this._pixelOffsetToDate(a,this._start)};Timeline.HotZoneEther.prototype.zoom=function(a){var b=0,c=b=this._band._zoomIndex;a&&0<b&&(c=b-1);!a&&b<this._band._zoomSteps.length-1&&(c=b+1);this._band._zoomIndex=c;this._interval=SimileAjax.DateTime.gregorianUnitLengths[this._band._zoomSteps[c].unit];this._pixelsPerInterval=this._band._zoomSteps[c].pixelsPerInterval;return b=this._band._zoomSteps[c].unit-this._band._zoomSteps[b].unit};
Timeline.HotZoneEther.prototype._dateDiffToPixelOffset=function(a,b){var c=this._getScale(),d=a,f=0;if(0>this._unit.compare(d,b)){for(var e=0;e<this._zones.length&&!(0>this._unit.compare(d,this._zones[e].endTime));)e++;for(;0>this._unit.compare(d,b);){var g=this._zones[e],h=this._unit.earlier(b,g.endTime),f=f+this._unit.compare(h,d)/(c/g.magnify),d=h;e++}}else{for(e=this._zones.length-1;0<=e&&!(0<this._unit.compare(d,this._zones[e].startTime));)e--;for(;0<this._unit.compare(d,b);)g=this._zones[e],
h=this._unit.later(b,g.startTime),f+=this._unit.compare(h,d)/(c/g.magnify),d=h,e--}return f};
Timeline.HotZoneEther.prototype._pixelOffsetToDate=function(a,b){var c=this._getScale(),d=b;if(0<a){for(var f=0;f<this._zones.length&&!(0>this._unit.compare(d,this._zones[f].endTime));)f++;for(;0<a;){var e=this._zones[f],g=c/e.magnify;if(e.endTime==Number.POSITIVE_INFINITY)d=this._unit.change(d,a*g),a=0;else{var h=this._unit.compare(e.endTime,d)/g;h>a?(d=this._unit.change(d,a*g),a=0):(d=e.endTime,a-=h)}f++}}else{for(f=this._zones.length-1;0<=f&&!(0<this._unit.compare(d,this._zones[f].startTime));)f--;
for(a=-a;0<a;)e=this._zones[f],g=c/e.magnify,e.startTime==Number.NEGATIVE_INFINITY?(d=this._unit.change(d,-a*g),a=0):(h=this._unit.compare(d,e.startTime)/g,h>a?(d=this._unit.change(d,-a*g),a=0):(d=e.startTime,a-=h)),f--}return d};Timeline.HotZoneEther.prototype._getScale=function(){return this._interval/this._pixelsPerInterval};Timeline.GregorianEtherPainter=function(a){this._params=a;this._theme=a.theme;this._unit=a.unit;this._multiple="multiple"in a?a.multiple:1};
Timeline.GregorianEtherPainter.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._backgroundLayer=a.createLayerDiv(0);this._backgroundLayer.setAttribute("name","ether-background");this._backgroundLayer.className="timeline-ether-bg";this._lineLayer=this._markerLayer=null;var c="align"in this._params&&void 0!=this._params.align?this._params.align:this._theme.ether.interval.marker[b.isHorizontal()?"hAlign":"vAlign"];this._intervalMarkerLayout=new Timeline.EtherIntervalMarkerLayout(this._timeline,
this._band,this._theme,c,"showLine"in this._params?this._params.showLine:this._theme.ether.interval.line.show);this._highlight=new Timeline.EtherHighlight(this._timeline,this._band,this._theme,this._backgroundLayer)};Timeline.GregorianEtherPainter.prototype.setHighlight=function(a,b){this._highlight.position(a,b)};
Timeline.GregorianEtherPainter.prototype.paint=function(){this._markerLayer&&this._band.removeLayerDiv(this._markerLayer);this._markerLayer=this._band.createLayerDiv(100);this._markerLayer.setAttribute("name","ether-markers");this._markerLayer.style.display="none";this._lineLayer&&this._band.removeLayerDiv(this._lineLayer);this._lineLayer=this._band.createLayerDiv(1);this._lineLayer.setAttribute("name","ether-lines");this._lineLayer.style.display="none";var a=this._band.getMinDate(),b=this._band.getMaxDate(),
c=this._band.getTimeZone(),d=this._band.getLabeller();for(SimileAjax.DateTime.roundDownToInterval(a,this._unit,c,this._multiple,this._theme.firstDayOfWeek);a.getTime()<b.getTime();){this._intervalMarkerLayout.createIntervalMarker(a,d,this._unit,this._markerLayer,this._lineLayer);for(var c=a,f=0;f<this._multiple;f++)SimileAjax.DateTime.incrementByInterval(c,this._unit)}this._markerLayer.style.display="block";this._lineLayer.style.display="block"};
Timeline.GregorianEtherPainter.prototype.softPaint=function(){};Timeline.GregorianEtherPainter.prototype.zoom=function(a){0!=a&&(this._unit+=a)};
Timeline.HotZoneGregorianEtherPainter=function(a){this._params=a;this._theme=a.theme;this._zones=[{startTime:Number.NEGATIVE_INFINITY,endTime:Number.POSITIVE_INFINITY,unit:a.unit,multiple:1}];for(var b=0;b<a.zones.length;b++)for(var c=a.zones[b],d=SimileAjax.DateTime.parseGregorianDateTime(c.start).getTime(),f=SimileAjax.DateTime.parseGregorianDateTime(c.end).getTime(),e=0;e<this._zones.length&&f>d;e++){var g=this._zones[e];if(d<g.endTime){if(d>g.startTime)this._zones.splice(e,0,{startTime:g.startTime,
endTime:d,unit:g.unit,multiple:g.multiple}),e++,g.startTime=d;f<g.endTime?(this._zones.splice(e,0,{startTime:d,endTime:f,unit:c.unit,multiple:c.multiple?c.multiple:1}),e++,d=g.startTime=f):(g.multiple=c.multiple,g.unit=c.unit,d=g.endTime)}}};
Timeline.HotZoneGregorianEtherPainter.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._backgroundLayer=a.createLayerDiv(0);this._backgroundLayer.setAttribute("name","ether-background");this._backgroundLayer.className="timeline-ether-bg";this._lineLayer=this._markerLayer=null;var c="align"in this._params&&void 0!=this._params.align?this._params.align:this._theme.ether.interval.marker[b.isHorizontal()?"hAlign":"vAlign"];this._intervalMarkerLayout=new Timeline.EtherIntervalMarkerLayout(this._timeline,
this._band,this._theme,c,"showLine"in this._params?this._params.showLine:this._theme.ether.interval.line.show);this._highlight=new Timeline.EtherHighlight(this._timeline,this._band,this._theme,this._backgroundLayer)};Timeline.HotZoneGregorianEtherPainter.prototype.setHighlight=function(a,b){this._highlight.position(a,b)};
Timeline.HotZoneGregorianEtherPainter.prototype.paint=function(){this._markerLayer&&this._band.removeLayerDiv(this._markerLayer);this._markerLayer=this._band.createLayerDiv(100);this._markerLayer.setAttribute("name","ether-markers");this._markerLayer.style.display="none";this._lineLayer&&this._band.removeLayerDiv(this._lineLayer);this._lineLayer=this._band.createLayerDiv(1);this._lineLayer.setAttribute("name","ether-lines");this._lineLayer.style.display="none";for(var a=this._band.getMinDate(),b=
this._band.getMaxDate(),c=this._band.getTimeZone(),d=this._band.getLabeller(),f=0;f<this._zones.length&&!(a.getTime()<this._zones[f].endTime);)f++;for(var e=this._zones.length-1;0<=e&&!(b.getTime()>this._zones[e].startTime);)e--;for(;f<=e;f++){var g=this._zones[f],h=new Date(Math.max(a.getTime(),g.startTime)),i=new Date(Math.min(b.getTime(),g.endTime));SimileAjax.DateTime.roundDownToInterval(h,g.unit,c,g.multiple,this._theme.firstDayOfWeek);for(SimileAjax.DateTime.roundUpToInterval(i,g.unit,c,g.multiple,
this._theme.firstDayOfWeek);h.getTime()<i.getTime();){this._intervalMarkerLayout.createIntervalMarker(h,d,g.unit,this._markerLayer,this._lineLayer);for(var j=h,l=g,k=0;k<l.multiple;k++)SimileAjax.DateTime.incrementByInterval(j,l.unit)}}this._markerLayer.style.display="block";this._lineLayer.style.display="block"};Timeline.HotZoneGregorianEtherPainter.prototype.softPaint=function(){};
Timeline.HotZoneGregorianEtherPainter.prototype.zoom=function(a){if(0!=a)for(var b=0;b<this._zones.length;++b)this._zones[b]&&(this._zones[b].unit+=a)};Timeline.YearCountEtherPainter=function(a){this._params=a;this._theme=a.theme;this._startDate=SimileAjax.DateTime.parseGregorianDateTime(a.startDate);this._multiple="multiple"in a?a.multiple:1};
Timeline.YearCountEtherPainter.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._backgroundLayer=a.createLayerDiv(0);this._backgroundLayer.setAttribute("name","ether-background");this._backgroundLayer.className="timeline-ether-bg";this._lineLayer=this._markerLayer=null;var c="align"in this._params?this._params.align:this._theme.ether.interval.marker[b.isHorizontal()?"hAlign":"vAlign"];this._intervalMarkerLayout=new Timeline.EtherIntervalMarkerLayout(this._timeline,this._band,
this._theme,c,"showLine"in this._params?this._params.showLine:this._theme.ether.interval.line.show);this._highlight=new Timeline.EtherHighlight(this._timeline,this._band,this._theme,this._backgroundLayer)};Timeline.YearCountEtherPainter.prototype.setHighlight=function(a,b){this._highlight.position(a,b)};
Timeline.YearCountEtherPainter.prototype.paint=function(){this._markerLayer&&this._band.removeLayerDiv(this._markerLayer);this._markerLayer=this._band.createLayerDiv(100);this._markerLayer.setAttribute("name","ether-markers");this._markerLayer.style.display="none";this._lineLayer&&this._band.removeLayerDiv(this._lineLayer);this._lineLayer=this._band.createLayerDiv(1);this._lineLayer.setAttribute("name","ether-lines");this._lineLayer.style.display="none";var a=new Date(this._startDate.getTime()),b=
this._band.getMaxDate(),c=this._band.getMinDate().getUTCFullYear()-this._startDate.getUTCFullYear();a.setUTCFullYear(this._band.getMinDate().getUTCFullYear()-c%this._multiple);for(var d=this,c=function(a){for(var b=0;b<d._multiple;b++)SimileAjax.DateTime.incrementByInterval(a,SimileAjax.DateTime.YEAR)},f={labelInterval:function(a){a=a.getUTCFullYear()-d._startDate.getUTCFullYear();return{text:a,emphasized:0==a}}};a.getTime()<b.getTime();)this._intervalMarkerLayout.createIntervalMarker(a,f,SimileAjax.DateTime.YEAR,
this._markerLayer,this._lineLayer),c(a);this._markerLayer.style.display="block";this._lineLayer.style.display="block"};Timeline.YearCountEtherPainter.prototype.softPaint=function(){};Timeline.QuarterlyEtherPainter=function(a){this._params=a;this._theme=a.theme;this._startDate=SimileAjax.DateTime.parseGregorianDateTime(a.startDate)};
Timeline.QuarterlyEtherPainter.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._backgroundLayer=a.createLayerDiv(0);this._backgroundLayer.setAttribute("name","ether-background");this._backgroundLayer.className="timeline-ether-bg";this._lineLayer=this._markerLayer=null;var c="align"in this._params?this._params.align:this._theme.ether.interval.marker[b.isHorizontal()?"hAlign":"vAlign"];this._intervalMarkerLayout=new Timeline.EtherIntervalMarkerLayout(this._timeline,this._band,
this._theme,c,"showLine"in this._params?this._params.showLine:this._theme.ether.interval.line.show);this._highlight=new Timeline.EtherHighlight(this._timeline,this._band,this._theme,this._backgroundLayer)};Timeline.QuarterlyEtherPainter.prototype.setHighlight=function(a,b){this._highlight.position(a,b)};
Timeline.QuarterlyEtherPainter.prototype.paint=function(){this._markerLayer&&this._band.removeLayerDiv(this._markerLayer);this._markerLayer=this._band.createLayerDiv(100);this._markerLayer.setAttribute("name","ether-markers");this._markerLayer.style.display="none";this._lineLayer&&this._band.removeLayerDiv(this._lineLayer);this._lineLayer=this._band.createLayerDiv(1);this._lineLayer.setAttribute("name","ether-lines");this._lineLayer.style.display="none";var a=new Date(0),b=this._band.getMaxDate();
a.setUTCFullYear(Math.max(this._startDate.getUTCFullYear(),this._band.getMinDate().getUTCFullYear()));a.setUTCMonth(this._startDate.getUTCMonth());for(var c=this,d={labelInterval:function(a){var b=(4+(a.getUTCMonth()-c._startDate.getUTCMonth())/3)%4;return 0!=b?{text:"Q"+(b+1),emphasized:!1}:{text:"Y"+(a.getUTCFullYear()-c._startDate.getUTCFullYear()+1),emphasized:!0}}};a.getTime()<b.getTime();)this._intervalMarkerLayout.createIntervalMarker(a,d,SimileAjax.DateTime.YEAR,this._markerLayer,this._lineLayer),
a.setUTCMonth(a.getUTCMonth()+3);this._markerLayer.style.display="block";this._lineLayer.style.display="block"};Timeline.QuarterlyEtherPainter.prototype.softPaint=function(){};
Timeline.EtherIntervalMarkerLayout=function(a,b,c,d,f){var e=a.isHorizontal();this.positionDiv=e?"Top"==d?function(a,b){a.style.left=b+"px";a.style.top="0px"}:function(a,b){a.style.left=b+"px";a.style.bottom="0px"}:"Left"==d?function(a,b){a.style.top=b+"px";a.style.left="0px"}:function(a,b){a.style.top=b+"px";a.style.right="0px"};var g=c.ether.interval.line,h=c.ether.interval.weekend,i=SimileAjax.DateTime.gregorianUnitLengths[SimileAjax.DateTime.DAY];this.createIntervalMarker=function(d,l,k,m,p){var o=
Math.round(b.dateToPixelOffset(d));if(f&&k!=SimileAjax.DateTime.WEEK){var q=a.getDocument().createElement("div");q.className="timeline-ether-lines";100>g.opacity&&SimileAjax.Graphics.setOpacity(q,g.opacity);e?q.style.left=o+"px":q.style.top=o+"px";p.appendChild(q)}if(k==SimileAjax.DateTime.WEEK){var q=c.firstDayOfWeek,q=new Date(d.getTime()+(6-q-7)*i),r=new Date(q.getTime()+2*i),q=Math.round(b.dateToPixelOffset(q)),r=Math.round(b.dateToPixelOffset(r)),r=Math.max(1,r-q),t=a.getDocument().createElement("div");
t.className="timeline-ether-weekends";100>h.opacity&&SimileAjax.Graphics.setOpacity(t,h.opacity);e?(t.style.left=q+"px",t.style.width=r+"px"):(t.style.top=q+"px",t.style.height=r+"px");p.appendChild(t)}d=l.labelInterval(d,k);l=a.getDocument().createElement("div");l.innerHTML=d.text;l.className="timeline-date-label";d.emphasized&&(l.className+=" timeline-date-label-em");this.positionDiv(l,o);m.appendChild(l);return l}};
Timeline.EtherHighlight=function(a,b,c,d){var f=a.isHorizontal();this._highlightDiv=null;this._createHighlightDiv=function(){if(null==this._highlightDiv){this._highlightDiv=a.getDocument().createElement("div");this._highlightDiv.setAttribute("name","ether-highlight");this._highlightDiv.className="timeline-ether-highlight";var b=c.ether.highlightOpacity;100>b&&SimileAjax.Graphics.setOpacity(this._highlightDiv,b);d.appendChild(this._highlightDiv)}};this.position=function(a,c){this._createHighlightDiv();
var d=Math.round(b.dateToPixelOffset(a)),i=Math.round(b.dateToPixelOffset(c)),i=Math.max(i-d,3);f?(this._highlightDiv.style.left=d+"px",this._highlightDiv.style.width=i+"px",this._highlightDiv.style.height=b.getViewWidth()-4+"px"):(this._highlightDiv.style.top=d+"px",this._highlightDiv.style.height=i+"px",this._highlightDiv.style.width=b.getViewWidth()-4+"px")}};Timeline.EventUtils={};
Timeline.EventUtils.getNewEventID=function(){if(null==this._lastEventID)this._lastEventID=0;this._lastEventID+=1;return"e"+this._lastEventID};Timeline.EventUtils.decodeEventElID=function(a){var b=a.split("-");if("tl"!=b[1])return alert("Internal Timeline problem 101, please consult support"),{band:null,evt:null};a=Timeline.getTimelineFromID(b[2]).getBand(b[3]);b=a.getEventSource.getEvent(b[4]);return{band:a,evt:b}};
Timeline.EventUtils.encodeEventElID=function(a,b,c,d){return c+"-tl-"+a.timelineID+"-"+b.getIndex()+"-"+d.getID()};Timeline.GregorianDateLabeller=function(a,b){this._locale=a;this._timeZone=b};Timeline.GregorianDateLabeller.monthNames=[];Timeline.GregorianDateLabeller.dayNames=[];Timeline.GregorianDateLabeller.labelIntervalFunctions=[];Timeline.GregorianDateLabeller.getMonthName=function(a,b){return Timeline.GregorianDateLabeller.monthNames[b][a]};
Timeline.GregorianDateLabeller.prototype.labelInterval=function(a,b){var c=Timeline.GregorianDateLabeller.labelIntervalFunctions[this._locale];if(null==c)c=Timeline.GregorianDateLabeller.prototype.defaultLabelInterval;return c.call(this,a,b)};Timeline.GregorianDateLabeller.prototype.labelPrecise=function(a){return SimileAjax.DateTime.removeTimeZoneOffset(a,this._timeZone).toUTCString()};
Timeline.GregorianDateLabeller.prototype.defaultLabelInterval=function(a,b){var c,d=!1,a=SimileAjax.DateTime.removeTimeZoneOffset(a,this._timeZone);switch(b){case SimileAjax.DateTime.MILLISECOND:c=a.getUTCMilliseconds();break;case SimileAjax.DateTime.SECOND:c=a.getUTCSeconds();break;case SimileAjax.DateTime.MINUTE:c=a.getUTCMinutes();0==c&&(c=a.getUTCHours()+":00",d=!0);break;case SimileAjax.DateTime.HOUR:c=a.getUTCHours()+"hr";break;case SimileAjax.DateTime.DAY:c=Timeline.GregorianDateLabeller.getMonthName(a.getUTCMonth(),
this._locale)+" "+a.getUTCDate();break;case SimileAjax.DateTime.WEEK:c=Timeline.GregorianDateLabeller.getMonthName(a.getUTCMonth(),this._locale)+" "+a.getUTCDate();break;case SimileAjax.DateTime.MONTH:if(c=a.getUTCMonth(),0!=c){c=Timeline.GregorianDateLabeller.getMonthName(c,this._locale);break}case SimileAjax.DateTime.YEAR:case SimileAjax.DateTime.DECADE:case SimileAjax.DateTime.CENTURY:case SimileAjax.DateTime.MILLENNIUM:d=a.getUTCFullYear();c=0<d?a.getUTCFullYear():1-d+"BC";d=b==SimileAjax.DateTime.MONTH||
b==SimileAjax.DateTime.DECADE&&0==d%100||b==SimileAjax.DateTime.CENTURY&&0==d%1E3;break;default:c=a.toUTCString()}return{text:c,emphasized:d}};Timeline.DefaultEventSource=function(a){this._events=a instanceof Object?a:new SimileAjax.EventIndex;this._listeners=[]};Timeline.DefaultEventSource.prototype.addListener=function(a){this._listeners.push(a)};
Timeline.DefaultEventSource.prototype.removeListener=function(a){for(var b=0;b<this._listeners.length;b++)if(this._listeners[b]==a){this._listeners.splice(b,1);break}};
Timeline.DefaultEventSource.prototype.loadXML=function(a,b){for(var c=this._getBaseURL(b),d=a.documentElement.getAttribute("wiki-url"),f=a.documentElement.getAttribute("wiki-section"),e=a.documentElement.getAttribute("date-time-format"),e=this._events.getUnit().getParser(e),g=a.documentElement.firstChild,h=!1;null!=g;){if(1==g.nodeType){h="";if(null!=g.firstChild&&3==g.firstChild.nodeType)h=g.firstChild.nodeValue;var i=null===g.getAttribute("isDuration")&&null===g.getAttribute("durationEvent")||"false"==
g.getAttribute("isDuration")||"false"==g.getAttribute("durationEvent"),h=new Timeline.DefaultEventSource.Event({id:g.getAttribute("id"),start:e(g.getAttribute("start")),end:e(g.getAttribute("end")),latestStart:e(g.getAttribute("latestStart")),earliestEnd:e(g.getAttribute("earliestEnd")),instant:i,text:g.getAttribute("title"),description:h,image:this._resolveRelativeURL(g.getAttribute("image"),c),link:this._resolveRelativeURL(g.getAttribute("link"),c),icon:this._resolveRelativeURL(g.getAttribute("icon"),
c),color:g.getAttribute("color"),textColor:g.getAttribute("textColor"),hoverText:g.getAttribute("hoverText"),classname:g.getAttribute("classname"),tapeImage:g.getAttribute("tapeImage"),tapeRepeat:g.getAttribute("tapeRepeat"),caption:g.getAttribute("caption"),eventID:g.getAttribute("eventID"),trackNum:g.getAttribute("trackNum")});h._node=g;h.getProperty=function(a){return this._node.getAttribute(a)};h.setWikiInfo(d,f);this._events.add(h);h=!0}g=g.nextSibling}h&&this._fire("onAddMany",[])};
Timeline.DefaultEventSource.prototype.loadJSON=function(a,b){var c=this._getBaseURL(b),d=!1;if(a&&a.events){var f="wikiURL"in a?a.wikiURL:null,e="wikiSection"in a?a.wikiSection:null,g="dateTimeFormat"in a?a.dateTimeFormat:null,g=this._events.getUnit().getParser(g),h=0;for(;h<a.events.length;h++){var d=a.events[h],i=d.isDuration||null!=d.durationEvent&&!d.durationEvent,i=new Timeline.DefaultEventSource.Event({id:"id"in d?d.id:void 0,start:g(d.start),end:g(d.end),latestStart:g(d.latestStart),earliestEnd:g(d.earliestEnd),
instant:i,text:d.title,description:d.description,image:this._resolveRelativeURL(d.image,c),link:this._resolveRelativeURL(d.link,c),icon:this._resolveRelativeURL(d.icon,c),color:d.color,textColor:d.textColor,hoverText:d.hoverText,classname:d.classname,tapeImage:d.tapeImage,tapeRepeat:d.tapeRepeat,caption:d.caption,eventID:d.eventID,trackNum:d.trackNum});i._obj=d;i.getProperty=function(a){return this._obj[a]};i.setWikiInfo(f,e);this._events.add(i);d=!0}}d&&this._fire("onAddMany",[])};
Timeline.DefaultEventSource.prototype.loadSPARQL=function(a,b){var c=this._getBaseURL(b),d=this._events.getUnit().getParser("iso8601");if(null!=a){for(var f=a.documentElement.firstChild;null!=f&&(1!=f.nodeType||"results"!=f.nodeName);)f=f.nextSibling;var e=null,g=null;if(null!=f)e=f.getAttribute("wiki-url"),g=f.getAttribute("wiki-section"),f=f.firstChild;for(var h=!1;null!=f;){if(1==f.nodeType){for(var h={},i=f.firstChild;null!=i;){if(1==i.nodeType&&null!=i.firstChild&&1==i.firstChild.nodeType&&null!=
i.firstChild.firstChild&&3==i.firstChild.firstChild.nodeType)h[i.getAttribute("name")]=i.firstChild.firstChild.nodeValue;i=i.nextSibling}null==h.start&&null!=h.date&&(h.start=h.date);i=null===h.isDuration&&null===h.durationEvent||"false"==h.isDuration||"false"==h.durationEvent;i=new Timeline.DefaultEventSource.Event({id:h.id,start:d(h.start),end:d(h.end),latestStart:d(h.latestStart),earliestEnd:d(h.earliestEnd),instant:i,text:h.title,description:h.description,image:this._resolveRelativeURL(h.image,
c),link:this._resolveRelativeURL(h.link,c),icon:this._resolveRelativeURL(h.icon,c),color:h.color,textColor:h.textColor,hoverText:h.hoverText,caption:h.caption,classname:h.classname,tapeImage:h.tapeImage,tapeRepeat:h.tapeRepeat,eventID:h.eventID,trackNum:h.trackNum});i._bindings=h;i.getProperty=function(a){return this._bindings[a]};i.setWikiInfo(e,g);this._events.add(i);h=!0}f=f.nextSibling}h&&this._fire("onAddMany",[])}};
Timeline.DefaultEventSource.prototype.add=function(a){this._events.add(a);this._fire("onAddOne",[a])};Timeline.DefaultEventSource.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._events.add(a[b]);this._fire("onAddMany",[])};Timeline.DefaultEventSource.prototype.clear=function(){this._events.removeAll();this._fire("onClear",[])};Timeline.DefaultEventSource.prototype.getEvent=function(a){return this._events.getEvent(a)};
Timeline.DefaultEventSource.prototype.getEventIterator=function(a,b){return this._events.getIterator(a,b)};Timeline.DefaultEventSource.prototype.getEventReverseIterator=function(a,b){return this._events.getReverseIterator(a,b)};Timeline.DefaultEventSource.prototype.getAllEventIterator=function(){return this._events.getAllIterator()};Timeline.DefaultEventSource.prototype.getCount=function(){return this._events.getCount()};Timeline.DefaultEventSource.prototype.getEarliestDate=function(){return this._events.getEarliestDate()};
Timeline.DefaultEventSource.prototype.getLatestDate=function(){return this._events.getLatestDate()};Timeline.DefaultEventSource.prototype._fire=function(a,b){for(var c=0;c<this._listeners.length;c++){var d=this._listeners[c];if(a in d)try{d[a].apply(d,b)}catch(f){SimileAjax.Debug.exception(f)}}};
Timeline.DefaultEventSource.prototype._getBaseURL=function(a){if(0>a.indexOf("://"))var b=this._getBaseURL(document.location.href),a="/"==a.substr(0,1)?b.substr(0,b.indexOf("/",b.indexOf("://")+3))+a:b+a;b=a.lastIndexOf("/");return 0>b?"":a.substr(0,b+1)};Timeline.DefaultEventSource.prototype._resolveRelativeURL=function(a,b){return null==a||""==a?a:0<a.indexOf("://")?a:"/"==a.substr(0,1)?b.substr(0,b.indexOf("/",b.indexOf("://")+3))+a:b+a};
Timeline.DefaultEventSource.Event=function(a){function b(b){return null!=a[b]&&""!=a[b]?a[b]:null}var c=a.id?a.id.trim():"";this._id=0<c.length?c:Timeline.EventUtils.getNewEventID();this._instant=a.instant||null==a.end;this._start=a.start;this._end=null!=a.end?a.end:a.start;this._latestStart=null!=a.latestStart?a.latestStart:a.instant?this._end:this._start;this._earliestEnd=null!=a.earliestEnd?a.earliestEnd:this._end;c=[];if(this._start>this._latestStart)this._latestStart=this._start,c.push("start is > latestStart");
if(this._start>this._earliestEnd)this._earliestEnd=this._latestStart,c.push("start is > earliestEnd");if(this._start>this._end)this._end=this._earliestEnd,c.push("start is > end");if(this._latestStart>this._earliestEnd)this._earliestEnd=this._latestStart,c.push("latestStart is > earliestEnd");if(this._latestStart>this._end)this._end=this._earliestEnd,c.push("latestStart is > end");if(this._earliestEnd>this._end)this._end=this._earliestEnd,c.push("earliestEnd is > end");this._eventID=b("eventID");
this._text=null!=a.text?SimileAjax.HTML.deEntify(a.text):"";0<c.length&&(this._text+=" PROBLEM: "+c.join(", "));this._description=SimileAjax.HTML.deEntify(a.description);this._image=b("image");this._link=b("link");this._title=b("hoverText");this._title=b("caption");this._icon=b("icon");this._color=b("color");this._textColor=b("textColor");this._classname=b("classname");this._tapeImage=b("tapeImage");this._tapeRepeat=b("tapeRepeat");this._trackNum=b("trackNum");if(null!=this._trackNum)this._trackNum=
parseInt(this._trackNum);this._wikiSection=this._wikiURL=null};
Timeline.DefaultEventSource.Event.prototype={getID:function(){return this._id},isInstant:function(){return this._instant},isImprecise:function(){return this._start!=this._latestStart||this._end!=this._earliestEnd},getStart:function(){return this._start},getEnd:function(){return this._end},getLatestStart:function(){return this._latestStart},getEarliestEnd:function(){return this._earliestEnd},getEventID:function(){return this._eventID},getText:function(){return this._text},getDescription:function(){return this._description},
getImage:function(){return this._image},getLink:function(){return this._link},getIcon:function(){return this._icon},getColor:function(){return this._color},getTextColor:function(){return this._textColor},getClassName:function(){return this._classname},getTapeImage:function(){return this._tapeImage},getTapeRepeat:function(){return this._tapeRepeat},getTrackNum:function(){return this._trackNum},getProperty:function(){return null},getWikiURL:function(){return this._wikiURL},getWikiSection:function(){return this._wikiSection},
setWikiInfo:function(a,b){this._wikiURL=a;this._wikiSection=b},fillDescription:function(a){a.innerHTML=this._description},fillWikiInfo:function(a){a.style.display="none";if(!(null==this._wikiURL||null==this._wikiSection)){var b=this.getProperty("wikiID");if(null==b||0==b.length)b=this.getText();if(!(null==b||0==b.length)){a.style.display="inline";var b=b.replace(/\s/g,"_"),b=this._wikiURL+this._wikiSection.replace(/\s/g,"_")+"/"+b,c=document.createElement("a");c.href=b;c.target="new";c.innerHTML=
Timeline.strings[Timeline.clientLocale].wikiLinkLabel;a.appendChild(document.createTextNode("["));a.appendChild(c);a.appendChild(document.createTextNode("]"))}}},fillTime:function(a,b){this._instant?this.isImprecise()?(a.appendChild(a.ownerDocument.createTextNode(b.labelPrecise(this._start))),a.appendChild(a.ownerDocument.createElement("br")),a.appendChild(a.ownerDocument.createTextNode(b.labelPrecise(this._end)))):a.appendChild(a.ownerDocument.createTextNode(b.labelPrecise(this._start))):this.isImprecise()?
(a.appendChild(a.ownerDocument.createTextNode(b.labelPrecise(this._start)+" ~ "+b.labelPrecise(this._latestStart))),a.appendChild(a.ownerDocument.createElement("br")),a.appendChild(a.ownerDocument.createTextNode(b.labelPrecise(this._earliestEnd)+" ~ "+b.labelPrecise(this._end)))):(a.appendChild(a.ownerDocument.createTextNode(b.labelPrecise(this._start))),a.appendChild(a.ownerDocument.createElement("br")),a.appendChild(a.ownerDocument.createTextNode(b.labelPrecise(this._end))))},fillInfoBubble:function(a,
b,c){var d=a.ownerDocument,f=this.getText(),e=this.getLink(),g=this.getImage();if(null!=g){var h=d.createElement("img");h.src=g;b.event.bubble.imageStyler(h);a.appendChild(h)}g=d.createElement("div");f=d.createTextNode(f);null!=e?(h=d.createElement("a"),h.href=e,h.appendChild(f),g.appendChild(h)):g.appendChild(f);b.event.bubble.titleStyler(g);a.appendChild(g);e=d.createElement("div");this.fillDescription(e);b.event.bubble.bodyStyler(e);a.appendChild(e);e=d.createElement("div");this.fillTime(e,c);
b.event.bubble.timeStyler(e);a.appendChild(e);c=d.createElement("div");this.fillWikiInfo(c);b.event.bubble.wikiStyler(c);a.appendChild(c)}};Timeline.OriginalEventPainter=function(a){this._params=a;this._onSelectListeners=[];this._eventPaintListeners=[];this._frc=this._highlightMatcher=this._filterMatcher=null;this._eventIdToElmt={}};
Timeline.OriginalEventPainter.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._eventIdToElmt=this._highlightLayer=this._lineLayer=this._eventLayer=this._backLayer=null};Timeline.OriginalEventPainter.prototype.getType=function(){return"original"};Timeline.OriginalEventPainter.prototype.addOnSelectListener=function(a){this._onSelectListeners.push(a)};
Timeline.OriginalEventPainter.prototype.removeOnSelectListener=function(a){for(var b=0;b<this._onSelectListeners.length;b++)if(this._onSelectListeners[b]==a){this._onSelectListeners.splice(b,1);break}};Timeline.OriginalEventPainter.prototype.addEventPaintListener=function(a){this._eventPaintListeners.push(a)};
Timeline.OriginalEventPainter.prototype.removeEventPaintListener=function(a){for(var b=0;b<this._eventPaintListeners.length;b++)if(this._eventPaintListeners[b]==a){this._eventPaintListeners.splice(b,1);break}};Timeline.OriginalEventPainter.prototype.getFilterMatcher=function(){return this._filterMatcher};Timeline.OriginalEventPainter.prototype.setFilterMatcher=function(a){this._filterMatcher=a};Timeline.OriginalEventPainter.prototype.getHighlightMatcher=function(){return this._highlightMatcher};
Timeline.OriginalEventPainter.prototype.setHighlightMatcher=function(a){this._highlightMatcher=a};
Timeline.OriginalEventPainter.prototype.paint=function(){var a=this._band.getEventSource();if(null!=a){this._eventIdToElmt={};this._fireEventPaintListeners("paintStarting",null,null);this._prepareForPainting();for(var b=this._params.theme.event,c=Math.max(b.track.height,b.tape.height+this._frc.getLineHeight()),b={trackOffset:b.track.offset,trackHeight:c,trackGap:b.track.gap,trackIncrement:c+b.track.gap,icon:b.instant.icon,iconWidth:b.instant.iconWidth,iconHeight:b.instant.iconHeight,labelWidth:b.label.width,
maxLabelChar:b.label.maxLabelChar,impreciseIconMargin:b.instant.impreciseIconMargin},d=this._band.getMinDate(),f=this._band.getMaxDate(),c=null!=this._filterMatcher?this._filterMatcher:function(){return!0},e=null!=this._highlightMatcher?this._highlightMatcher:function(){return-1},a=a.getEventReverseIterator(d,f);a.hasNext();)d=a.next(),c(d)&&this.paintEvent(d,b,this._params.theme,e(d));this._highlightLayer.style.display="block";this._lineLayer.style.display="block";this._eventLayer.style.display=
"block";this._band.updateEventTrackInfo(this._tracks.length,b.trackIncrement);this._fireEventPaintListeners("paintEnded",null,null)}};Timeline.OriginalEventPainter.prototype.softPaint=function(){};
Timeline.OriginalEventPainter.prototype._prepareForPainting=function(){var a=this._band;if(null==this._backLayer){this._backLayer=this._band.createLayerDiv(0,"timeline-band-events");this._backLayer.style.visibility="hidden";var b=document.createElement("span");b.className="timeline-event-label";this._backLayer.appendChild(b);this._frc=SimileAjax.Graphics.getFontRenderingContext(b)}this._frc.update();this._tracks=[];null!=this._highlightLayer&&a.removeLayerDiv(this._highlightLayer);this._highlightLayer=
a.createLayerDiv(105,"timeline-band-highlights");this._highlightLayer.style.display="none";null!=this._lineLayer&&a.removeLayerDiv(this._lineLayer);this._lineLayer=a.createLayerDiv(110,"timeline-band-lines");this._lineLayer.style.display="none";null!=this._eventLayer&&a.removeLayerDiv(this._eventLayer);this._eventLayer=a.createLayerDiv(115,"timeline-band-events");this._eventLayer.style.display="none"};
Timeline.OriginalEventPainter.prototype.paintEvent=function(a,b,c,d){a.isInstant()?this.paintInstantEvent(a,b,c,d):this.paintDurationEvent(a,b,c,d)};Timeline.OriginalEventPainter.prototype.paintInstantEvent=function(a,b,c,d){a.isImprecise()?this.paintImpreciseInstantEvent(a,b,c,d):this.paintPreciseInstantEvent(a,b,c,d)};Timeline.OriginalEventPainter.prototype.paintDurationEvent=function(a,b,c,d){a.isImprecise()?this.paintImpreciseDurationEvent(a,b,c,d):this.paintPreciseDurationEvent(a,b,c,d)};
Timeline.OriginalEventPainter.prototype.paintPreciseInstantEvent=function(a,b,c,d){this._timeline.getDocument();var f=a.getText(),e=a.getStart(),e=Math.round(this._band.dateToPixelOffset(e)),g=Math.round(e+b.iconWidth/2),e=Math.round(e-b.iconWidth/2),h=this._getLabelDivClassName(a),i=this._frc.computeSize(f,h),j=g+c.event.label.offsetFromLine,g=this._findFreeTrack(a,j+i.width),l=Math.round(b.trackOffset+g*b.trackIncrement+b.trackHeight/2-i.height/2),k=this._paintEventIcon(a,g,e,b,c,0),f=this._paintEventLabel(a,
f,j,l,i.width,i.height,c,h,d),b=[k.elmt,f.elmt],m=this,h=function(b,c){return m._onClickInstantEvent(k.elmt,c,a)};SimileAjax.DOM.registerEvent(k.elmt,"mousedown",h);SimileAjax.DOM.registerEvent(f.elmt,"mousedown",h);c=this._createHighlightDiv(d,k,c,a);null!=c&&b.push(c);this._fireEventPaintListeners("paintedEvent",a,b);this._eventIdToElmt[a.getID()]=k.elmt;this._tracks[g]=e};
Timeline.OriginalEventPainter.prototype.paintImpreciseInstantEvent=function(a,b,c,d){this._timeline.getDocument();var f=a.getText(),e=a.getStart(),g=a.getEnd(),h=Math.round(this._band.dateToPixelOffset(e)),i=Math.round(this._band.dateToPixelOffset(g)),e=Math.round(h+b.iconWidth/2),g=Math.round(h-b.iconWidth/2),j=this._getLabelDivClassName(a),l=this._frc.computeSize(f,j),k=e+c.event.label.offsetFromLine,e=Math.max(k+l.width,i),e=this._findFreeTrack(a,e),m=c.event.tape.height,p=Math.round(b.trackOffset+
e*b.trackIncrement+m),o=this._paintEventIcon(a,e,g,b,c,m),f=this._paintEventLabel(a,f,k,p,l.width,l.height,c,j,d),j=a.getColor(),j=null!=j?j:c.event.instant.impreciseColor,h=this._paintEventTape(a,e,h,i,j,c.event.instant.impreciseOpacity,b,c,0),b=[o.elmt,f.elmt,h.elmt],q=this,i=function(b,c){return q._onClickInstantEvent(o.elmt,c,a)};SimileAjax.DOM.registerEvent(o.elmt,"mousedown",i);SimileAjax.DOM.registerEvent(h.elmt,"mousedown",i);SimileAjax.DOM.registerEvent(f.elmt,"mousedown",i);c=this._createHighlightDiv(d,
o,c,a);null!=c&&b.push(c);this._fireEventPaintListeners("paintedEvent",a,b);this._eventIdToElmt[a.getID()]=o.elmt;this._tracks[e]=g};
Timeline.OriginalEventPainter.prototype.paintPreciseDurationEvent=function(a,b,c,d){this._timeline.getDocument();var f=a.getText(),e=a.getStart(),g=a.getEnd(),e=Math.round(this._band.dateToPixelOffset(e)),h=Math.round(this._band.dateToPixelOffset(g)),i=this._getLabelDivClassName(a),j=this._frc.computeSize(f,i),g=Math.max(e+j.width,h),g=this._findFreeTrack(a,g),l=Math.round(b.trackOffset+g*b.trackIncrement+c.event.tape.height),k=a.getColor(),k=null!=k?k:c.event.duration.color,m=this._paintEventTape(a,
g,e,h,k,100,b,c,0),f=this._paintEventLabel(a,f,e,l,j.width,j.height,c,i,d),b=[m.elmt,f.elmt],p=this,h=function(b,c){return p._onClickDurationEvent(m.elmt,c,a)};SimileAjax.DOM.registerEvent(m.elmt,"mousedown",h);SimileAjax.DOM.registerEvent(f.elmt,"mousedown",h);c=this._createHighlightDiv(d,m,c,a);null!=c&&b.push(c);this._fireEventPaintListeners("paintedEvent",a,b);this._eventIdToElmt[a.getID()]=m.elmt;this._tracks[g]=e};
Timeline.OriginalEventPainter.prototype.paintImpreciseDurationEvent=function(a,b,c,d){this._timeline.getDocument();var f=a.getText(),e=a.getStart(),g=a.getLatestStart(),h=a.getEnd(),i=a.getEarliestEnd(),e=Math.round(this._band.dateToPixelOffset(e)),g=Math.round(this._band.dateToPixelOffset(g)),h=Math.round(this._band.dateToPixelOffset(h)),j=Math.round(this._band.dateToPixelOffset(i)),l=this._getLabelDivClassName(a),k=this._frc.computeSize(f,l),i=Math.max(g+k.width,h),i=this._findFreeTrack(a,i),m=
Math.round(b.trackOffset+i*b.trackIncrement+c.event.tape.height),p=a.getColor(),p=null!=p?p:c.event.duration.color,h=this._paintEventTape(a,i,e,h,c.event.duration.impreciseColor,c.event.duration.impreciseOpacity,b,c,0),o=this._paintEventTape(a,i,g,j,p,100,b,c,1),b=this._paintEventLabel(a,f,g,m,k.width,k.height,c,l,d),f=[h.elmt,o.elmt,b.elmt],q=this,g=function(b,c){return q._onClickDurationEvent(o.elmt,c,a)};SimileAjax.DOM.registerEvent(o.elmt,"mousedown",g);SimileAjax.DOM.registerEvent(b.elmt,"mousedown",
g);c=this._createHighlightDiv(d,o,c,a);null!=c&&f.push(c);this._fireEventPaintListeners("paintedEvent",a,f);this._eventIdToElmt[a.getID()]=o.elmt;this._tracks[i]=e};Timeline.OriginalEventPainter.prototype._encodeEventElID=function(a,b){return Timeline.EventUtils.encodeEventElID(this._timeline,this._band,a,b)};Timeline.OriginalEventPainter.prototype._findFreeTrack=function(a,b){var c=a.getTrackNum();if(null!=c)return c;for(c=0;c<this._tracks.length&&!(this._tracks[c]>b);c++);return c};
Timeline.OriginalEventPainter.prototype._paintEventIcon=function(a,b,c,d,f,e){f=a.getIcon();f=null!=f?f:d.icon;b=0<e?d.trackOffset+b*d.trackIncrement+e+d.impreciseIconMargin:Math.round(d.trackOffset+b*d.trackIncrement+d.trackHeight/2-d.iconHeight/2);e=SimileAjax.Graphics.createTranslucentImage(f);f=this._timeline.getDocument().createElement("div");f.className=this._getElClassName("timeline-event-icon",a,"icon");f.id=this._encodeEventElID("icon",a);f.style.left=c+"px";f.style.top=b+"px";f.appendChild(e);
if(null!=a._title)f.title=a._title;this._eventLayer.appendChild(f);return{left:c,top:b,width:d.iconWidth,height:d.iconHeight,elmt:f}};
Timeline.OriginalEventPainter.prototype._paintEventLabel=function(a,b,c,d,f,e,g,h,i){var j=this._timeline.getDocument().createElement("div");j.className=h;j.id=this._encodeEventElID("label",a);j.style.left=c+"px";j.style.width=f+"px";j.style.top=d+"px";j.innerHTML=b;if(null!=a._title)j.title=a._title;b=a.getTextColor();null==b&&(b=a.getColor());if(null!=b)j.style.color=b;if(g.event.highlightLabelBackground&&0<=i)j.style.background=this._getHighlightColor(i,g);this._eventLayer.appendChild(j);return{left:c,
top:d,width:f,height:e,elmt:j}};
Timeline.OriginalEventPainter.prototype._paintEventTape=function(a,b,c,d,f,e,g,h,i){d-=c;h=h.event.tape.height;b=g.trackOffset+b*g.trackIncrement;g=this._timeline.getDocument().createElement("div");g.className=this._getElClassName("timeline-event-tape",a,"tape");g.id=this._encodeEventElID("tape"+i,a);g.style.left=c+"px";g.style.width=d+"px";g.style.height=h+"px";g.style.top=b+"px";if(null!=a._title)g.title=a._title;if(null!=f)g.style.backgroundColor=f;f=a.getTapeImage();a=a.getTapeRepeat();a=null!=
a?a:"repeat";if(null!=f)g.style.backgroundImage="url("+f+")",g.style.backgroundRepeat=a;SimileAjax.Graphics.setOpacity(g,e);this._eventLayer.appendChild(g);return{left:c,top:b,width:d,height:h,elmt:g}};Timeline.OriginalEventPainter.prototype._getLabelDivClassName=function(a){return this._getElClassName("timeline-event-label",a,"label")};Timeline.OriginalEventPainter.prototype._getElClassName=function(a,b,c){var b=b.getClassName(),d=[];b&&(c&&d.push(c+"-"+b+" "),d.push(b+" "));d.push(a);return d.join("")};
Timeline.OriginalEventPainter.prototype._getHighlightColor=function(a,b){var c=b.event.highlightColors;return c[Math.min(a,c.length-1)]};
Timeline.OriginalEventPainter.prototype._createHighlightDiv=function(a,b,c,d){var f=null;if(0<=a)f=this._timeline.getDocument(),a=this._getHighlightColor(a,c),f=f.createElement("div"),f.className=this._getElClassName("timeline-event-highlight",d,"highlight"),f.id=this._encodeEventElID("highlight0",d),f.style.position="absolute",f.style.overflow="hidden",f.style.left=b.left-2+"px",f.style.width=b.width+4+"px",f.style.top=b.top-2+"px",f.style.height=b.height+4+"px",f.style.background=a,this._highlightLayer.appendChild(f);
return f};Timeline.OriginalEventPainter.prototype._onClickInstantEvent=function(a,b,c){var d=SimileAjax.DOM.getPageCoordinates(a);this._showBubble(d.left+Math.ceil(a.offsetWidth/2),d.top+Math.ceil(a.offsetHeight/2),c);this._fireOnSelect(c.getID());b.cancelBubble=!0;SimileAjax.DOM.cancelEvent(b);return!1};
Timeline.OriginalEventPainter.prototype._onClickDurationEvent=function(a,b,c){if("pageX"in b)var a=b.pageX,d=b.pageY;else d=SimileAjax.DOM.getPageCoordinates(a),a=b.offsetX+d.left,d=b.offsetY+d.top;this._showBubble(a,d,c);this._fireOnSelect(c.getID());b.cancelBubble=!0;SimileAjax.DOM.cancelEvent(b);return!1};
Timeline.OriginalEventPainter.prototype.showBubble=function(a){var b=this._eventIdToElmt[a.getID()];if(b){var c=SimileAjax.DOM.getPageCoordinates(b);this._showBubble(c.left+b.offsetWidth/2,c.top+b.offsetHeight/2,a)}};
Timeline.OriginalEventPainter.prototype._showBubble=function(a,b,c){var d=document.createElement("div"),f=this._params.theme.event.bubble;c.fillInfoBubble(d,this._params.theme,this._band.getLabeller());SimileAjax.WindowManager.cancelPopups();SimileAjax.Graphics.createBubbleForContentAndPoint(d,a,b,f.width,null,f.maxHeight)};Timeline.OriginalEventPainter.prototype._fireOnSelect=function(a){for(var b=0;b<this._onSelectListeners.length;b++)this._onSelectListeners[b](a)};
Timeline.OriginalEventPainter.prototype._fireEventPaintListeners=function(a,b,c){for(var d=0;d<this._eventPaintListeners.length;d++)this._eventPaintListeners[d](this._band,a,b,c)};Timeline.DetailedEventPainter=function(a){this._params=a;this._onSelectListeners=[];this._frc=this._highlightMatcher=this._filterMatcher=null;this._eventIdToElmt={}};
Timeline.DetailedEventPainter.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._eventIdToElmt=this._highlightLayer=this._lineLayer=this._eventLayer=this._backLayer=null};Timeline.DetailedEventPainter.prototype.getType=function(){return"detailed"};Timeline.DetailedEventPainter.prototype.addOnSelectListener=function(a){this._onSelectListeners.push(a)};
Timeline.DetailedEventPainter.prototype.removeOnSelectListener=function(a){for(var b=0;b<this._onSelectListeners.length;b++)if(this._onSelectListeners[b]==a){this._onSelectListeners.splice(b,1);break}};Timeline.DetailedEventPainter.prototype.getFilterMatcher=function(){return this._filterMatcher};Timeline.DetailedEventPainter.prototype.setFilterMatcher=function(a){this._filterMatcher=a};Timeline.DetailedEventPainter.prototype.getHighlightMatcher=function(){return this._highlightMatcher};
Timeline.DetailedEventPainter.prototype.setHighlightMatcher=function(a){this._highlightMatcher=a};
Timeline.DetailedEventPainter.prototype.paint=function(){var a=this._band.getEventSource();if(null!=a){this._eventIdToElmt={};this._prepareForPainting();for(var b=this._params.theme.event,c=Math.max(b.track.height,this._frc.getLineHeight()),b={trackOffset:Math.round(this._band.getViewWidth()/2-c/2),trackHeight:c,trackGap:b.track.gap,trackIncrement:c+b.track.gap,icon:b.instant.icon,iconWidth:b.instant.iconWidth,iconHeight:b.instant.iconHeight,labelWidth:b.label.width},d=this._band.getMinDate(),f=this._band.getMaxDate(),
c=null!=this._filterMatcher?this._filterMatcher:function(){return!0},e=null!=this._highlightMatcher?this._highlightMatcher:function(){return-1},a=a.getEventReverseIterator(d,f);a.hasNext();)d=a.next(),c(d)&&this.paintEvent(d,b,this._params.theme,e(d));this._highlightLayer.style.display="block";this._lineLayer.style.display="block";this._eventLayer.style.display="block";this._band.updateEventTrackInfo(this._lowerTracks.length+this._upperTracks.length,b.trackIncrement)}};
Timeline.DetailedEventPainter.prototype.softPaint=function(){};
Timeline.DetailedEventPainter.prototype._prepareForPainting=function(){var a=this._band;if(null==this._backLayer){this._backLayer=this._band.createLayerDiv(0,"timeline-band-events");this._backLayer.style.visibility="hidden";var b=document.createElement("span");b.className="timeline-event-label";this._backLayer.appendChild(b);this._frc=SimileAjax.Graphics.getFontRenderingContext(b)}this._frc.update();this._lowerTracks=[];this._upperTracks=[];null!=this._highlightLayer&&a.removeLayerDiv(this._highlightLayer);
this._highlightLayer=a.createLayerDiv(105,"timeline-band-highlights");this._highlightLayer.style.display="none";null!=this._lineLayer&&a.removeLayerDiv(this._lineLayer);this._lineLayer=a.createLayerDiv(110,"timeline-band-lines");this._lineLayer.style.display="none";null!=this._eventLayer&&a.removeLayerDiv(this._eventLayer);this._eventLayer=a.createLayerDiv(110,"timeline-band-events");this._eventLayer.style.display="none"};
Timeline.DetailedEventPainter.prototype.paintEvent=function(a,b,c,d){a.isInstant()?this.paintInstantEvent(a,b,c,d):this.paintDurationEvent(a,b,c,d)};Timeline.DetailedEventPainter.prototype.paintInstantEvent=function(a,b,c,d){a.isImprecise()?this.paintImpreciseInstantEvent(a,b,c,d):this.paintPreciseInstantEvent(a,b,c,d)};Timeline.DetailedEventPainter.prototype.paintDurationEvent=function(a,b,c,d){a.isImprecise()?this.paintImpreciseDurationEvent(a,b,c,d):this.paintPreciseDurationEvent(a,b,c,d)};
Timeline.DetailedEventPainter.prototype.paintPreciseInstantEvent=function(a,b,c,d){this._timeline.getDocument();var f=a.getText(),e=a.getStart(),g=Math.round(this._band.dateToPixelOffset(e)),h=Math.round(g+b.iconWidth/2),i=Math.round(g-b.iconWidth/2),e=this._frc.computeSize(f),j=this._findFreeTrackForSolid(h,g),l=this._paintEventIcon(a,j,i,b,c),h=h+c.event.label.offsetFromLine,k=j,m=this._getTrackData(j);Math.min(m.solid,m.text)>=h+e.width?(m.solid=i,m.text=h):(m.solid=i,h=g+c.event.label.offsetFromLine,
k=this._findFreeTrackForText(j,h+e.width,function(a){a.line=g-2}),this._getTrackData(k).text=i,this._paintEventLine(a,g,j,k,b,c));var b=Math.round(b.trackOffset+k*b.trackIncrement+b.trackHeight/2-e.height/2),f=this._paintEventLabel(a,f,h,b,e.width,e.height,c),p=this,b=function(b,c){return p._onClickInstantEvent(l.elmt,c,a)};SimileAjax.DOM.registerEvent(l.elmt,"mousedown",b);SimileAjax.DOM.registerEvent(f.elmt,"mousedown",b);this._createHighlightDiv(d,l,c);this._eventIdToElmt[a.getID()]=l.elmt};
Timeline.DetailedEventPainter.prototype.paintImpreciseInstantEvent=function(a,b,c,d){this._timeline.getDocument();var f=a.getText(),e=a.getStart(),g=a.getEnd(),h=Math.round(this._band.dateToPixelOffset(e)),i=Math.round(this._band.dateToPixelOffset(g)),j=Math.round(h+b.iconWidth/2),l=Math.round(h-b.iconWidth/2),g=this._frc.computeSize(f),k=this._findFreeTrackForSolid(i,h),e=this._paintEventTape(a,k,h,i,c.event.instant.impreciseColor,c.event.instant.impreciseOpacity,b,c),m=this._paintEventIcon(a,k,
l,b,c);this._getTrackData(k).solid=l;var j=j+c.event.label.offsetFromLine,p=j+g.width;p<i?i=k:(j=h+c.event.label.offsetFromLine,p=j+g.width,i=this._findFreeTrackForText(k,p,function(a){a.line=h-2}),this._getTrackData(i).text=l,this._paintEventLine(a,h,k,i,b,c));var b=Math.round(b.trackOffset+i*b.trackIncrement+b.trackHeight/2-g.height/2),f=this._paintEventLabel(a,f,j,b,g.width,g.height,c),o=this,b=function(b,c){return o._onClickInstantEvent(m.elmt,c,a)};SimileAjax.DOM.registerEvent(m.elmt,"mousedown",
b);SimileAjax.DOM.registerEvent(e.elmt,"mousedown",b);SimileAjax.DOM.registerEvent(f.elmt,"mousedown",b);this._createHighlightDiv(d,m,c);this._eventIdToElmt[a.getID()]=m.elmt};
Timeline.DetailedEventPainter.prototype.paintPreciseDurationEvent=function(a,b,c,d){this._timeline.getDocument();var f=a.getText(),e=a.getStart(),g=a.getEnd(),h=Math.round(this._band.dateToPixelOffset(e)),i=Math.round(this._band.dateToPixelOffset(g)),e=this._frc.computeSize(f),g=this._findFreeTrackForSolid(i),j=a.getColor(),j=null!=j?j:c.event.duration.color,l=this._paintEventTape(a,g,h,i,j,100,b,c);this._getTrackData(g).solid=h;i=h+c.event.label.offsetFromLine;j=this._findFreeTrackForText(g,i+e.width,
function(a){a.line=h-2});this._getTrackData(j).text=h-2;this._paintEventLine(a,h,g,j,b,c);var b=Math.round(b.trackOffset+j*b.trackIncrement+b.trackHeight/2-e.height/2),f=this._paintEventLabel(a,f,i,b,e.width,e.height,c),k=this,b=function(b,c){return k._onClickDurationEvent(l.elmt,c,a)};SimileAjax.DOM.registerEvent(l.elmt,"mousedown",b);SimileAjax.DOM.registerEvent(f.elmt,"mousedown",b);this._createHighlightDiv(d,l,c);this._eventIdToElmt[a.getID()]=l.elmt};
Timeline.DetailedEventPainter.prototype.paintImpreciseDurationEvent=function(a,b,c,d){this._timeline.getDocument();var f=a.getText(),e=a.getStart(),g=a.getLatestStart(),h=a.getEnd(),i=a.getEarliestEnd(),e=Math.round(this._band.dateToPixelOffset(e)),j=Math.round(this._band.dateToPixelOffset(g)),h=Math.round(this._band.dateToPixelOffset(h)),l=Math.round(this._band.dateToPixelOffset(i)),i=this._frc.computeSize(f),g=this._findFreeTrackForSolid(h),k=a.getColor(),k=null!=k?k:c.event.duration.color;this._paintEventTape(a,
g,e,h,c.event.duration.impreciseColor,c.event.duration.impreciseOpacity,b,c);var m=this._paintEventTape(a,g,j,l,k,100,b,c);this._getTrackData(g).solid=e;e=j+c.event.label.offsetFromLine;h=this._findFreeTrackForText(g,e+i.width,function(a){a.line=j-2});this._getTrackData(h).text=j-2;this._paintEventLine(a,j,g,h,b,c);var b=Math.round(b.trackOffset+h*b.trackIncrement+b.trackHeight/2-i.height/2),f=this._paintEventLabel(a,f,e,b,i.width,i.height,c),p=this,b=function(b,c){return p._onClickDurationEvent(m.elmt,
c,a)};SimileAjax.DOM.registerEvent(m.elmt,"mousedown",b);SimileAjax.DOM.registerEvent(f.elmt,"mousedown",b);this._createHighlightDiv(d,m,c);this._eventIdToElmt[a.getID()]=m.elmt};
Timeline.DetailedEventPainter.prototype._findFreeTrackForSolid=function(a,b){for(var c=0;;c++){if(c<this._lowerTracks.length){var d=this._lowerTracks[c];if(Math.min(d.solid,d.text)>a&&(!b||d.line>b))return c}else return this._lowerTracks.push({solid:Number.POSITIVE_INFINITY,text:Number.POSITIVE_INFINITY,line:Number.POSITIVE_INFINITY}),c;if(c<this._upperTracks.length){if(d=this._upperTracks[c],Math.min(d.solid,d.text)>a&&(!b||d.line>b))return-1-c}else return this._upperTracks.push({solid:Number.POSITIVE_INFINITY,
text:Number.POSITIVE_INFINITY,line:Number.POSITIVE_INFINITY}),-1-c}};
Timeline.DetailedEventPainter.prototype._findFreeTrackForText=function(a,b,c){var d,f;0>a?(d=!0,a=-a,b=this._findFreeUpperTrackForText(a,b),f=-1-b):0<a?(d=!1,a+=1,f=b=this._findFreeLowerTrackForText(a,b)):(f=this._findFreeUpperTrackForText(0,b),b=this._findFreeLowerTrackForText(1,b),b-1<=f?(d=!1,a=1,f=b):(d=!0,a=0,b=f,f=-1-b));if(d){b==this._upperTracks.length&&this._upperTracks.push({solid:Number.POSITIVE_INFINITY,text:Number.POSITIVE_INFINITY,line:Number.POSITIVE_INFINITY});for(d=a;d<b;d++)c(this._upperTracks[d])}else{b==
this._lowerTracks.length&&this._lowerTracks.push({solid:Number.POSITIVE_INFINITY,text:Number.POSITIVE_INFINITY,line:Number.POSITIVE_INFINITY});for(d=a;d<b;d++)c(this._lowerTracks[d])}return f};Timeline.DetailedEventPainter.prototype._findFreeLowerTrackForText=function(a,b){for(;a<this._lowerTracks.length;a++){var c=this._lowerTracks[a];if(Math.min(c.solid,c.text)>=b)break}return a};
Timeline.DetailedEventPainter.prototype._findFreeUpperTrackForText=function(a,b){for(;a<this._upperTracks.length;a++){var c=this._upperTracks[a];if(Math.min(c.solid,c.text)>=b)break}return a};Timeline.DetailedEventPainter.prototype._getTrackData=function(a){return 0>a?this._upperTracks[-a-1]:this._lowerTracks[a]};
Timeline.DetailedEventPainter.prototype._paintEventLine=function(a,b,c,d,f,e){var a=Math.round(f.trackOffset+c*f.trackIncrement+f.trackHeight/2),f=Math.round(Math.abs(d-c)*f.trackIncrement),g="1px solid "+e.event.label.lineColor,h=this._timeline.getDocument().createElement("div");h.style.position="absolute";h.style.left=b+"px";h.style.width=e.event.label.offsetFromLine+"px";h.style.height=f+"px";c>d?(h.style.top=a-f+"px",h.style.borderTop=g):(h.style.top=a+"px",h.style.borderBottom=g);h.style.borderLeft=
g;this._lineLayer.appendChild(h)};
Timeline.DetailedEventPainter.prototype._paintEventIcon=function(a,b,c,d){var f=a.getIcon(),f=null!=f?f:d.icon,b=Math.round(d.trackOffset+b*d.trackIncrement+d.trackHeight/2-d.iconHeight/2),f=SimileAjax.Graphics.createTranslucentImage(f),e=this._timeline.getDocument().createElement("div");e.style.position="absolute";e.style.left=c+"px";e.style.top=b+"px";e.appendChild(f);e.style.cursor="pointer";if(null!=a._title)e.title=a._title;this._eventLayer.appendChild(e);return{left:c,top:b,width:d.iconWidth,
height:d.iconHeight,elmt:e}};
Timeline.DetailedEventPainter.prototype._paintEventLabel=function(a,b,c,d,f,e,g){var h=this._timeline.getDocument(),i=h.createElement("div");i.style.position="absolute";i.style.left=c+"px";i.style.width=f+"px";i.style.top=d+"px";i.style.height=e+"px";i.style.backgroundColor=g.event.label.backgroundColor;SimileAjax.Graphics.setOpacity(i,g.event.label.backgroundOpacity);this._eventLayer.appendChild(i);g=h.createElement("div");g.style.position="absolute";g.style.left=c+"px";g.style.width=f+"px";g.style.top=
d+"px";g.innerHTML=b;g.style.cursor="pointer";if(null!=a._title)g.title=a._title;b=a.getTextColor();null==b&&(b=a.getColor());if(null!=b)g.style.color=b;this._eventLayer.appendChild(g);return{left:c,top:d,width:f,height:e,elmt:g}};
Timeline.DetailedEventPainter.prototype._paintEventTape=function(a,b,c,d,f,e,g,h){d-=c;h=h.event.tape.height;b=Math.round(g.trackOffset+b*g.trackIncrement+g.trackHeight/2-h/2);g=this._timeline.getDocument().createElement("div");g.style.position="absolute";g.style.left=c+"px";g.style.width=d+"px";g.style.top=b+"px";g.style.height=h+"px";g.style.backgroundColor=f;g.style.overflow="hidden";g.style.cursor="pointer";if(null!=a._title)g.title=a._title;SimileAjax.Graphics.setOpacity(g,e);this._eventLayer.appendChild(g);
return{left:c,top:b,width:d,height:h,elmt:g}};Timeline.DetailedEventPainter.prototype._createHighlightDiv=function(a,b,c){if(0<=a){var d=this._timeline.getDocument(),c=c.event,a=c.highlightColors[Math.min(a,c.highlightColors.length-1)],d=d.createElement("div");d.style.position="absolute";d.style.overflow="hidden";d.style.left=b.left-2+"px";d.style.width=b.width+4+"px";d.style.top=b.top-2+"px";d.style.height=b.height+4+"px";d.style.background=a;this._highlightLayer.appendChild(d)}};
Timeline.DetailedEventPainter.prototype._onClickInstantEvent=function(a,b,c){var d=SimileAjax.DOM.getPageCoordinates(a);this._showBubble(d.left+Math.ceil(a.offsetWidth/2),d.top+Math.ceil(a.offsetHeight/2),c);this._fireOnSelect(c.getID());b.cancelBubble=!0;SimileAjax.DOM.cancelEvent(b);return!1};
Timeline.DetailedEventPainter.prototype._onClickDurationEvent=function(a,b,c){if("pageX"in b)var a=b.pageX,d=b.pageY;else d=SimileAjax.DOM.getPageCoordinates(a),a=b.offsetX+d.left,d=b.offsetY+d.top;this._showBubble(a,d,c);this._fireOnSelect(c.getID());b.cancelBubble=!0;SimileAjax.DOM.cancelEvent(b);return!1};
Timeline.DetailedEventPainter.prototype.showBubble=function(a){var b=this._eventIdToElmt[a.getID()];if(b){var c=SimileAjax.DOM.getPageCoordinates(b);this._showBubble(c.left+b.offsetWidth/2,c.top+b.offsetHeight/2,a)}};
Timeline.DetailedEventPainter.prototype._showBubble=function(a,b,c){var d=document.createElement("div"),f=this._params.theme.event.bubble;c.fillInfoBubble(d,this._params.theme,this._band.getLabeller());SimileAjax.WindowManager.cancelPopups();SimileAjax.Graphics.createBubbleForContentAndPoint(d,a,b,f.width,null,f.maxHeight)};Timeline.DetailedEventPainter.prototype._fireOnSelect=function(a){for(var b=0;b<this._onSelectListeners.length;b++)this._onSelectListeners[b](a)};
Timeline.OverviewEventPainter=function(a){this._params=a;this._onSelectListeners=[];this._highlightMatcher=this._filterMatcher=null};Timeline.OverviewEventPainter.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._highlightLayer=this._eventLayer=null};Timeline.OverviewEventPainter.prototype.getType=function(){return"overview"};Timeline.OverviewEventPainter.prototype.addOnSelectListener=function(a){this._onSelectListeners.push(a)};
Timeline.OverviewEventPainter.prototype.removeOnSelectListener=function(a){for(var b=0;b<this._onSelectListeners.length;b++)if(this._onSelectListeners[b]==a){this._onSelectListeners.splice(b,1);break}};Timeline.OverviewEventPainter.prototype.getFilterMatcher=function(){return this._filterMatcher};Timeline.OverviewEventPainter.prototype.setFilterMatcher=function(a){this._filterMatcher=a};Timeline.OverviewEventPainter.prototype.getHighlightMatcher=function(){return this._highlightMatcher};
Timeline.OverviewEventPainter.prototype.setHighlightMatcher=function(a){this._highlightMatcher=a};
Timeline.OverviewEventPainter.prototype.paint=function(){var a=this._band.getEventSource();if(null!=a){this._prepareForPainting();for(var b=this._params.theme.event,b={trackOffset:b.overviewTrack.offset,trackHeight:b.overviewTrack.height,trackGap:b.overviewTrack.gap,trackIncrement:b.overviewTrack.height+b.overviewTrack.gap},c=this._band.getMinDate(),d=this._band.getMaxDate(),f=null!=this._filterMatcher?this._filterMatcher:function(){return!0},e=null!=this._highlightMatcher?this._highlightMatcher:
function(){return-1},a=a.getEventReverseIterator(c,d);a.hasNext();)c=a.next(),f(c)&&this.paintEvent(c,b,this._params.theme,e(c));this._highlightLayer.style.display="block";this._eventLayer.style.display="block";this._band.updateEventTrackInfo(this._tracks.length,b.trackIncrement)}};Timeline.OverviewEventPainter.prototype.softPaint=function(){};
Timeline.OverviewEventPainter.prototype._prepareForPainting=function(){var a=this._band;this._tracks=[];null!=this._highlightLayer&&a.removeLayerDiv(this._highlightLayer);this._highlightLayer=a.createLayerDiv(105,"timeline-band-highlights");this._highlightLayer.style.display="none";null!=this._eventLayer&&a.removeLayerDiv(this._eventLayer);this._eventLayer=a.createLayerDiv(110,"timeline-band-events");this._eventLayer.style.display="none"};
Timeline.OverviewEventPainter.prototype.paintEvent=function(a,b,c,d){a.isInstant()?this.paintInstantEvent(a,b,c,d):this.paintDurationEvent(a,b,c,d)};Timeline.OverviewEventPainter.prototype.paintInstantEvent=function(a,b,c,d){var f=a.getStart(),f=Math.round(this._band.dateToPixelOffset(f)),e=a.getColor(),e=a.getClassName()?null:null!=e?e:c.event.duration.color,a=this._paintEventTick(a,f,e,100,b,c);this._createHighlightDiv(d,a,c)};
Timeline.OverviewEventPainter.prototype.paintDurationEvent=function(a,b,c,d){for(var f=a.getLatestStart(),e=a.getEarliestEnd(),f=Math.round(this._band.dateToPixelOffset(f)),e=Math.round(this._band.dateToPixelOffset(e)),g=0;g<this._tracks.length&&!(e<this._tracks[g]);g++);this._tracks[g]=e;var h=a.getColor(),i=a.getClassName(),h=i?null:null!=h?h:c.event.duration.color,a=this._paintEventTape(a,g,f,e,h,100,b,c,i);this._createHighlightDiv(d,a,c)};
Timeline.OverviewEventPainter.prototype._paintEventTape=function(a,b,c,d,f,e,g,h,i){a=g.trackOffset+b*g.trackIncrement;d-=c;g=g.trackHeight;b=this._timeline.getDocument().createElement("div");b.className="timeline-small-event-tape";i&&(b.className+=" small-"+i);b.style.left=c+"px";b.style.width=d+"px";b.style.top=a+"px";b.style.height=g+"px";if(f)b.style.backgroundColor=f;100>e&&SimileAjax.Graphics.setOpacity(b,e);this._eventLayer.appendChild(b);return{left:c,top:a,width:d,height:g,elmt:b}};
Timeline.OverviewEventPainter.prototype._paintEventTick=function(a,b,c,d,f,e){c=e.event.overviewTrack.tickHeight;f=f.trackOffset-c;e=this._timeline.getDocument().createElement("div");e.className="timeline-small-event-icon";e.style.left=b+"px";e.style.top=f+"px";if(a=a.getClassName())e.className+=" small-"+a;100>d&&SimileAjax.Graphics.setOpacity(e,d);this._eventLayer.appendChild(e);return{left:b,top:f,width:1,height:c,elmt:e}};
Timeline.OverviewEventPainter.prototype._createHighlightDiv=function(a,b,c){if(0<=a){var d=this._timeline.getDocument(),c=c.event,a=c.highlightColors[Math.min(a,c.highlightColors.length-1)],d=d.createElement("div");d.style.position="absolute";d.style.overflow="hidden";d.style.left=b.left-1+"px";d.style.width=b.width+2+"px";d.style.top=b.top-1+"px";d.style.height=b.height+2+"px";d.style.background=a;this._highlightLayer.appendChild(d)}};Timeline.OverviewEventPainter.prototype.showBubble=function(){};
Timeline.CompactEventPainter=function(a){this._params=a;this._onSelectListeners=[];this._frc=this._highlightMatcher=this._filterMatcher=null;this._eventIdToElmt={}};Timeline.CompactEventPainter.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._eventIdToElmt=this._highlightLayer=this._lineLayer=this._eventLayer=this._backLayer=null};Timeline.CompactEventPainter.prototype.addOnSelectListener=function(a){this._onSelectListeners.push(a)};
Timeline.CompactEventPainter.prototype.removeOnSelectListener=function(a){for(var b=0;b<this._onSelectListeners.length;b++)if(this._onSelectListeners[b]==a){this._onSelectListeners.splice(b,1);break}};Timeline.CompactEventPainter.prototype.getFilterMatcher=function(){return this._filterMatcher};Timeline.CompactEventPainter.prototype.setFilterMatcher=function(a){this._filterMatcher=a};Timeline.CompactEventPainter.prototype.getHighlightMatcher=function(){return this._highlightMatcher};
Timeline.CompactEventPainter.prototype.setHighlightMatcher=function(a){this._highlightMatcher=a};
Timeline.CompactEventPainter.prototype.paint=function(){var a=this._band.getEventSource();if(null!=a){this._eventIdToElmt={};this._prepareForPainting();var b=this._params.theme,c=b.event,b={trackOffset:"trackOffset"in this._params?this._params.trackOffset:10,trackHeight:"trackHeight"in this._params?this._params.trackHeight:10,tapeHeight:b.event.tape.height,tapeBottomMargin:"tapeBottomMargin"in this._params?this._params.tapeBottomMargin:2,labelBottomMargin:"labelBottomMargin"in this._params?this._params.labelBottomMargin:
5,labelRightMargin:"labelRightMargin"in this._params?this._params.labelRightMargin:5,defaultIcon:c.instant.icon,defaultIconWidth:c.instant.iconWidth,defaultIconHeight:c.instant.iconHeight,customIconWidth:"iconWidth"in this._params?this._params.iconWidth:c.instant.iconWidth,customIconHeight:"iconHeight"in this._params?this._params.iconHeight:c.instant.iconHeight,iconLabelGap:"iconLabelGap"in this._params?this._params.iconLabelGap:2,iconBottomMargin:"iconBottomMargin"in this._params?this._params.iconBottomMargin:
2};"compositeIcon"in this._params?(b.compositeIcon=this._params.compositeIcon,b.compositeIconWidth=this._params.compositeIconWidth||b.customIconWidth,b.compositeIconHeight=this._params.compositeIconHeight||b.customIconHeight):(b.compositeIcon=b.defaultIcon,b.compositeIconWidth=b.defaultIconWidth,b.compositeIconHeight=b.defaultIconHeight);b.defaultStackIcon="icon"in this._params.stackConcurrentPreciseInstantEvents?this._params.stackConcurrentPreciseInstantEvents.icon:b.defaultIcon;b.defaultStackIconWidth=
"iconWidth"in this._params.stackConcurrentPreciseInstantEvents?this._params.stackConcurrentPreciseInstantEvents.iconWidth:b.defaultIconWidth;b.defaultStackIconHeight="iconHeight"in this._params.stackConcurrentPreciseInstantEvents?this._params.stackConcurrentPreciseInstantEvents.iconHeight:b.defaultIconHeight;var d=this._band.getMinDate(),f=this._band.getMaxDate(),e=null!=this._filterMatcher?this._filterMatcher:function(){return!0},c=null!=this._highlightMatcher?this._highlightMatcher:function(){return-1},
f=a.getEventIterator(d,f),a="stackConcurrentPreciseInstantEvents"in this._params&&"object"==typeof this._params.stackConcurrentPreciseInstantEvents;if("collapseConcurrentPreciseInstantEvents"in this._params&&this._params.collapseConcurrentPreciseInstantEvents||a){for(var d=[],g=null;f.hasNext();){var h=f.next();e(h)&&(!h.isInstant()||h.isImprecise()?this.paintEvent(h,b,this._params.theme,c(h)):null!=g&&g.getStart().getTime()==h.getStart().getTime()?d[d.length-1].push(h):(d.push([h]),g=h))}for(e=0;e<
d.length;e++)if(f=d[e],1==f.length)this.paintEvent(f[0],b,this._params.theme,c(h));else{for(var g=-1,i=0;0>g&&i<f.length;i++)g=c(f[i]);a?this.paintStackedPreciseInstantEvents(f,b,this._params.theme,g):this.paintCompositePreciseInstantEvents(f,b,this._params.theme,g)}}else for(;f.hasNext();)h=f.next(),e(h)&&this.paintEvent(h,b,this._params.theme,c(h));this._highlightLayer.style.display="block";this._lineLayer.style.display="block";this._eventLayer.style.display="block"}};
Timeline.CompactEventPainter.prototype.softPaint=function(){};
Timeline.CompactEventPainter.prototype._prepareForPainting=function(){var a=this._band;if(null==this._backLayer){this._backLayer=this._band.createLayerDiv(0,"timeline-band-events");this._backLayer.style.visibility="hidden";var b=document.createElement("span");b.className="timeline-event-label";this._backLayer.appendChild(b);this._frc=SimileAjax.Graphics.getFontRenderingContext(b)}this._frc.update();this._tracks=[];null!=this._highlightLayer&&a.removeLayerDiv(this._highlightLayer);this._highlightLayer=
a.createLayerDiv(105,"timeline-band-highlights");this._highlightLayer.style.display="none";null!=this._lineLayer&&a.removeLayerDiv(this._lineLayer);this._lineLayer=a.createLayerDiv(110,"timeline-band-lines");this._lineLayer.style.display="none";null!=this._eventLayer&&a.removeLayerDiv(this._eventLayer);this._eventLayer=a.createLayerDiv(115,"timeline-band-events");this._eventLayer.style.display="none"};
Timeline.CompactEventPainter.prototype.paintEvent=function(a,b,c,d){a.isInstant()?this.paintInstantEvent(a,b,c,d):this.paintDurationEvent(a,b,c,d)};Timeline.CompactEventPainter.prototype.paintInstantEvent=function(a,b,c,d){a.isImprecise()?this.paintImpreciseInstantEvent(a,b,c,d):this.paintPreciseInstantEvent(a,b,c,d)};Timeline.CompactEventPainter.prototype.paintDurationEvent=function(a,b,c,d){a.isImprecise()?this.paintImpreciseDurationEvent(a,b,c,d):this.paintPreciseDurationEvent(a,b,c,d)};
Timeline.CompactEventPainter.prototype.paintPreciseInstantEvent=function(a,b,c,d){var f={tooltip:a.getProperty("tooltip")||a.getText()},e={url:a.getIcon()};null==e.url?(e.url=b.defaultIcon,e.width=b.defaultIconWidth,e.height=b.defaultIconHeight,e.className="timeline-event-icon-default"):(e.width=a.getProperty("iconWidth")||b.customIconWidth,e.height=a.getProperty("iconHeight")||b.customIconHeight);var g={text:a.getText(),color:a.getTextColor()||a.getColor(),className:a.getClassName()},h=this.paintTapeIconLabel(a.getStart(),
f,null,e,g,b,c,d),i=this,b=function(b,c){return i._onClickInstantEvent(h.iconElmtData.elmt,c,a)};SimileAjax.DOM.registerEvent(h.iconElmtData.elmt,"mousedown",b);SimileAjax.DOM.registerEvent(h.labelElmtData.elmt,"mousedown",b);this._eventIdToElmt[a.getID()]=h.iconElmtData.elmt};
Timeline.CompactEventPainter.prototype.paintCompositePreciseInstantEvents=function(a,b,c,d){for(var f=a[0],e=[],g=0;g<a.length;g++)e.push(a[g].getProperty("tooltip")||a[g].getText());var e={tooltip:e.join("; ")},g={url:b.compositeIcon,width:b.compositeIconWidth,height:b.compositeIconHeight,className:"timeline-event-icon-composite"},h={text:String.substitute(this._params.compositeEventLabelTemplate,[a.length])},i=this.paintTapeIconLabel(f.getStart(),e,null,g,h,b,c,d),j=this,b=function(b,c){return j._onClickMultiplePreciseInstantEvent(i.iconElmtData.elmt,
c,a)};SimileAjax.DOM.registerEvent(i.iconElmtData.elmt,"mousedown",b);SimileAjax.DOM.registerEvent(i.labelElmtData.elmt,"mousedown",b);for(g=0;g<a.length;g++)this._eventIdToElmt[a[g].getID()]=i.iconElmtData.elmt};
Timeline.CompactEventPainter.prototype.paintStackedPreciseInstantEvents=function(a,b,c){var d="limit"in this._params.stackConcurrentPreciseInstantEvents?this._params.stackConcurrentPreciseInstantEvents.limit:10,f="moreMessageTemplate"in this._params.stackConcurrentPreciseInstantEvents?this._params.stackConcurrentPreciseInstantEvents.moreMessageTemplate:"%0 More Events",e=d<=a.length-2,g=this._band,h=function(a){var c={url:a.getIcon()};null==c.url?(c.url=b.defaultStackIcon,c.width=b.defaultStackIconWidth,
c.height=b.defaultStackIconHeight,c.className="timeline-event-icon-stack timeline-event-icon-default"):(c.width=a.getProperty("iconWidth")||b.customIconWidth,c.height=a.getProperty("iconHeight")||b.customIconHeight,c.className="timeline-event-icon-stack");return c},i=h(a[0]),j=0,l=0,k=0,m=0,p=[],o=0;for(;o<a.length&&(!e||o<d);o++){var q=a[o],r=q.getText(),q=h(q),t=this._frc.computeSize(r),r={text:r,iconData:q,labelSize:t,iconLeft:i.width+5*o-q.width};r.labelLeft=i.width+5*o+b.iconLabelGap;r.top=k;
p.push(r);j=Math.min(j,r.iconLeft);k+=t.height;l=Math.max(l,r.labelLeft+t.width);m=Math.max(m,r.top+q.height)}if(e)var w=String.substitute(f,[a.length-d]),u=this._frc.computeSize(w),z=i.width+5*(d-1)+b.iconLabelGap,A=k,k=k+u.height,l=Math.max(l,z+u.width);for(var l=l+b.labelRightMargin,k=k+b.labelBottomMargin,m=m+b.iconBottomMargin,x=function(a){return Math.round(g.dateToPixelOffset(a))}(a[0].getStart()),f=[],h=Math.ceil(Math.max(m,k)/b.trackHeight),i=i.width+5*(a.length-1),o=0;o<h;o++)f.push({start:j,
end:i});j=Math.ceil(k/b.trackHeight);for(o=0;o<j;o++)k=f[o],k.end=Math.max(k.end,l);var v=this._fitTracks(x,f)*b.trackHeight+b.trackOffset,s=this._timeline.getDocument().createElement("div");s.className="timeline-event-icon-stack";s.style.position="absolute";s.style.overflow="visible";s.style.left=x+"px";s.style.top=v+"px";s.style.width=i+"px";s.style.height=m+"px";s.innerHTML="<div style='position: relative'></div>";this._eventLayer.appendChild(s);var y=this,D=function(){try{for(var a=parseInt(this.getAttribute("index")),
b=s.firstChild.childNodes,c=0;c<b.length;c++)b[c].style.zIndex=c==a?b.length:b.length-c}catch(d){}},l=function(b){var d=p[b],e=a[b],f=e.getProperty("tooltip")||e.getText(),g=y._paintEventLabel({tooltip:f},{text:d.text},x+d.labelLeft,v+d.top,d.labelSize.width,d.labelSize.height,c);g.elmt.setAttribute("index",b);g.elmt.onmouseover=D;var h=SimileAjax.Graphics.createTranslucentImage(d.iconData.url),f=y._timeline.getDocument().createElement("div");f.className="timeline-event-icon"+("className"in d.iconData?
" "+d.iconData.className:"");f.style.left=d.iconLeft+"px";f.style.top=d.top+"px";f.style.zIndex=p.length-b;f.appendChild(h);f.setAttribute("index",b);f.onmouseover=D;s.firstChild.appendChild(f);b=function(a,b){return y._onClickInstantEvent(g.elmt,b,e)};SimileAjax.DOM.registerEvent(f,"mousedown",b);SimileAjax.DOM.registerEvent(g.elmt,"mousedown",b);y._eventIdToElmt[e.getID()]=f},o=0;for(;o<p.length;o++)l(o);if(e){var B=a.slice(d),C=this._paintEventLabel({tooltip:w},{text:w},x+z,v+A,u.width,u.height,
c);SimileAjax.DOM.registerEvent(C.elmt,"mousedown",function(a,b){return y._onClickMultiplePreciseInstantEvent(C.elmt,b,B)});for(o=0;o<B.length;o++)this._eventIdToElmt[B[o].getID()]=C.elmt}};
Timeline.CompactEventPainter.prototype.paintImpreciseInstantEvent=function(a,b,c,d){var f={tooltip:a.getProperty("tooltip")||a.getText()},e={start:a.getStart(),end:a.getEnd(),latestStart:a.getLatestStart(),earliestEnd:a.getEarliestEnd(),isInstant:!0},g={url:a.getIcon()};null==g.url?g=null:(g.width=a.getProperty("iconWidth")||b.customIconWidth,g.height=a.getProperty("iconHeight")||b.customIconHeight);var h={text:a.getText(),color:a.getTextColor()||a.getColor(),className:a.getClassName()},i=this.paintTapeIconLabel(a.getStart(),
f,e,g,h,b,c,d),j=this,b=null!=g?function(b,c){return j._onClickInstantEvent(i.iconElmtData.elmt,c,a)}:function(b,c){return j._onClickInstantEvent(i.labelElmtData.elmt,c,a)};SimileAjax.DOM.registerEvent(i.labelElmtData.elmt,"mousedown",b);SimileAjax.DOM.registerEvent(i.impreciseTapeElmtData.elmt,"mousedown",b);null!=g?(SimileAjax.DOM.registerEvent(i.iconElmtData.elmt,"mousedown",b),this._eventIdToElmt[a.getID()]=i.iconElmtData.elmt):this._eventIdToElmt[a.getID()]=i.labelElmtData.elmt};
Timeline.CompactEventPainter.prototype.paintPreciseDurationEvent=function(a,b,c,d){var f={tooltip:a.getProperty("tooltip")||a.getText()},e={start:a.getStart(),end:a.getEnd(),isInstant:!1},g={url:a.getIcon()};null==g.url?g=null:(g.width=a.getProperty("iconWidth")||b.customIconWidth,g.height=a.getProperty("iconHeight")||b.customIconHeight);var h={text:a.getText(),color:a.getTextColor()||a.getColor(),className:a.getClassName()},i=this.paintTapeIconLabel(a.getLatestStart(),f,e,g,h,b,c,d),j=this,b=null!=
g?function(b,c){return j._onClickInstantEvent(i.iconElmtData.elmt,c,a)}:function(b,c){return j._onClickInstantEvent(i.labelElmtData.elmt,c,a)};SimileAjax.DOM.registerEvent(i.labelElmtData.elmt,"mousedown",b);SimileAjax.DOM.registerEvent(i.tapeElmtData.elmt,"mousedown",b);null!=g?(SimileAjax.DOM.registerEvent(i.iconElmtData.elmt,"mousedown",b),this._eventIdToElmt[a.getID()]=i.iconElmtData.elmt):this._eventIdToElmt[a.getID()]=i.labelElmtData.elmt};
Timeline.CompactEventPainter.prototype.paintImpreciseDurationEvent=function(a,b,c,d){var f={tooltip:a.getProperty("tooltip")||a.getText()},e={start:a.getStart(),end:a.getEnd(),latestStart:a.getLatestStart(),earliestEnd:a.getEarliestEnd(),isInstant:!1},g={url:a.getIcon()};null==g.url?g=null:(g.width=a.getProperty("iconWidth")||b.customIconWidth,g.height=a.getProperty("iconHeight")||b.customIconHeight);var h={text:a.getText(),color:a.getTextColor()||a.getColor(),className:a.getClassName()},i=this.paintTapeIconLabel(a.getLatestStart(),
f,e,g,h,b,c,d),j=this,b=null!=g?function(b,c){return j._onClickInstantEvent(i.iconElmtData.elmt,c,a)}:function(b,c){return j._onClickInstantEvent(i.labelElmtData.elmt,c,a)};SimileAjax.DOM.registerEvent(i.labelElmtData.elmt,"mousedown",b);SimileAjax.DOM.registerEvent(i.tapeElmtData.elmt,"mousedown",b);null!=g?(SimileAjax.DOM.registerEvent(i.iconElmtData.elmt,"mousedown",b),this._eventIdToElmt[a.getID()]=i.iconElmtData.elmt):this._eventIdToElmt[a.getID()]=i.labelElmtData.elmt};
Timeline.CompactEventPainter.prototype.paintTapeIconLabel=function(a,b,c,d,f,e,g){var h=this._band,i=function(a){return Math.round(h.dateToPixelOffset(a))},a=i(a),j=[],l=0,k=0,m=0;if(null!=c){for(var l=e.tapeHeight+e.tapeBottomMargin,k=Math.ceil(e.tapeHeight/e.trackHeight),p=i(c.end)-a,o=i(c.start)-a,q=0;q<k;q++)j.push({start:o,end:p});m=e.trackHeight-l%e.tapeHeight}o=p=0;if(null!=d){"iconAlign"in d&&"center"==d.iconAlign&&(p=-Math.floor(d.width/2));o=p+d.width+e.iconLabelGap;if(0<k)j[k-1].end=Math.max(j[k-
1].end,o);for(q=d.height+e.iconBottomMargin+m;0<q;)j.push({start:p,end:o}),q-=e.trackHeight}var q=this._frc.computeSize(f.text),m=q.height+e.labelBottomMargin+m,r=o+q.width+e.labelRightMargin;if(0<k)j[k-1].end=Math.max(j[k-1].end,r);for(var t=0;0<m;t++)k+t<j.length?j[k+t].end=r:j.push({start:0,end:r}),m-=e.trackHeight;j=this._fitTracks(a,j)*e.trackHeight+e.trackOffset;k={};k.labelElmtData=this._paintEventLabel(b,f,a+o,j+l,q.width,q.height,g);if(null!=c){if("latestStart"in c||"earliestEnd"in c)k.impreciseTapeElmtData=
this._paintEventTape(b,c,e.tapeHeight,j,i(c.start),i(c.end),g.event.duration.impreciseColor,g.event.duration.impreciseOpacity,e,g);if(!c.isInstant&&"start"in c&&"end"in c)k.tapeElmtData=this._paintEventTape(b,c,e.tapeHeight,j,a,i("earliestEnd"in c?c.earliestEnd:c.end),c.color,100,e,g)}if(null!=d)k.iconElmtData=this._paintEventIcon(b,d,j+l,a+p,e,g);return k};
Timeline.CompactEventPainter.prototype._fitTracks=function(a,b){var c;for(c=0;c<this._tracks.length;c++){for(var d=!0,f=0;f<b.length&&c+f<this._tracks.length;f++)if(a+b[f].start<this._tracks[c+f]){d=!1;break}if(d)break}for(d=0;d<b.length;d++)this._tracks[c+d]=a+b[d].end;return c};
Timeline.CompactEventPainter.prototype._paintEventIcon=function(a,b,c,d,f){var e=SimileAjax.Graphics.createTranslucentImage(b.url),g=this._timeline.getDocument().createElement("div");g.className="timeline-event-icon"+("className"in b?" "+b.className:"");g.style.left=d+"px";g.style.top=c+"px";g.appendChild(e);if("tooltip"in a&&"string"==typeof a.tooltip)g.title=a.tooltip;this._eventLayer.appendChild(g);return{left:d,top:c,width:f.iconWidth,height:f.iconHeight,elmt:g}};
Timeline.CompactEventPainter.prototype._paintEventLabel=function(a,b,c,d,f,e){var g=this._timeline.getDocument().createElement("div");g.className="timeline-event-label";g.style.left=c+"px";g.style.width=f+1+"px";g.style.top=d+"px";g.innerHTML=b.text;if("tooltip"in a&&"string"==typeof a.tooltip)g.title=a.tooltip;if("color"in b&&"string"==typeof b.color)g.style.color=b.color;"className"in b&&"string"==typeof b.className&&(g.className+=" "+b.className);this._eventLayer.appendChild(g);return{left:c,top:d,
width:f,height:e,elmt:g}};
Timeline.CompactEventPainter.prototype._paintEventTape=function(a,b,c,d,f,e,g,h){var e=e-f,i=this._timeline.getDocument().createElement("div");i.className="timeline-event-tape";i.style.left=f+"px";i.style.top=d+"px";i.style.width=e+"px";i.style.height=c+"px";if("tooltip"in a&&"string"==typeof a.tooltip)i.title=a.tooltip;if(null!=g&&"string"==typeof b.color)i.style.backgroundColor=g;if("backgroundImage"in b&&"string"==typeof b.backgroundImage)i.style.backgroundImage="url("+backgroundImage+")",i.style.backgroundRepeat=
"backgroundRepeat"in b&&"string"==typeof b.backgroundRepeat?b.backgroundRepeat:"repeat";SimileAjax.Graphics.setOpacity(i,h);"className"in b&&"string"==typeof b.className&&(i.className+=" "+b.className);this._eventLayer.appendChild(i);return{left:f,top:d,width:e,height:c,elmt:i}};
Timeline.CompactEventPainter.prototype._createHighlightDiv=function(a,b,c){if(0<=a){var d=this._timeline.getDocument();Math.min(a,c.event.highlightColors.length-1);a=d.createElement("div");a.style.position="absolute";a.style.overflow="hidden";a.style.left=b.left-2+"px";a.style.width=b.width+4+"px";a.style.top=b.top-2+"px";a.style.height=b.height+4+"px";this._highlightLayer.appendChild(a)}};
Timeline.CompactEventPainter.prototype._onClickMultiplePreciseInstantEvent=function(a,b,c){var d=SimileAjax.DOM.getPageCoordinates(a);this._showBubble(d.left+Math.ceil(a.offsetWidth/2),d.top+Math.ceil(a.offsetHeight/2),c);a=[];for(d=0;d<c.length;d++)a.push(c[d].getID());this._fireOnSelect(a);b.cancelBubble=!0;SimileAjax.DOM.cancelEvent(b);return!1};
Timeline.CompactEventPainter.prototype._onClickInstantEvent=function(a,b,c){var d=SimileAjax.DOM.getPageCoordinates(a);this._showBubble(d.left+Math.ceil(a.offsetWidth/2),d.top+Math.ceil(a.offsetHeight/2),[c]);this._fireOnSelect([c.getID()]);b.cancelBubble=!0;SimileAjax.DOM.cancelEvent(b);return!1};
Timeline.CompactEventPainter.prototype._onClickDurationEvent=function(a,b,c){if("pageX"in b)var a=b.pageX,d=b.pageY;else d=SimileAjax.DOM.getPageCoordinates(a),a=b.offsetX+d.left,d=b.offsetY+d.top;this._showBubble(a,d,[c]);this._fireOnSelect([c.getID()]);b.cancelBubble=!0;SimileAjax.DOM.cancelEvent(b);return!1};
Timeline.CompactEventPainter.prototype.showBubble=function(a){var b=this._eventIdToElmt[a.getID()];if(b){var c=SimileAjax.DOM.getPageCoordinates(b);this._showBubble(c.left+b.offsetWidth/2,c.top+b.offsetHeight/2,[a])}};
Timeline.CompactEventPainter.prototype._showBubble=function(a,b,c){var d=document.createElement("div"),c="fillInfoBubble"in c?[c]:c,f=0;for(;f<c.length;f++){var e=document.createElement("div");d.appendChild(e);c[f].fillInfoBubble(e,this._params.theme,this._band.getLabeller())}SimileAjax.WindowManager.cancelPopups();SimileAjax.Graphics.createBubbleForContentAndPoint(d,a,b,this._params.theme.event.bubble.width)};Timeline.CompactEventPainter.prototype._fireOnSelect=function(a){for(var b=0;b<this._onSelectListeners.length;b++)this._onSelectListeners[b](a)};
Timeline.SpanHighlightDecorator=function(a){this._unit=null!=a.unit?a.unit:SimileAjax.NativeDateUnit;this._startDate="string"==typeof a.startDate?this._unit.parseFromObject(a.startDate):a.startDate;this._endDate="string"==typeof a.endDate?this._unit.parseFromObject(a.endDate):a.endDate;this._startLabel=null!=a.startLabel?a.startLabel:"";this._endLabel=null!=a.endLabel?a.endLabel:"";this._color=a.color;this._cssClass=null!=a.cssClass?a.cssClass:null;this._opacity=null!=a.opacity?a.opacity:100;this._zIndex=
null!=a.inFront&&a.inFront?113:10};Timeline.SpanHighlightDecorator.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._layerDiv=null};
Timeline.SpanHighlightDecorator.prototype.paint=function(){null!=this._layerDiv&&this._band.removeLayerDiv(this._layerDiv);this._layerDiv=this._band.createLayerDiv(this._zIndex);this._layerDiv.setAttribute("name","span-highlight-decorator");this._layerDiv.style.display="none";var a=this._band.getMinDate(),b=this._band.getMaxDate();if(0>this._unit.compare(this._startDate,b)&&0<this._unit.compare(this._endDate,a)){var a=this._unit.later(a,this._startDate),b=this._unit.earlier(b,this._endDate),a=this._band.dateToPixelOffset(a),
b=this._band.dateToPixelOffset(b),c=this._timeline.getDocument(),d=function(){var a=c.createElement("table");a.insertRow(0).insertCell(0);return a},f=c.createElement("div");f.className="timeline-highlight-decorator";this._cssClass&&(f.className+=" "+this._cssClass);if(null!=this._color)f.style.backgroundColor=this._color;100>this._opacity&&SimileAjax.Graphics.setOpacity(f,this._opacity);this._layerDiv.appendChild(f);var e=d();e.className="timeline-highlight-label timeline-highlight-label-start";var g=
e.rows[0].cells[0];g.innerHTML=this._startLabel;if(this._cssClass)g.className="label_"+this._cssClass;this._layerDiv.appendChild(e);d=d();d.className="timeline-highlight-label timeline-highlight-label-end";g=d.rows[0].cells[0];g.innerHTML=this._endLabel;if(this._cssClass)g.className="label_"+this._cssClass;this._layerDiv.appendChild(d);this._timeline.isHorizontal()?(f.style.left=a+"px",f.style.width=b-a+"px",e.style.right=this._band.getTotalViewLength()-a+"px",e.style.width=this._startLabel.length+
"em",d.style.left=b+"px",d.style.width=this._endLabel.length+"em"):(f.style.top=a+"px",f.style.height=b-a+"px",e.style.bottom=a+"px",e.style.height="1.5px",d.style.top=b+"px",d.style.height="1.5px")}this._layerDiv.style.display="block"};Timeline.SpanHighlightDecorator.prototype.softPaint=function(){};
Timeline.PointHighlightDecorator=function(a){this._unit=null!=a.unit?a.unit:SimileAjax.NativeDateUnit;this._date="string"==typeof a.date?this._unit.parseFromObject(a.date):a.date;this._width=null!=a.width?a.width:10;this._color=a.color;this._cssClass=null!=a.cssClass?a.cssClass:"";this._opacity=null!=a.opacity?a.opacity:100};Timeline.PointHighlightDecorator.prototype.initialize=function(a,b){this._band=a;this._timeline=b;this._layerDiv=null};
Timeline.PointHighlightDecorator.prototype.paint=function(){null!=this._layerDiv&&this._band.removeLayerDiv(this._layerDiv);this._layerDiv=this._band.createLayerDiv(10);this._layerDiv.setAttribute("name","span-highlight-decorator");this._layerDiv.style.display="none";var a=this._band.getMinDate();if(0>this._unit.compare(this._date,this._band.getMaxDate())&&0<this._unit.compare(this._date,a)){var a=this._band.dateToPixelOffset(this._date)-Math.round(this._width/2),b=this._timeline.getDocument().createElement("div");
b.className="timeline-highlight-point-decorator";b.className+=" "+this._cssClass;if(null!=this._color)b.style.backgroundColor=this._color;100>this._opacity&&SimileAjax.Graphics.setOpacity(b,this._opacity);this._layerDiv.appendChild(b);this._timeline.isHorizontal()?(b.style.left=a+"px",b.style.width=this._width):(b.style.top=a+"px",b.style.height=this._width)}this._layerDiv.style.display="block"};Timeline.PointHighlightDecorator.prototype.softPaint=function(){};Timeline.NativeDateUnit={};
Timeline.NativeDateUnit.createLabeller=function(a,b){return new Timeline.GregorianDateLabeller(a,b)};Timeline.NativeDateUnit.makeDefaultValue=function(){return new Date};Timeline.NativeDateUnit.cloneValue=function(a){return new Date(a.getTime())};Timeline.NativeDateUnit.getParser=function(a){"string"==typeof a&&(a=a.toLowerCase());return"iso8601"==a||"iso 8601"==a?Timeline.DateTime.parseIso8601DateTime:Timeline.DateTime.parseGregorianDateTime};Timeline.NativeDateUnit.parseFromObject=function(a){return Timeline.DateTime.parseGregorianDateTime(a)};
Timeline.NativeDateUnit.toNumber=function(a){return a.getTime()};Timeline.NativeDateUnit.fromNumber=function(a){return new Date(a)};Timeline.NativeDateUnit.compare=function(a,b){var c,d;c="object"==typeof a?a.getTime():Number(a);d="object"==typeof b?b.getTime():Number(b);return c-d};Timeline.NativeDateUnit.earlier=function(a,b){return 0>Timeline.NativeDateUnit.compare(a,b)?a:b};Timeline.NativeDateUnit.later=function(a,b){return 0<Timeline.NativeDateUnit.compare(a,b)?a:b};
Timeline.NativeDateUnit.change=function(a,b){return new Date(a.getTime()+b)};Timeline.GregorianDateLabeller.monthNames.en="Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(",");Timeline.GregorianDateLabeller.dayNames.en="Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(",");Timeline.strings.en={wikiLinkLabel:"Discuss"};